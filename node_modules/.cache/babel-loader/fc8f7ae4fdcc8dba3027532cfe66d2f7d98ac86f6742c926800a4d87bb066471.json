{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.for-each.js\";\nimport * as CONSTANT from './../base/constant';\nimport { createElement, detach, prepend, append, attributes, Browser } from '@syncfusion/ej2-base';\nimport { markerClassName } from './dom-node';\nimport * as EVENTS from './../../common/constant';\nimport { setStyleAttribute } from '@syncfusion/ej2-base';\nimport { isIDevice, setEditFrameFocus } from '../../common/util';\nimport { isNullOrUndefined, isNullOrUndefined as isNOU, closest } from '@syncfusion/ej2-base';\n/**\n * Lists internal component\n *\n * @hidden\n\n */\nvar Lists = /** @class */function () {\n  /**\n   * Constructor for creating the Lists plugin\n   *\n   * @param {EditorManager} parent - specifies the parent element\n   * @hidden\n    */\n  function Lists(parent) {\n    this.parent = parent;\n    this.domNode = this.parent.domNode;\n    this.addEventListener();\n  }\n  Lists.prototype.addEventListener = function () {\n    this.parent.observer.on(EVENTS.LIST_TYPE, this.applyListsHandler, this);\n    this.parent.observer.on(EVENTS.KEY_UP_HANDLER, this.onKeyUp, this);\n    this.parent.observer.on(EVENTS.KEY_DOWN_HANDLER, this.keyDownHandler, this);\n    this.parent.observer.on(EVENTS.SPACE_ACTION, this.spaceKeyAction, this);\n    this.parent.observer.on(EVENTS.INTERNAL_DESTROY, this.destroy, this);\n  };\n  Lists.prototype.removeEventListener = function () {\n    this.parent.observer.off(EVENTS.LIST_TYPE, this.applyListsHandler);\n    this.parent.observer.off(EVENTS.KEY_UP_HANDLER, this.onKeyUp);\n    this.parent.observer.off(EVENTS.KEY_DOWN_HANDLER, this.keyDownHandler);\n    this.parent.observer.off(EVENTS.SPACE_ACTION, this.spaceKeyAction);\n    this.parent.observer.off(EVENTS.INTERNAL_DESTROY, this.destroy);\n  };\n  Lists.prototype.testList = function (elem) {\n    var olListRegex = [/^[\\d]+[.]+$/, /^(?=[MDCLXVI])M*(C[MD]|D?C{0,3})(X[CL]|L?X{0,3})(I[XV]|V?I{0,3})[.]$/gi, /^[a-zA-Z][.]+$/];\n    var elementStart = !isNullOrUndefined(elem) ? elem.innerText.trim().split('.')[0] + '.' : null;\n    if (!isNullOrUndefined(elementStart)) {\n      for (var i = 0; i < olListRegex.length; i++) {\n        if (olListRegex[i].test(elementStart)) {\n          return true;\n        }\n      }\n    }\n    return false;\n  };\n  Lists.prototype.testCurrentList = function (range) {\n    var olListStartRegex = [/^[1]+[.]+$/, /^[i]+[.]+$/, /^[a]+[.]+$/];\n    if (!isNullOrUndefined(range.startContainer.textContent.slice(0, range.startOffset))) {\n      var currentContent = range.startContainer.textContent.replace(/\\u200B/g, '').slice(0, range.startOffset).trim();\n      for (var i = 0; i < olListStartRegex.length; i++) {\n        if (olListStartRegex[i].test(currentContent) && currentContent.length === 2) {\n          return true;\n        }\n      }\n    }\n    return false;\n  };\n  Lists.prototype.spaceList = function (e) {\n    var range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n    this.saveSelection = this.parent.nodeSelection.save(range, this.parent.currentDocument);\n    var startNode = this.parent.domNode.getSelectedNode(range.startContainer, range.startOffset);\n    // eslint-disable-next-line\n    var endNode = this.parent.domNode.getSelectedNode(range.endContainer, range.endOffset);\n    var preElement = startNode.previousElementSibling;\n    var nextElement = startNode.nextElementSibling;\n    var preElemULStart = !isNullOrUndefined(preElement) ? preElement.innerText.trim().substring(0, 1) : null;\n    var nextElemULStart = !isNullOrUndefined(nextElement) ? nextElement.innerText.trim().substring(0, 1) : null;\n    var startElementOLTest = this.testCurrentList(range);\n    var preElementOLTest = this.testList(preElement);\n    var nextElementOLTest = this.testList(nextElement);\n    if (!preElementOLTest && !nextElementOLTest && preElemULStart !== '*' && nextElemULStart !== '*') {\n      var brElement = createElement('br');\n      if (startElementOLTest) {\n        range.startContainer.textContent = range.startContainer.textContent.slice(range.startOffset, range.startContainer.textContent.length);\n        if (range.startContainer.nodeName === '#text' && range.startContainer.textContent.length === 0) {\n          this.parent.domNode.insertAfter(brElement, range.startContainer);\n        }\n        this.applyListsHandler({\n          subCommand: 'OL',\n          callBack: e.callBack\n        });\n        e.event.preventDefault();\n      } else if (range.startContainer.textContent.replace(/\\u200B/g, '').slice(0, range.startOffset).trim() === '*' || range.startContainer.textContent.replace(/\\u200B/g, '').slice(0, range.startOffset).trim() === '-') {\n        range.startContainer.textContent = range.startContainer.textContent.slice(range.startOffset, range.startContainer.textContent.length);\n        if (range.startContainer.nodeName === '#text' && range.startContainer.textContent.length === 0) {\n          this.parent.domNode.insertAfter(brElement, range.startContainer);\n        }\n        this.applyListsHandler({\n          subCommand: 'UL',\n          callBack: e.callBack\n        });\n        e.event.preventDefault();\n      }\n    }\n  };\n  Lists.prototype.enterList = function (e) {\n    var range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n    var startNode = range.startContainer.nodeName === 'LI' ? range.startContainer : range.startContainer.parentElement.closest('LI');\n    var endNode = range.endContainer.nodeName === 'LI' ? range.endContainer : range.endContainer.parentElement.closest('LI');\n    // Checks for Image, Audio , Video Element inside List Element\n    var hasMediaElem = false;\n    if (!isNOU(startNode)) {\n      var videoElemList = startNode.querySelectorAll('.e-video-clickelem');\n      var embedVideoElem = videoElemList.length > 0 && videoElemList[0].childNodes[0].nodeName === 'IFRAME';\n      hasMediaElem = startNode.querySelectorAll('IMG').length > 0 || startNode.querySelectorAll('AUDIO').length > 0 || startNode.querySelectorAll('VIDEO').length > 0 || embedVideoElem;\n    }\n    if (!isNOU(startNode) && !isNOU(endNode) && startNode === endNode && startNode.tagName === 'LI' && startNode.textContent.trim() === '' && !hasMediaElem) {\n      if (startNode.innerHTML.indexOf('&nbsp;') >= 0) {\n        return;\n      }\n      if (startNode.textContent.charCodeAt(0) === 65279) {\n        startNode.textContent = '';\n      }\n      var startNodeParent = startNode.parentElement;\n      var parentOfCurrentOLUL = startNodeParent.parentElement;\n      if (isNOU(parentOfCurrentOLUL.closest('UL')) && isNOU(parentOfCurrentOLUL.closest('OL'))) {\n        if (!isNOU(startNode.nextElementSibling)) {\n          var nearBlockNode = this.parent.domNode.blockParentNode(startNode);\n          this.parent.nodeCutter.GetSpliceNode(range, nearBlockNode);\n        }\n        var insertTag = void 0;\n        if (e.enterAction === 'DIV') {\n          insertTag = createElement('div');\n          insertTag.innerHTML = '<br>';\n        } else if (e.enterAction === 'P') {\n          insertTag = createElement('p');\n          insertTag.innerHTML = '<br>';\n        } else {\n          insertTag = createElement('br');\n        }\n        if (!isNOU(parentOfCurrentOLUL) && parentOfCurrentOLUL.nodeName === 'BLOCKQUOTE') {\n          this.parent.observer.notify('blockquote_list_handled', {});\n        }\n        this.parent.domNode.insertAfter(insertTag, startNodeParent);\n        e.event.preventDefault();\n        this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument, insertTag, 0);\n        if (startNodeParent.textContent === '' && startNodeParent.querySelectorAll('audio,video').length === 0) {\n          detach(startNodeParent);\n        } else {\n          detach(startNode);\n        }\n      }\n      // To handle the nested enter key press in the list for the first LI element\n      if (!isNOU(parentOfCurrentOLUL) && (!isNOU(parentOfCurrentOLUL.closest('UL')) || !isNOU(parentOfCurrentOLUL.closest('OL'))) && parentOfCurrentOLUL.nodeName === 'LI' && parentOfCurrentOLUL.style.listStyleType === 'none' && parentOfCurrentOLUL.textContent === '' && startNode.textContent === '' && startNode === startNodeParent.firstElementChild && isNOU(startNode.nextSibling)) {\n        detach(startNodeParent);\n        parentOfCurrentOLUL.style.removeProperty('list-style-type');\n        e.event.preventDefault();\n      }\n    }\n  };\n  Lists.prototype.backspaceList = function (e) {\n    var range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n    var startNode = this.parent.domNode.getSelectedNode(range.startContainer, range.startOffset);\n    var endNode = this.parent.domNode.getSelectedNode(range.endContainer, range.endOffset);\n    startNode = startNode.nodeName === 'BR' ? startNode.parentElement : startNode;\n    endNode = endNode.nodeName === 'BR' ? endNode.parentElement : endNode;\n    if (startNode === endNode && !isNullOrUndefined(closest(startNode, 'li')) && (startNode.textContent.trim() === '' && startNode.textContent.charCodeAt(0) === 65279 || startNode.textContent.length === 1 && startNode.textContent.charCodeAt(0) === 8203)) {\n      startNode.textContent = '';\n    }\n    if (startNode === endNode && startNode.tagName === 'LI' && startNode.textContent.length === 0 && isNOU(startNode.previousElementSibling)) {\n      startNode.removeAttribute('style');\n    }\n    if (startNode === endNode && startNode.textContent === '') {\n      if (startNode.parentElement.tagName === 'LI' && endNode.parentElement.tagName === 'LI') {\n        detach(startNode);\n      } else if (startNode.closest('ul') || startNode.closest('ol')) {\n        var parentList = !isNOU(startNode.closest('ul')) ? startNode.closest('ul') : startNode.closest('ol');\n        if (parentList.firstElementChild === startNode && !isNOU(parentList.children[1]) && (parentList.children[1].tagName === 'OL' || parentList.children[1].tagName === 'UL')) {\n          if (parentList.tagName === parentList.children[1].tagName) {\n            while (parentList.children[1].lastChild) {\n              this.parent.domNode.insertAfter(parentList.children[1].lastChild, parentList.children[1]);\n            }\n            detach(parentList.children[1]);\n          } else {\n            parentList.parentElement.insertBefore(parentList.children[1], parentList);\n          }\n        }\n      }\n    } else if (!isNOU(startNode.firstChild) && startNode.firstChild.nodeName === 'BR' && !isNullOrUndefined(startNode.childNodes[1]) && (startNode.childNodes[1].nodeName === 'UL' || startNode.childNodes[1].nodeName === 'OL')) {\n      var parentList = !isNOU(startNode.closest('ul')) ? startNode.closest('ul') : startNode.closest('ol');\n      if (parentList.tagName === startNode.childNodes[1].nodeName) {\n        while (startNode.childNodes[1].lastChild) {\n          this.parent.domNode.insertAfter(startNode.children[1].lastChild, startNode);\n        }\n        detach(startNode.childNodes[1]);\n      } else {\n        parentList.parentElement.insertBefore(startNode.children[1], parentList);\n      }\n    }\n    this.removeList(range, e);\n    this.firstListBackSpace(range, e);\n  };\n  Lists.prototype.removeList = function (range, e) {\n    var startNode = this.parent.domNode.getSelectedNode(range.startContainer, range.startOffset);\n    var endNode = !isNOU(range.endContainer.parentElement.closest('li')) && range.endContainer.parentElement.closest('li').childElementCount > 1 && range.endContainer.nodeName === '#text' ? range.endContainer : this.parent.domNode.getSelectedNode(range.endContainer, range.endOffset);\n    var parentList = range.startContainer.nodeName === '#text' ? range.startContainer.parentElement.closest('li') : range.startContainer.closest('li');\n    var fullContent = '';\n    if (!isNOU(parentList) && !isNOU(parentList.firstChild)) {\n      parentList.childNodes.forEach(function (e) {\n        fullContent = fullContent + e.textContent;\n      });\n    }\n    startNode = startNode.nodeName === 'BR' ? startNode.parentElement : startNode;\n    endNode = endNode.nodeName === 'BR' ? endNode.parentElement : endNode;\n    startNode = startNode.nodeName !== 'LI' && !isNOU(startNode.closest('LI')) ? startNode.closest('LI') : startNode;\n    endNode = endNode.nodeName !== 'LI' && endNode.nodeName !== '#text' && !isNOU(endNode.closest('LI')) ? endNode.closest('LI') : endNode;\n    if ((range.commonAncestorContainer.nodeName === 'OL' || range.commonAncestorContainer.nodeName === 'UL' || range.commonAncestorContainer.nodeName === 'LI') && isNOU(endNode.nextElementSibling) && endNode.textContent.length === range.endOffset && isNOU(startNode.previousElementSibling) && range.startOffset === 0 || Browser.userAgent.indexOf('Firefox') !== -1 && range.startContainer === range.endContainer && range.startContainer === this.parent.editableElement && range.startOffset === 0 && range.endOffset === 1) {\n      if (Browser.userAgent.indexOf('Firefox') !== -1) {\n        detach(range.commonAncestorContainer.childNodes[0]);\n      } else if (range.commonAncestorContainer.nodeName === 'LI') {\n        detach(range.commonAncestorContainer.parentElement);\n      } else {\n        detach(range.commonAncestorContainer);\n      }\n      e.event.preventDefault();\n    } else if (!isNOU(parentList) && !range.collapsed && parentList.textContent === fullContent) {\n      range.deleteContents();\n      this.parent.editableElement.querySelectorAll('li').forEach(function (li) {\n        if (!li.firstChild || li.textContent.trim() === '') {\n          li.parentNode.removeChild(li);\n        }\n      });\n      this.parent.editableElement.querySelectorAll('ol').forEach(function (ol) {\n        if (!ol.firstChild || ol.textContent.trim() === '') {\n          ol.parentNode.removeChild(ol);\n        }\n      });\n      this.parent.editableElement.querySelectorAll('ul').forEach(function (ul) {\n        if (!ul.firstChild || ul.textContent.trim() === '') {\n          ul.parentNode.removeChild(ul);\n        }\n      });\n      e.event.preventDefault();\n    }\n  };\n  Lists.prototype.onKeyUp = function (e) {\n    if (!isNOU(this.commonLIParent) && !isNOU(this.commonLIParent.querySelector('.removeList'))) {\n      var currentLIElem = this.commonLIParent.querySelector('.removeList');\n      while (!isNOU(currentLIElem.firstChild)) {\n        this.parent.domNode.insertAfter(currentLIElem.firstChild, currentLIElem);\n      }\n      detach(currentLIElem);\n    }\n    if (e.event.keyCode === 13) {\n      var listElements = this.parent.editableElement.querySelectorAll('UL, OL');\n      for (var i = 0; i < listElements.length; i++) {\n        if (!isNullOrUndefined(listElements[i]) && !isNOU(listElements[i].parentElement) && !isNullOrUndefined(listElements[i].previousElementSibling) && (listElements[i].parentElement.nodeName === 'UL' || listElements[i].parentElement.nodeName === 'OL')) {\n          listElements[i].previousElementSibling.appendChild(listElements[i]);\n        }\n      }\n    }\n  };\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  Lists.prototype.firstListBackSpace = function (range, _e) {\n    var startNode = this.parent.domNode.getSelectedNode(range.startContainer, range.startOffset);\n    if (!isNOU(startNode.closest('OL'))) {\n      this.commonLIParent = startNode.closest('OL');\n    } else if (!isNOU(startNode.closest('UL'))) {\n      this.commonLIParent = startNode.closest('UL');\n    }\n    if (startNode.nodeName === 'LI' && range.startOffset === 0 && range.endOffset === 0 && isNOU(startNode.previousSibling) && !isNOU(this.commonLIParent) && isNOU(this.commonLIParent.previousSibling) && isNOU(this.commonLIParent.parentElement.closest('OL')) && isNOU(this.commonLIParent.parentElement.closest('UL')) && isNOU(this.commonLIParent.parentElement.closest('LI'))) {\n      var currentElem = createElement('P');\n      currentElem.innerHTML = '&#8203;';\n      startNode.classList.add('removeList');\n      this.commonLIParent.parentElement.insertBefore(currentElem, this.commonLIParent);\n    }\n  };\n  Lists.prototype.keyDownHandler = function (e) {\n    if (e.event.which === 13) {\n      this.enterList(e);\n    }\n    if (e.event.which === 32) {\n      this.spaceList(e);\n    }\n    if (e.event.which === 8) {\n      this.backspaceList(e);\n    }\n    if (e.event.which === 46 && e.event.action === 'delete') {\n      var range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n      var commonAncestor = range.commonAncestorContainer;\n      var startEle = range.startContainer;\n      var endEle = range.endContainer;\n      var startNode = startEle.nodeType === 3 ? this.domNode.blockParentNode(startEle) : startEle;\n      var endNode = endEle.nodeType === 3 ? this.domNode.blockParentNode(endEle) : endEle;\n      if ((commonAncestor.nodeName === 'UL' || commonAncestor.nodeName === 'OL') && startNode !== endNode && (!isNullOrUndefined(closest(startNode, 'ul')) || !isNullOrUndefined(closest(startNode, 'ol'))) && (!isNullOrUndefined(closest(endNode, 'ul')) || !isNullOrUndefined(closest(endNode, 'ol'))) && commonAncestor.lastElementChild === closest(endNode, 'li') && commonAncestor.lastChild !== endNode && !range.collapsed) {\n        if (this.areAllListItemsSelected(commonAncestor, range)) {\n          detach(commonAncestor);\n        }\n      }\n      this.removeList(range, e);\n    }\n    if (e.event.which === 9) {\n      var range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n      if (!(e.event.action && e.event.action === 'indent')) {\n        this.saveSelection = this.parent.nodeSelection.save(range, this.parent.currentDocument);\n      }\n      var blockNodes = void 0;\n      var startOffset = range.startOffset;\n      var endOffset = range.endOffset;\n      var startNode = this.parent.domNode.getSelectedNode(range.startContainer, range.startOffset);\n      var endNode = this.parent.domNode.getSelectedNode(range.endContainer, range.endOffset);\n      if (startNode === endNode && (startNode.nodeName === 'BR' || startNode.nodeName === '#text') && CONSTANT.IGNORE_BLOCK_TAGS.indexOf(startNode.parentNode.tagName.toLocaleLowerCase()) >= 0) {\n        return;\n      } else {\n        if (!(e.event.action && e.event.action === 'indent')) {\n          this.domNode.setMarker(this.saveSelection);\n        }\n        blockNodes = this.domNode.blockNodes();\n      }\n      var nodes = [];\n      var isNested = true;\n      for (var i = 0; i < blockNodes.length; i++) {\n        if (blockNodes[i].parentNode.tagName === 'LI') {\n          nodes.push(blockNodes[i].parentNode);\n        } else if (blockNodes[i].tagName === 'LI' && blockNodes[i].childNodes[0].tagName !== 'P' && blockNodes[i].childNodes[0].tagName !== 'OL' && blockNodes[i].childNodes[0].tagName !== 'UL') {\n          nodes.push(blockNodes[i]);\n        }\n      }\n      if (nodes.length > 1 || nodes.length === 1) {\n        e.event.preventDefault();\n        e.event.stopPropagation();\n        this.currentAction = this.getAction(nodes[0]);\n        if (e.event.shiftKey) {\n          this.revertList(nodes, e);\n          this.revertClean();\n        } else {\n          isNested = this.nestedList(nodes);\n        }\n        if (isNested) {\n          this.cleanNode();\n          this.parent.editableElement.focus({\n            preventScroll: true\n          });\n        }\n        if (!(e.event.action && e.event.action === 'indent')) {\n          this.saveSelection = this.domNode.saveMarker(this.saveSelection);\n          this.saveSelection.restore();\n          if (e.callBack) {\n            e.callBack({\n              requestType: this.currentAction,\n              editorMode: 'HTML',\n              range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n              elements: this.parent.domNode.blockNodes(),\n              event: e.event\n            });\n          }\n        }\n      } else {\n        if (!(e.event.action && e.event.action === 'indent')) {\n          if (e.event && e.event.shiftKey && e.event.key === 'Tab') {\n            e.event.action = 'tab';\n          }\n          this.saveSelection = this.domNode.saveMarker(this.saveSelection);\n          this.saveSelection.restore();\n        }\n      }\n    } else {\n      switch (e.event.action) {\n        case 'ordered-list':\n          this.applyListsHandler({\n            subCommand: 'OL',\n            callBack: e.callBack\n          });\n          e.event.preventDefault();\n          break;\n        case 'unordered-list':\n          this.applyListsHandler({\n            subCommand: 'UL',\n            callBack: e.callBack\n          });\n          e.event.preventDefault();\n          break;\n      }\n    }\n  };\n  Lists.prototype.spaceKeyAction = function (e) {\n    if (e.event.which === 32) {\n      this.spaceList(e);\n    }\n  };\n  Lists.prototype.getAction = function (element) {\n    var parentNode = element.parentNode;\n    return parentNode.nodeName === 'OL' ? 'OL' : 'UL';\n  };\n  Lists.prototype.revertClean = function () {\n    var collectionNodes = this.parent.editableElement.querySelectorAll('ul, ol');\n    for (var i = 0; i < collectionNodes.length; i++) {\n      var listNodes = collectionNodes[i].querySelectorAll('ul, ol');\n      if (listNodes.length > 0) {\n        for (var j = 0; j < listNodes.length; j++) {\n          var prevSibling = listNodes[j].previousSibling;\n          if (prevSibling && prevSibling.tagName === 'LI') {\n            prevSibling.appendChild(listNodes[j]);\n          }\n        }\n      }\n    }\n  };\n  Lists.prototype.noPreviousElement = function (elements) {\n    var firstNode;\n    var firstNodeOL;\n    var siblingListOL = elements.querySelectorAll('ol, ul');\n    var siblingListLI = elements.querySelectorAll('li');\n    var siblingListLIFirst = this.domNode.contents(siblingListLI[0])[0];\n    if (siblingListLI.length > 0 && (siblingListLIFirst.nodeName === 'OL' || siblingListLIFirst.nodeName === 'UL')) {\n      firstNode = siblingListLI[0];\n    } else {\n      firstNodeOL = siblingListOL[0];\n    }\n    if (firstNode) {\n      for (var h = this.domNode.contents(elements)[0]; h && !this.domNode.isList(h); null) {\n        var nextSibling = h.nextSibling;\n        prepend([h], firstNode);\n        setStyleAttribute(elements, {\n          'list-style-type': 'none'\n        });\n        setStyleAttribute(firstNode, {\n          'list-style-type': ''\n        });\n        h = nextSibling;\n      }\n    } else if (firstNodeOL) {\n      var nestedElement = createElement('li');\n      prepend([nestedElement], firstNodeOL);\n      for (var h = this.domNode.contents(elements)[0]; h && !this.domNode.isList(h); null) {\n        var nextSibling = h.nextSibling;\n        nestedElement.appendChild(h);\n        h = nextSibling;\n      }\n      prepend([firstNodeOL], elements.parentNode);\n      detach(elements);\n      var nestedElementLI = createElement('li', {\n        styles: 'list-style-type: none;'\n      });\n      prepend([nestedElementLI], firstNodeOL.parentNode);\n      append([firstNodeOL], nestedElementLI);\n    } else {\n      var nestedElementLI = createElement('li', {\n        styles: 'list-style-type: none;'\n      });\n      prepend([nestedElementLI], elements.parentNode);\n      var nestedElement = createElement(elements.parentNode.tagName);\n      prepend([nestedElement], nestedElementLI);\n      append([elements], nestedElement);\n    }\n  };\n  Lists.prototype.nestedList = function (elements) {\n    var isNested = false;\n    for (var i = 0; i < elements.length; i++) {\n      var prevSibling = this.domNode.getPreviousNode(elements[i]);\n      if (prevSibling) {\n        isNested = true;\n        var firstNode = void 0;\n        var firstNodeLI = void 0;\n        var siblingListOL = elements[i].querySelectorAll('ol, ul');\n        var siblingListLI = elements[i].querySelectorAll('li');\n        var siblingListLIFirst = this.domNode.contents(siblingListLI[0])[0];\n        if (siblingListLI.length > 0 && (siblingListLIFirst.nodeName === 'OL' || siblingListLIFirst.nodeName === 'UL')) {\n          firstNodeLI = siblingListLI[0];\n        } else {\n          firstNode = siblingListOL[0];\n        }\n        if (firstNode) {\n          var nestedElement = createElement('li');\n          prepend([nestedElement], firstNode);\n          for (var h = this.domNode.contents(elements[i])[0]; h && !this.domNode.isList(h); null) {\n            var nextSibling = h.nextSibling;\n            nestedElement.appendChild(h);\n            h = nextSibling;\n          }\n          append([firstNode], prevSibling);\n          detach(elements[i]);\n        } else if (firstNodeLI) {\n          if (prevSibling.tagName === 'LI') {\n            for (var h = this.domNode.contents(elements[i])[0]; h && !this.domNode.isList(h); null) {\n              var nextSibling = h.nextSibling;\n              prepend([h], firstNodeLI);\n              setStyleAttribute(elements[i], {\n                'list-style-type': 'none'\n              });\n              setStyleAttribute(firstNodeLI, {\n                'list-style-type': ''\n              });\n              h = nextSibling;\n            }\n            append([firstNodeLI.parentNode], prevSibling);\n            detach(elements[i]);\n          }\n        } else {\n          if (prevSibling.tagName === 'LI') {\n            var nestedElement = createElement(elements[i].parentNode.tagName);\n            nestedElement.style.listStyleType = elements[i].parentNode.style.listStyleType;\n            append([nestedElement], prevSibling);\n            append([elements[i]], nestedElement);\n          } else if (prevSibling.tagName === 'OL' || prevSibling.tagName === 'UL') {\n            append([elements[i]], prevSibling);\n          }\n        }\n      } else {\n        var element = elements[i];\n        isNested = true;\n        this.noPreviousElement(element);\n      }\n    }\n    return isNested;\n  };\n  Lists.prototype.applyListsHandler = function (e) {\n    var range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n    if (Browser.userAgent.indexOf('Firefox') !== -1 && range.startContainer === range.endContainer && range.startContainer === this.parent.editableElement) {\n      var startChildNodes = range.startContainer.childNodes;\n      var startNode = startChildNodes[range.startOffset > 0 ? range.startOffset - 1 : range.startOffset] || range.startContainer;\n      var endNode = range.endContainer.childNodes[range.endOffset > 0 ? range.endOffset - 1 : range.endOffset] || range.endContainer;\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      var lastSelectionNode = endNode.lastChild.nodeName === 'BR' ? isNOU(endNode.lastChild.previousSibling) ? endNode : endNode.lastChild.previousSibling : endNode.lastChild;\n      while (!isNOU(lastSelectionNode) && lastSelectionNode.nodeName !== '#text' && lastSelectionNode.nodeName !== 'IMG' && lastSelectionNode.nodeName !== 'BR' && lastSelectionNode.nodeName !== 'HR') {\n        lastSelectionNode = lastSelectionNode.lastChild;\n      }\n      this.parent.nodeSelection.setSelectionText(this.parent.currentDocument, startNode, lastSelectionNode, 0, lastSelectionNode.textContent.length);\n      range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n    }\n    if (range.startContainer === range.endContainer && range.startContainer === this.parent.editableElement && range.startOffset === range.endOffset && range.startOffset === 0 && this.parent.editableElement.textContent.length === 0 && this.parent.editableElement.childNodes[0].nodeName !== 'TABLE' && this.parent.editableElement.childNodes[0].nodeName !== 'IMG') {\n      var focusNode = range.startContainer.childNodes[0];\n      this.parent.nodeSelection.setSelectionText(this.parent.currentDocument, focusNode, focusNode, 0, 0);\n      range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n    }\n    this.saveSelection = this.parent.nodeSelection.save(range, this.parent.currentDocument);\n    this.currentAction = e.subCommand;\n    this.currentAction = e.subCommand = this.currentAction === 'NumberFormatList' ? 'OL' : this.currentAction === 'BulletFormatList' ? 'UL' : this.currentAction;\n    this.domNode.setMarker(this.saveSelection);\n    var listsNodes = this.domNode.blockNodes(true);\n    if (e.enterAction === 'BR') {\n      this.setSelectionBRConfig();\n      this.parent.domNode.convertToBlockNodes(this.parent.domNode.blockNodes(), true);\n      this.setSelectionBRConfig();\n      listsNodes = this.parent.domNode.blockNodes();\n    }\n    for (var i = 0; i < listsNodes.length; i++) {\n      if (listsNodes[i].tagName === 'TABLE' && !range.collapsed) {\n        listsNodes.splice(i, 1);\n      }\n      if (listsNodes.length > 0 && listsNodes[i].tagName !== 'LI' && 'LI' === listsNodes[i].parentNode.tagName) {\n        listsNodes[i] = listsNodes[i].parentNode;\n      }\n    }\n    this.applyLists(listsNodes, this.currentAction, e.selector, e.item, e);\n    if (e.callBack) {\n      e.callBack({\n        requestType: this.currentAction,\n        event: e.event,\n        editorMode: 'HTML',\n        range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n        elements: this.parent.domNode.blockNodes()\n      });\n    }\n  };\n  Lists.prototype.setSelectionBRConfig = function () {\n    var startElem = this.parent.editableElement.querySelector('.' + markerClassName.startSelection);\n    var endElem = this.parent.editableElement.querySelector('.' + markerClassName.endSelection);\n    if (isNOU(endElem)) {\n      this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument, startElem, 0);\n    } else {\n      this.parent.nodeSelection.setSelectionText(this.parent.currentDocument, startElem, endElem, 0, 0);\n    }\n  };\n  Lists.prototype.applyLists = function (elements, type, selector, item, e) {\n    var isReverse = true;\n    if (this.isRevert(elements, type, item) && isNOU(item)) {\n      this.revertList(elements, e);\n      this.removeEmptyListElements();\n    } else {\n      this.checkLists(elements, type, item);\n      var marginLeftAttribute = '';\n      if (elements[0].style.marginLeft !== '') {\n        marginLeftAttribute = ' style = \"margin-left: ' + elements[0].style.marginLeft + ';\"';\n      }\n      for (var i = 0; i < elements.length; i++) {\n        if (!isNOU(item) && !isNOU(item.listStyle)) {\n          if (item.listStyle === 'listImage') {\n            setStyleAttribute(elements[i], {\n              'list-style-image': item.listImage\n            });\n          } else {\n            setStyleAttribute(elements[i], {\n              'list-style-image': 'none'\n            });\n            setStyleAttribute(elements[i], {\n              'list-style-type': item.listStyle.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase()\n            });\n          }\n        }\n        elements[i].style.removeProperty('margin-left');\n        var elemAtt = elements[i].tagName === 'IMG' || elements[i].classList.contains('e-editor-select-start') ? '' : this.domNode.attributes(elements[i]);\n        if (elements[i].getAttribute('contenteditable') === 'true' && elements[i].childNodes.length === 1 && elements[i].childNodes[0].nodeName === 'TABLE') {\n          var listEle = document.createElement(type);\n          listEle.innerHTML = '<li><br/></li>';\n          elements[i].appendChild(listEle);\n        } else if ('LI' !== elements[i].tagName && isNOU(item) && elements[i].nodeName === 'BLOCKQUOTE') {\n          isReverse = false;\n          var openTag = '<' + type + marginLeftAttribute + '>';\n          var closeTag = '</' + type + '>';\n          var newTag = 'li' + elemAtt;\n          var replaceHTML = elements[i].innerHTML;\n          var innerHTML = this.domNode.createTagString(newTag, null, replaceHTML);\n          var collectionString = openTag + innerHTML + closeTag;\n          elements[i].innerHTML = collectionString;\n        } else if ('LI' !== elements[i].tagName && isNOU(item)) {\n          isReverse = false;\n          var openTag = '<' + type + marginLeftAttribute + '>';\n          var closeTag = '</' + type + '>';\n          var newTag = 'li' + elemAtt;\n          var replaceHTML = elements[i].tagName.toLowerCase() === CONSTANT.DEFAULT_TAG ? elements[i].innerHTML : elements[i].outerHTML;\n          var innerHTML = this.domNode.createTagString(newTag, null, replaceHTML);\n          var collectionString = openTag + innerHTML + closeTag;\n          this.domNode.replaceWith(elements[i], collectionString);\n        } else if (!isNOU(item) && 'LI' !== elements[i].tagName) {\n          // eslint-disable-next-line\n          isReverse = false;\n          var currentElemAtt = elements[i].tagName === 'IMG' ? '' : this.domNode.attributes(elements[i]);\n          var openTag = '<' + type + currentElemAtt + '>';\n          var closeTag = '</' + type + '>';\n          var newTag = 'li';\n          var replaceHTML = elements[i].tagName.toLowerCase() === CONSTANT.DEFAULT_TAG ? elements[i].innerHTML : elements[i].outerHTML;\n          var innerHTML = this.domNode.createTagString(newTag, null, replaceHTML);\n          var collectionString = openTag + innerHTML + closeTag;\n          this.domNode.replaceWith(elements[i], collectionString);\n        }\n      }\n    }\n    this.cleanNode();\n    if (e.enterAction === 'BR') {\n      var spansToRemove = document.querySelectorAll('span#removeSpan');\n      spansToRemove.forEach(function (span) {\n        var fragment = document.createDocumentFragment();\n        while (span.firstChild) {\n          fragment.appendChild(span.firstChild);\n        }\n        span.parentNode.replaceChild(fragment, span);\n      });\n    }\n    this.parent.editableElement.focus({\n      preventScroll: true\n    });\n    if (isIDevice()) {\n      setEditFrameFocus(this.parent.editableElement, selector);\n    }\n    this.saveSelection = this.domNode.saveMarker(this.saveSelection);\n    this.saveSelection.restore();\n  };\n  Lists.prototype.removeEmptyListElements = function () {\n    var listElem = this.parent.editableElement.querySelectorAll('ol, ul');\n    for (var i = 0; i < listElem.length; i++) {\n      if (listElem[i].textContent.trim() === '') {\n        detach(listElem[i]);\n      }\n    }\n  };\n  Lists.prototype.isRevert = function (nodes, tagName, item) {\n    var isRevert = true;\n    for (var i = 0; i < nodes.length; i++) {\n      if (nodes[i].tagName !== 'LI') {\n        return false;\n      }\n      if (nodes[i].parentNode.tagName !== tagName || isNOU(item) && nodes[i].parentNode.style.listStyleType !== '') {\n        isRevert = false;\n      }\n      if (nodes[i].parentNode.tagName === tagName && nodes[i].parentNode.style.listStyleType !== '') {\n        isRevert = true;\n      }\n    }\n    return isRevert;\n  };\n  Lists.prototype.checkLists = function (nodes, tagName, item) {\n    var nodesTemp = [];\n    for (var i = 0; i < nodes.length; i++) {\n      var node = nodes[i].parentNode;\n      if (!isNOU(item) && 'LI' === nodes[i].tagName && !isNOU(item.listStyle)) {\n        if (item.listStyle === 'listImage') {\n          setStyleAttribute(node, {\n            'list-style-image': item.listImage\n          });\n        } else {\n          setStyleAttribute(node, {\n            'list-style-image': 'none'\n          });\n          setStyleAttribute(node, {\n            'list-style-type': item.listStyle.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase()\n          });\n        }\n      }\n      if (nodes[i].tagName === 'LI' && node.tagName !== tagName && nodesTemp.indexOf(node) < 0 || nodes[i].tagName === 'LI' && node.tagName === tagName && nodesTemp.indexOf(node) < 0 && item !== null) {\n        nodesTemp.push(node);\n      }\n      if (isNOU(item) && (node.tagName === tagName || (node.tagName === 'UL' || node.tagName === 'OL') && node.hasAttribute('style'))) {\n        if (node.hasAttribute('style')) {\n          node.removeAttribute('style');\n        }\n      }\n    }\n    for (var j = nodesTemp.length - 1; j >= 0; j--) {\n      var h = nodesTemp[j];\n      var replace = '<' + tagName.toLowerCase() + ' ' + this.domNode.attributes(h) + '>' + h.innerHTML + '</' + tagName.toLowerCase() + '>';\n      this.domNode.replaceWith(nodesTemp[j], replace);\n    }\n  };\n  Lists.prototype.cleanNode = function () {\n    var liParents = this.parent.editableElement.querySelectorAll('ol + ol, ul + ul');\n    var listStyleType;\n    var firstNodeOL;\n    for (var c = 0; c < liParents.length; c++) {\n      var node = liParents[c];\n      var toFindtopOlUl = true;\n      var containsListElements = node;\n      while (containsListElements.parentElement) {\n        if (containsListElements.parentElement && containsListElements.parentElement.tagName !== 'LI' && containsListElements.parentElement.tagName !== 'OL' && containsListElements.parentElement.tagName !== 'UL') {\n          break;\n        }\n        containsListElements = containsListElements.parentElement;\n      }\n      if (toFindtopOlUl && (liParents[c].parentElement.parentElement.nodeName === 'OL' || liParents[c].parentElement.parentElement.nodeName === 'UL')) {\n        toFindtopOlUl = false;\n        var preElement = liParents[c].parentElement.parentElement;\n        listStyleType = preElement.style.listStyleType;\n        firstNodeOL = node.previousElementSibling;\n      }\n      if (this.domNode.isList(node.previousElementSibling) && this.domNode.openTagString(node) === this.domNode.openTagString(node.previousElementSibling)) {\n        var contentNodes = this.domNode.contents(node);\n        for (var f = 0; f < contentNodes.length; f++) {\n          node.previousElementSibling.appendChild(contentNodes[f]);\n        }\n        node.parentNode.removeChild(node);\n      } else if (!isNOU(node.getAttribute('level'))) {\n        if (node.tagName === node.previousElementSibling.tagName) {\n          node.previousElementSibling.lastChild.append(node);\n        }\n      } else if (this.domNode.isList(node.previousElementSibling) && containsListElements.contains(node.previousElementSibling) && (node.tagName === 'OL' || node.tagName === 'UL') && (node.previousElementSibling.nodeName === 'OL' || node.previousElementSibling.nodeName === 'UL')) {\n        var contentNodes = this.domNode.contents(node);\n        for (var f = 0; f < contentNodes.length; f++) {\n          node.previousElementSibling.appendChild(contentNodes[f]);\n        }\n        node.parentNode.removeChild(node);\n      }\n    }\n    if (firstNodeOL) {\n      firstNodeOL.style.listStyleType = listStyleType;\n      var range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n      var listOlUlElements = [];\n      if (range.commonAncestorContainer.nodeName === 'UL' || range.commonAncestorContainer.nodeName === 'OL') {\n        if (range.commonAncestorContainer instanceof Element) {\n          listOlUlElements.push(range.commonAncestorContainer);\n        }\n        listOlUlElements = listOlUlElements.concat(Array.from(range.commonAncestorContainer.querySelectorAll('ol, ul')));\n      } else {\n        listOlUlElements = Array.from(range.commonAncestorContainer.querySelectorAll('ol, ul'));\n      }\n      for (var k = 0; k < listOlUlElements.length; k++) {\n        var listStyle = void 0;\n        var listElements = listOlUlElements[k];\n        while (listElements) {\n          if (listElements.nodeName === 'OL' || listElements.nodeName === 'OL') {\n            if (listElements.style.listStyleType !== '' && listElements.style.listStyleType !== 'none' && listElements.nodeName !== 'LI') {\n              listStyle = listElements.style.listStyleType;\n            } else if (!isNOU(listStyle) && (listElements.style.listStyleType === '' || listElements.style.listStyleType === 'none') && listElements.nodeName !== 'LI' && (listElements.nodeName === 'UL' || listElements.nodeName === 'OL')) {\n              listElements.style.listStyleType = listStyle;\n            }\n          }\n          listElements = listElements.querySelector('UL,OL');\n        }\n      }\n    }\n  };\n  Lists.prototype.findUnSelected = function (temp, elements) {\n    temp = temp.slice().reverse();\n    if (temp.length > 0) {\n      var rightIndent = [];\n      var indentElements = [];\n      var lastElement = elements[elements.length - 1];\n      var lastElementChild = [];\n      var childElements = [];\n      lastElementChild = lastElement.childNodes;\n      for (var z = 0; z < lastElementChild.length; z++) {\n        if (lastElementChild[z].tagName === 'OL' || lastElementChild[z].tagName === 'UL') {\n          var childLI = lastElementChild[z].querySelectorAll('li');\n          if (childLI.length > 0) {\n            for (var y = 0; y < childLI.length; y++) {\n              childElements.push(childLI[y]);\n            }\n          }\n        }\n      }\n      for (var i = 0; i < childElements.length; i++) {\n        var count = 0;\n        for (var j = 0; j < temp.length; j++) {\n          if (!childElements[i].contains(temp[j])) {\n            count = count + 1;\n          }\n        }\n        if (count === temp.length) {\n          indentElements.push(childElements[i]);\n        }\n      }\n      if (indentElements.length > 0) {\n        for (var x = 0; x < indentElements.length; x++) {\n          if (this.domNode.contents(indentElements[x])[0].nodeName !== 'OL' && this.domNode.contents(indentElements[x])[0].nodeName !== 'UL') {\n            rightIndent.push(indentElements[x]);\n          }\n        }\n      }\n      if (rightIndent.length > 0) {\n        this.nestedList(rightIndent);\n      }\n    }\n  };\n  Lists.prototype.revertList = function (elements, e) {\n    var temp = [];\n    for (var i = elements.length - 1; i >= 0; i--) {\n      for (var j = i - 1; j >= 0; j--) {\n        if (elements[j].contains(elements[i]) || elements[j] === elements[i]) {\n          temp.push(elements[i]);\n          elements.splice(i, 1);\n          break;\n        }\n      }\n    }\n    this.findUnSelected(temp, elements);\n    var viewNode = [];\n    for (var i = 0; i < elements.length; i++) {\n      var element = elements[i];\n      if (this.domNode.contents(element)[0].nodeType === 3 && this.domNode.contents(element)[0].textContent.trim().length === 0) {\n        detach(this.domNode.contents(element)[0]);\n      }\n      var parentNode = elements[i].parentNode;\n      var className = element.getAttribute('class');\n      if (temp.length === 0) {\n        var siblingList = elements[i].querySelectorAll('ul, ol');\n        var firstNode = siblingList[0];\n        if (firstNode) {\n          var child = firstNode.querySelectorAll('li');\n          if (child) {\n            var nestedElement = createElement(firstNode.tagName);\n            append([nestedElement], firstNode.parentNode);\n            var nestedElementLI = createElement('li', {\n              styles: 'list-style-type: none;'\n            });\n            append([nestedElementLI], nestedElement);\n            append([firstNode], nestedElementLI);\n          }\n        }\n      }\n      if (element.parentNode.insertBefore(this.closeTag(parentNode.tagName), element), 'LI' === parentNode.parentNode.tagName || 'OL' === parentNode.parentNode.tagName || 'UL' === parentNode.parentNode.tagName) {\n        element.parentNode.insertBefore(this.closeTag('LI'), element);\n      } else {\n        var classAttr = '';\n        if (className) {\n          // eslint-disable-next-line\n          classAttr += ' class=\"' + className + '\"';\n        }\n        if (CONSTANT.DEFAULT_TAG && 0 === element.querySelectorAll(CONSTANT.BLOCK_TAGS.join(', ')).length) {\n          var wrapperclass = isNullOrUndefined(className) ? ' class=\"e-rte-wrap-inner\"' : ' class=\"' + className + ' e-rte-wrap-inner\"';\n          var parentElement = parentNode;\n          if (elements.length === parentElement.querySelectorAll('li').length) {\n            if (!isNOU(parentElement.style.listStyleType)) {\n              parentNode.style.removeProperty('list-style-type');\n            }\n            if (!isNOU(parentElement.style.listStyleImage)) {\n              parentNode.style.removeProperty('list-style-image');\n            }\n            if (parentElement.style.length === 0) {\n              parentNode.removeAttribute('style');\n            }\n          }\n          var wrapperTag = isNullOrUndefined(e.enterAction) ? CONSTANT.DEFAULT_TAG : e.enterAction;\n          var wrapper = '<' + wrapperTag + wrapperclass + this.domNode.attributes(element) + '></' + wrapperTag + '>';\n          if (e.enterAction !== 'BR') {\n            this.domNode.wrapInner(element, this.domNode.parseHTMLFragment(wrapper));\n          } else {\n            var wrapperSpan = '<span class=e-rte-wrap-inner id=removeSpan></span>';\n            var br = document.createElement('br');\n            this.domNode.wrapInner(element, this.domNode.parseHTMLFragment(wrapperSpan));\n            element.appendChild(br);\n          }\n        } else if (this.domNode.contents(element)[0].nodeType === 3) {\n          var replace = this.domNode.createTagString(CONSTANT.DEFAULT_TAG, parentNode, this.parent.domNode.encode(this.domNode.contents(element)[0].textContent));\n          this.domNode.replaceWith(this.domNode.contents(element)[0], replace);\n        } else if (this.domNode.contents(element)[0].classList.contains(markerClassName.startSelection) || this.domNode.contents(element)[0].classList.contains(markerClassName.endSelection)) {\n          var replace = this.domNode.createTagString(CONSTANT.DEFAULT_TAG, parentNode, this.domNode.contents(element)[0].outerHTML);\n          this.domNode.replaceWith(this.domNode.contents(element)[0], replace);\n        } else {\n          var childNode = element.firstChild;\n          if (childNode) {\n            var attributes_1 = element.parentElement.attributes;\n            if (attributes_1.length > 0) {\n              for (var d = 0; d < attributes_1.length; d++) {\n                var e_1 = attributes_1[d];\n                var existingValue = childNode.getAttribute(e_1.nodeName);\n                var parentValue = element.parentElement.getAttribute(e_1.nodeName);\n                childNode.setAttribute(e_1.nodeName, existingValue ? parentValue + ' ' + existingValue : parentValue);\n              }\n            }\n          }\n          className = childNode.getAttribute('class');\n          if (className && childNode.getAttribute('class')) {\n            attributes(childNode, {\n              'class': className + ' ' + childNode.getAttribute('class')\n            });\n          }\n        }\n        append([this.openTag('LI')], element);\n        prepend([this.closeTag('LI')], element);\n      }\n      this.domNode.insertAfter(this.openTag(parentNode.tagName), element);\n      if (parentNode.parentNode.tagName === 'LI') {\n        parentNode = parentNode.parentNode.parentNode;\n      }\n      if (viewNode.indexOf(parentNode) < 0) {\n        viewNode.push(parentNode);\n      }\n    }\n    for (var i = 0; i < viewNode.length; i++) {\n      var node = viewNode[i];\n      var nodeInnerHtml = node.innerHTML;\n      var closeTag = /<span class=\"e-rte-list-close-([a-z]*)\"><\\/span>/g;\n      var openTag = /<span class=\"e-rte-list-open-([a-z]*)\"><\\/span>/g;\n      nodeInnerHtml = nodeInnerHtml.replace(closeTag, '</$1>');\n      nodeInnerHtml = nodeInnerHtml.replace(openTag, '<$1 ' + this.domNode.attributes(node) + '>');\n      this.domNode.replaceWith(node, this.domNode.openTagString(node) + nodeInnerHtml.trim() + this.domNode.closeTagString(node));\n    }\n    var emptyUl = this.parent.editableElement.querySelectorAll('ul:empty, ol:empty');\n    for (var i = 0; i < emptyUl.length; i++) {\n      detach(emptyUl[i]);\n    }\n    var emptyLi = this.parent.editableElement.querySelectorAll('li:empty');\n    for (var i = 0; i < emptyLi.length; i++) {\n      detach(emptyLi[i]);\n    }\n  };\n  Lists.prototype.openTag = function (type) {\n    return this.domNode.parseHTMLFragment('<span class=\"e-rte-list-open-' + type.toLowerCase() + '\"></span>');\n  };\n  Lists.prototype.closeTag = function (type) {\n    return this.domNode.parseHTMLFragment('<span class=\"e-rte-list-close-' + type.toLowerCase() + '\"></span>');\n  };\n  Lists.prototype.destroy = function () {\n    this.removeEventListener();\n    if (this.domNode) {\n      this.domNode = null;\n    }\n  };\n  Lists.prototype.areAllListItemsSelected = function (list, range) {\n    var listItems = list.querySelectorAll('li');\n    for (var i = 0; i < listItems.length; i++) {\n      var listItem = listItems[i];\n      var listItemRange = this.parent.currentDocument.createRange();\n      listItemRange.selectNodeContents(listItem);\n      if (!range.intersectsNode(listItem)) {\n        return false;\n      }\n    }\n    return true;\n  };\n  return Lists;\n}();\nexport { Lists };","map":{"version":3,"names":["CONSTANT","createElement","detach","prepend","append","attributes","Browser","markerClassName","EVENTS","setStyleAttribute","isIDevice","setEditFrameFocus","isNullOrUndefined","isNOU","closest","Lists","parent","domNode","addEventListener","prototype","observer","on","LIST_TYPE","applyListsHandler","KEY_UP_HANDLER","onKeyUp","KEY_DOWN_HANDLER","keyDownHandler","SPACE_ACTION","spaceKeyAction","INTERNAL_DESTROY","destroy","removeEventListener","off","testList","elem","olListRegex","elementStart","innerText","trim","split","i","length","test","testCurrentList","range","olListStartRegex","startContainer","textContent","slice","startOffset","currentContent","replace","spaceList","e","nodeSelection","getRange","currentDocument","saveSelection","save","startNode","getSelectedNode","endNode","endContainer","endOffset","preElement","previousElementSibling","nextElement","nextElementSibling","preElemULStart","substring","nextElemULStart","startElementOLTest","preElementOLTest","nextElementOLTest","brElement","nodeName","insertAfter","subCommand","callBack","event","preventDefault","enterList","parentElement","hasMediaElem","videoElemList","querySelectorAll","embedVideoElem","childNodes","tagName","innerHTML","indexOf","charCodeAt","startNodeParent","parentOfCurrentOLUL","nearBlockNode","blockParentNode","nodeCutter","GetSpliceNode","insertTag","enterAction","notify","setCursorPoint","style","listStyleType","firstElementChild","nextSibling","removeProperty","backspaceList","removeAttribute","parentList","children","lastChild","insertBefore","firstChild","removeList","firstListBackSpace","childElementCount","fullContent","forEach","commonAncestorContainer","userAgent","editableElement","collapsed","deleteContents","li","parentNode","removeChild","ol","ul","commonLIParent","querySelector","currentLIElem","keyCode","listElements","appendChild","_e","previousSibling","currentElem","classList","add","which","action","commonAncestor","startEle","endEle","nodeType","lastElementChild","areAllListItemsSelected","blockNodes","IGNORE_BLOCK_TAGS","toLocaleLowerCase","setMarker","nodes","isNested","push","stopPropagation","currentAction","getAction","shiftKey","revertList","revertClean","nestedList","cleanNode","focus","preventScroll","saveMarker","restore","requestType","editorMode","elements","key","element","collectionNodes","listNodes","j","prevSibling","noPreviousElement","firstNode","firstNodeOL","siblingListOL","siblingListLI","siblingListLIFirst","contents","h","isList","nestedElement","nestedElementLI","styles","getPreviousNode","firstNodeLI","startChildNodes","lastSelectionNode","setSelectionText","focusNode","listsNodes","setSelectionBRConfig","convertToBlockNodes","splice","applyLists","selector","item","startElem","startSelection","endElem","endSelection","type","isReverse","isRevert","removeEmptyListElements","checkLists","marginLeftAttribute","marginLeft","listStyle","listImage","toLowerCase","elemAtt","contains","getAttribute","listEle","document","openTag","closeTag","newTag","replaceHTML","createTagString","collectionString","DEFAULT_TAG","outerHTML","replaceWith","currentElemAtt","spansToRemove","span","fragment","createDocumentFragment","replaceChild","listElem","nodesTemp","node","hasAttribute","liParents","c","toFindtopOlUl","containsListElements","openTagString","contentNodes","f","listOlUlElements","Element","concat","Array","from","k","findUnSelected","temp","reverse","rightIndent","indentElements","lastElement","childElements","z","childLI","y","count","x","viewNode","className","siblingList","child","classAttr","BLOCK_TAGS","join","wrapperclass","listStyleImage","wrapperTag","wrapper","wrapInner","parseHTMLFragment","wrapperSpan","br","encode","childNode","attributes_1","d","e_1","existingValue","parentValue","setAttribute","nodeInnerHtml","closeTagString","emptyUl","emptyLi","list","listItems","listItem","listItemRange","createRange","selectNodeContents","intersectsNode"],"sources":["/var/www/vue/vue-gantt-chart/node_modules/@syncfusion/ej2-richtexteditor/src/editor-manager/plugin/lists.js"],"sourcesContent":["import * as CONSTANT from './../base/constant';\nimport { createElement, detach, prepend, append, attributes, Browser } from '@syncfusion/ej2-base';\nimport { markerClassName } from './dom-node';\nimport * as EVENTS from './../../common/constant';\nimport { setStyleAttribute } from '@syncfusion/ej2-base';\nimport { isIDevice, setEditFrameFocus } from '../../common/util';\nimport { isNullOrUndefined, isNullOrUndefined as isNOU, closest } from '@syncfusion/ej2-base';\n/**\n * Lists internal component\n *\n * @hidden\n\n */\nvar Lists = /** @class */ (function () {\n    /**\n     * Constructor for creating the Lists plugin\n     *\n     * @param {EditorManager} parent - specifies the parent element\n     * @hidden\n\n     */\n    function Lists(parent) {\n        this.parent = parent;\n        this.domNode = this.parent.domNode;\n        this.addEventListener();\n    }\n    Lists.prototype.addEventListener = function () {\n        this.parent.observer.on(EVENTS.LIST_TYPE, this.applyListsHandler, this);\n        this.parent.observer.on(EVENTS.KEY_UP_HANDLER, this.onKeyUp, this);\n        this.parent.observer.on(EVENTS.KEY_DOWN_HANDLER, this.keyDownHandler, this);\n        this.parent.observer.on(EVENTS.SPACE_ACTION, this.spaceKeyAction, this);\n        this.parent.observer.on(EVENTS.INTERNAL_DESTROY, this.destroy, this);\n    };\n    Lists.prototype.removeEventListener = function () {\n        this.parent.observer.off(EVENTS.LIST_TYPE, this.applyListsHandler);\n        this.parent.observer.off(EVENTS.KEY_UP_HANDLER, this.onKeyUp);\n        this.parent.observer.off(EVENTS.KEY_DOWN_HANDLER, this.keyDownHandler);\n        this.parent.observer.off(EVENTS.SPACE_ACTION, this.spaceKeyAction);\n        this.parent.observer.off(EVENTS.INTERNAL_DESTROY, this.destroy);\n    };\n    Lists.prototype.testList = function (elem) {\n        var olListRegex = [/^[\\d]+[.]+$/,\n            /^(?=[MDCLXVI])M*(C[MD]|D?C{0,3})(X[CL]|L?X{0,3})(I[XV]|V?I{0,3})[.]$/gi,\n            /^[a-zA-Z][.]+$/];\n        var elementStart = !isNullOrUndefined(elem) ? elem.innerText.trim().split('.')[0] + '.' : null;\n        if (!isNullOrUndefined(elementStart)) {\n            for (var i = 0; i < olListRegex.length; i++) {\n                if (olListRegex[i].test(elementStart)) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n    Lists.prototype.testCurrentList = function (range) {\n        var olListStartRegex = [/^[1]+[.]+$/, /^[i]+[.]+$/, /^[a]+[.]+$/];\n        if (!isNullOrUndefined(range.startContainer.textContent.slice(0, range.startOffset))) {\n            var currentContent = range.startContainer.textContent.replace(/\\u200B/g, '').slice(0, range.startOffset).trim();\n            for (var i = 0; i < olListStartRegex.length; i++) {\n                if (olListStartRegex[i].test(currentContent) && currentContent.length === 2) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n    Lists.prototype.spaceList = function (e) {\n        var range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n        this.saveSelection = this.parent.nodeSelection.save(range, this.parent.currentDocument);\n        var startNode = this.parent.domNode.getSelectedNode(range.startContainer, range.startOffset);\n        // eslint-disable-next-line\n        var endNode = this.parent.domNode.getSelectedNode(range.endContainer, range.endOffset);\n        var preElement = startNode.previousElementSibling;\n        var nextElement = startNode.nextElementSibling;\n        var preElemULStart = !isNullOrUndefined(preElement) ?\n            preElement.innerText.trim().substring(0, 1) : null;\n        var nextElemULStart = !isNullOrUndefined(nextElement) ?\n            nextElement.innerText.trim().substring(0, 1) : null;\n        var startElementOLTest = this.testCurrentList(range);\n        var preElementOLTest = this.testList(preElement);\n        var nextElementOLTest = this.testList(nextElement);\n        if (!preElementOLTest && !nextElementOLTest && preElemULStart !== '*' && nextElemULStart !== '*') {\n            var brElement = createElement('br');\n            if (startElementOLTest) {\n                range.startContainer.textContent = range.startContainer.textContent.slice(range.startOffset, range.startContainer.textContent.length);\n                if (range.startContainer.nodeName === '#text' && range.startContainer.textContent.length === 0) {\n                    this.parent.domNode.insertAfter(brElement, range.startContainer);\n                }\n                this.applyListsHandler({ subCommand: 'OL', callBack: e.callBack });\n                e.event.preventDefault();\n            }\n            else if (range.startContainer.textContent.replace(/\\u200B/g, '').slice(0, range.startOffset).trim() === '*' ||\n                range.startContainer.textContent.replace(/\\u200B/g, '').slice(0, range.startOffset).trim() === '-') {\n                range.startContainer.textContent = range.startContainer.textContent.slice(range.startOffset, range.startContainer.textContent.length);\n                if (range.startContainer.nodeName === '#text' && range.startContainer.textContent.length === 0) {\n                    this.parent.domNode.insertAfter(brElement, range.startContainer);\n                }\n                this.applyListsHandler({ subCommand: 'UL', callBack: e.callBack });\n                e.event.preventDefault();\n            }\n        }\n    };\n    Lists.prototype.enterList = function (e) {\n        var range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n        var startNode = range.startContainer.nodeName === 'LI' ? range.startContainer :\n            range.startContainer.parentElement.closest('LI');\n        var endNode = range.endContainer.nodeName === 'LI' ? range.endContainer :\n            range.endContainer.parentElement.closest('LI');\n        // Checks for Image, Audio , Video Element inside List Element\n        var hasMediaElem = false;\n        if (!isNOU(startNode)) {\n            var videoElemList = startNode.querySelectorAll('.e-video-clickelem');\n            var embedVideoElem = videoElemList.length > 0 && videoElemList[0].childNodes[0].nodeName === 'IFRAME';\n            hasMediaElem = startNode.querySelectorAll('IMG').length > 0 || startNode.querySelectorAll('AUDIO').length > 0 || startNode.querySelectorAll('VIDEO').length > 0 || embedVideoElem;\n        }\n        if (!isNOU(startNode) && !isNOU(endNode) && startNode === endNode && startNode.tagName === 'LI' &&\n            startNode.textContent.trim() === '' && !hasMediaElem) {\n            if (startNode.innerHTML.indexOf('&nbsp;') >= 0) {\n                return;\n            }\n            if (startNode.textContent.charCodeAt(0) === 65279) {\n                startNode.textContent = '';\n            }\n            var startNodeParent = startNode.parentElement;\n            var parentOfCurrentOLUL = startNodeParent.parentElement;\n            if (isNOU(parentOfCurrentOLUL.closest('UL')) && isNOU(parentOfCurrentOLUL.closest('OL'))) {\n                if (!isNOU(startNode.nextElementSibling)) {\n                    var nearBlockNode = this.parent.domNode.blockParentNode(startNode);\n                    this.parent.nodeCutter.GetSpliceNode(range, nearBlockNode);\n                }\n                var insertTag = void 0;\n                if (e.enterAction === 'DIV') {\n                    insertTag = createElement('div');\n                    insertTag.innerHTML = '<br>';\n                }\n                else if (e.enterAction === 'P') {\n                    insertTag = createElement('p');\n                    insertTag.innerHTML = '<br>';\n                }\n                else {\n                    insertTag = createElement('br');\n                }\n                if (!isNOU(parentOfCurrentOLUL) && parentOfCurrentOLUL.nodeName === 'BLOCKQUOTE') {\n                    this.parent.observer.notify('blockquote_list_handled', {});\n                }\n                this.parent.domNode.insertAfter(insertTag, startNodeParent);\n                e.event.preventDefault();\n                this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument, insertTag, 0);\n                if (startNodeParent.textContent === '' && (startNodeParent.querySelectorAll('audio,video').length === 0)) {\n                    detach(startNodeParent);\n                }\n                else {\n                    detach(startNode);\n                }\n            }\n            // To handle the nested enter key press in the list for the first LI element\n            if (!isNOU(parentOfCurrentOLUL) && (!isNOU(parentOfCurrentOLUL.closest('UL')) || !isNOU(parentOfCurrentOLUL.closest('OL'))) &&\n                parentOfCurrentOLUL.nodeName === 'LI' && parentOfCurrentOLUL.style.listStyleType === 'none' &&\n                parentOfCurrentOLUL.textContent === '' && startNode.textContent === '' && startNode === startNodeParent.firstElementChild &&\n                isNOU(startNode.nextSibling)) {\n                detach(startNodeParent);\n                parentOfCurrentOLUL.style.removeProperty('list-style-type');\n                e.event.preventDefault();\n            }\n        }\n    };\n    Lists.prototype.backspaceList = function (e) {\n        var range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n        var startNode = this.parent.domNode.getSelectedNode(range.startContainer, range.startOffset);\n        var endNode = this.parent.domNode.getSelectedNode(range.endContainer, range.endOffset);\n        startNode = startNode.nodeName === 'BR' ? startNode.parentElement : startNode;\n        endNode = endNode.nodeName === 'BR' ? endNode.parentElement : endNode;\n        if (startNode === endNode && !isNullOrUndefined(closest(startNode, 'li')) &&\n            ((startNode.textContent.trim() === '' && startNode.textContent.charCodeAt(0) === 65279) ||\n                (startNode.textContent.length === 1 && startNode.textContent.charCodeAt(0) === 8203))) {\n            startNode.textContent = '';\n        }\n        if (startNode === endNode && startNode.tagName === 'LI' && startNode.textContent.length === 0 &&\n            isNOU(startNode.previousElementSibling)) {\n            startNode.removeAttribute('style');\n        }\n        if (startNode === endNode && startNode.textContent === '') {\n            if (startNode.parentElement.tagName === 'LI' && endNode.parentElement.tagName === 'LI') {\n                detach(startNode);\n            }\n            else if (startNode.closest('ul') || startNode.closest('ol')) {\n                var parentList = !isNOU(startNode.closest('ul')) ? startNode.closest('ul') : startNode.closest('ol');\n                if (parentList.firstElementChild === startNode && !isNOU(parentList.children[1]) &&\n                    (parentList.children[1].tagName === 'OL' || parentList.children[1].tagName === 'UL')) {\n                    if (parentList.tagName === parentList.children[1].tagName) {\n                        while (parentList.children[1].lastChild) {\n                            this.parent.domNode.insertAfter(parentList.children[1].lastChild, parentList.children[1]);\n                        }\n                        detach(parentList.children[1]);\n                    }\n                    else {\n                        parentList.parentElement.insertBefore(parentList.children[1], parentList);\n                    }\n                }\n            }\n        }\n        else if (!isNOU(startNode.firstChild) && startNode.firstChild.nodeName === 'BR' &&\n            (!isNullOrUndefined(startNode.childNodes[1]) && (startNode.childNodes[1].nodeName === 'UL' ||\n                startNode.childNodes[1].nodeName === 'OL'))) {\n            var parentList = !isNOU(startNode.closest('ul')) ? startNode.closest('ul') : startNode.closest('ol');\n            if (parentList.tagName === startNode.childNodes[1].nodeName) {\n                while (startNode.childNodes[1].lastChild) {\n                    this.parent.domNode.insertAfter(startNode.children[1].lastChild, startNode);\n                }\n                detach(startNode.childNodes[1]);\n            }\n            else {\n                parentList.parentElement.insertBefore(startNode.children[1], parentList);\n            }\n        }\n        this.removeList(range, e);\n        this.firstListBackSpace(range, e);\n    };\n    Lists.prototype.removeList = function (range, e) {\n        var startNode = this.parent.domNode.getSelectedNode(range.startContainer, range.startOffset);\n        var endNode = (!isNOU(range.endContainer.parentElement.closest('li')) && range.endContainer.parentElement.closest('li').childElementCount > 1 && range.endContainer.nodeName === '#text') ? range.endContainer : this.parent.domNode.getSelectedNode(range.endContainer, range.endOffset);\n        var parentList = (range.startContainer.nodeName === '#text') ? range.startContainer.parentElement.closest('li') : range.startContainer.closest('li');\n        var fullContent = '';\n        if (!isNOU(parentList) && !isNOU(parentList.firstChild)) {\n            parentList.childNodes.forEach(function (e) {\n                fullContent = fullContent + e.textContent;\n            });\n        }\n        startNode = startNode.nodeName === 'BR' ? startNode.parentElement : startNode;\n        endNode = endNode.nodeName === 'BR' ? endNode.parentElement : endNode;\n        startNode = startNode.nodeName !== 'LI' && !isNOU(startNode.closest('LI')) ? startNode.closest('LI') : startNode;\n        endNode = endNode.nodeName !== 'LI' && endNode.nodeName !== '#text' && !isNOU(endNode.closest('LI')) ? endNode.closest('LI') : endNode;\n        if (((range.commonAncestorContainer.nodeName === 'OL' || range.commonAncestorContainer.nodeName === 'UL' || range.commonAncestorContainer.nodeName === 'LI') &&\n            isNOU(endNode.nextElementSibling) && endNode.textContent.length === range.endOffset &&\n            isNOU(startNode.previousElementSibling) && range.startOffset === 0) ||\n            (Browser.userAgent.indexOf('Firefox') !== -1 && range.startContainer === range.endContainer && range.startContainer === this.parent.editableElement &&\n                range.startOffset === 0 && range.endOffset === 1)) {\n            if (Browser.userAgent.indexOf('Firefox') !== -1) {\n                detach(range.commonAncestorContainer.childNodes[0]);\n            }\n            else if (range.commonAncestorContainer.nodeName === 'LI') {\n                detach(range.commonAncestorContainer.parentElement);\n            }\n            else {\n                detach(range.commonAncestorContainer);\n            }\n            e.event.preventDefault();\n        }\n        else if (!isNOU(parentList) && !range.collapsed && parentList.textContent === fullContent) {\n            range.deleteContents();\n            this.parent.editableElement.querySelectorAll('li').forEach(function (li) {\n                if (!li.firstChild || li.textContent.trim() === '') {\n                    li.parentNode.removeChild(li);\n                }\n            });\n            this.parent.editableElement.querySelectorAll('ol').forEach(function (ol) {\n                if (!ol.firstChild || ol.textContent.trim() === '') {\n                    ol.parentNode.removeChild(ol);\n                }\n            });\n            this.parent.editableElement.querySelectorAll('ul').forEach(function (ul) {\n                if (!ul.firstChild || ul.textContent.trim() === '') {\n                    ul.parentNode.removeChild(ul);\n                }\n            });\n            e.event.preventDefault();\n        }\n    };\n    Lists.prototype.onKeyUp = function (e) {\n        if (!isNOU(this.commonLIParent) && !isNOU(this.commonLIParent.querySelector('.removeList'))) {\n            var currentLIElem = this.commonLIParent.querySelector('.removeList');\n            while (!isNOU(currentLIElem.firstChild)) {\n                this.parent.domNode.insertAfter(currentLIElem.firstChild, currentLIElem);\n            }\n            detach(currentLIElem);\n        }\n        if (e.event.keyCode === 13) {\n            var listElements = this.parent.editableElement.querySelectorAll('UL, OL');\n            for (var i = 0; i < listElements.length; i++) {\n                if (!isNullOrUndefined(listElements[i]) && !isNOU(listElements[i].parentElement) && !isNullOrUndefined(listElements[i].previousElementSibling) && (listElements[i].parentElement.nodeName === 'UL' || listElements[i].parentElement.nodeName === 'OL')) {\n                    listElements[i].previousElementSibling.appendChild(listElements[i]);\n                }\n            }\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    Lists.prototype.firstListBackSpace = function (range, _e) {\n        var startNode = this.parent.domNode.getSelectedNode(range.startContainer, range.startOffset);\n        if (!isNOU(startNode.closest('OL'))) {\n            this.commonLIParent = startNode.closest('OL');\n        }\n        else if (!isNOU(startNode.closest('UL'))) {\n            this.commonLIParent = startNode.closest('UL');\n        }\n        if (startNode.nodeName === 'LI' && range.startOffset === 0 && range.endOffset === 0 &&\n            isNOU(startNode.previousSibling) && !isNOU(this.commonLIParent) && isNOU(this.commonLIParent.previousSibling) &&\n            (isNOU(this.commonLIParent.parentElement.closest('OL')) && isNOU(this.commonLIParent.parentElement.closest('UL')) &&\n                isNOU(this.commonLIParent.parentElement.closest('LI')))) {\n            var currentElem = createElement('P');\n            currentElem.innerHTML = '&#8203;';\n            startNode.classList.add('removeList');\n            this.commonLIParent.parentElement.insertBefore(currentElem, this.commonLIParent);\n        }\n    };\n    Lists.prototype.keyDownHandler = function (e) {\n        if (e.event.which === 13) {\n            this.enterList(e);\n        }\n        if (e.event.which === 32) {\n            this.spaceList(e);\n        }\n        if (e.event.which === 8) {\n            this.backspaceList(e);\n        }\n        if ((e.event.which === 46 && e.event.action === 'delete')) {\n            var range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n            var commonAncestor = range.commonAncestorContainer;\n            var startEle = range.startContainer;\n            var endEle = range.endContainer;\n            var startNode = startEle.nodeType === 3 ? this.domNode.blockParentNode(startEle) : startEle;\n            var endNode = endEle.nodeType === 3 ? this.domNode.blockParentNode(endEle) : endEle;\n            if ((commonAncestor.nodeName === 'UL' || commonAncestor.nodeName === 'OL') && startNode !== endNode\n                && (!isNullOrUndefined(closest(startNode, 'ul')) || !isNullOrUndefined(closest(startNode, 'ol')))\n                && (!isNullOrUndefined(closest(endNode, 'ul')) || !isNullOrUndefined(closest(endNode, 'ol')))\n                && ((commonAncestor.lastElementChild === closest(endNode, 'li') && commonAncestor.lastChild !== endNode)) && !range.collapsed) {\n                if (this.areAllListItemsSelected(commonAncestor, range)) {\n                    detach(commonAncestor);\n                }\n            }\n            this.removeList(range, e);\n        }\n        if (e.event.which === 9) {\n            var range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n            if (!(e.event.action && e.event.action === 'indent')) {\n                this.saveSelection = this.parent.nodeSelection.save(range, this.parent.currentDocument);\n            }\n            var blockNodes = void 0;\n            var startOffset = range.startOffset;\n            var endOffset = range.endOffset;\n            var startNode = this.parent.domNode.getSelectedNode(range.startContainer, range.startOffset);\n            var endNode = this.parent.domNode.getSelectedNode(range.endContainer, range.endOffset);\n            if ((startNode === endNode && (startNode.nodeName === 'BR' || startNode.nodeName === '#text') &&\n                CONSTANT.IGNORE_BLOCK_TAGS.indexOf(startNode.parentNode.tagName.toLocaleLowerCase()) >= 0)) {\n                return;\n            }\n            else {\n                if (!(e.event.action && e.event.action === 'indent')) {\n                    this.domNode.setMarker(this.saveSelection);\n                }\n                blockNodes = this.domNode.blockNodes();\n            }\n            var nodes = [];\n            var isNested = true;\n            for (var i = 0; i < blockNodes.length; i++) {\n                if (blockNodes[i].parentNode.tagName === 'LI') {\n                    nodes.push(blockNodes[i].parentNode);\n                }\n                else if (blockNodes[i].tagName === 'LI' && blockNodes[i].childNodes[0].tagName !== 'P' &&\n                    (blockNodes[i].childNodes[0].tagName !== 'OL' &&\n                        blockNodes[i].childNodes[0].tagName !== 'UL')) {\n                    nodes.push(blockNodes[i]);\n                }\n            }\n            if (nodes.length > 1 || nodes.length === 1) {\n                e.event.preventDefault();\n                e.event.stopPropagation();\n                this.currentAction = this.getAction(nodes[0]);\n                if (e.event.shiftKey) {\n                    this.revertList(nodes, e);\n                    this.revertClean();\n                }\n                else {\n                    isNested = this.nestedList(nodes);\n                }\n                if (isNested) {\n                    this.cleanNode();\n                    this.parent.editableElement.focus({ preventScroll: true });\n                }\n                if (!(e.event.action && e.event.action === 'indent')) {\n                    this.saveSelection = this.domNode.saveMarker(this.saveSelection);\n                    this.saveSelection.restore();\n                    if (e.callBack) {\n                        e.callBack({\n                            requestType: this.currentAction,\n                            editorMode: 'HTML',\n                            range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n                            elements: this.parent.domNode.blockNodes(),\n                            event: e.event\n                        });\n                    }\n                }\n            }\n            else {\n                if (!(e.event.action && e.event.action === 'indent')) {\n                    if (e.event && e.event.shiftKey && e.event.key === 'Tab') {\n                        e.event.action = 'tab';\n                    }\n                    this.saveSelection = this.domNode.saveMarker(this.saveSelection);\n                    this.saveSelection.restore();\n                }\n            }\n        }\n        else {\n            switch (e.event.action) {\n                case 'ordered-list':\n                    this.applyListsHandler({ subCommand: 'OL', callBack: e.callBack });\n                    e.event.preventDefault();\n                    break;\n                case 'unordered-list':\n                    this.applyListsHandler({ subCommand: 'UL', callBack: e.callBack });\n                    e.event.preventDefault();\n                    break;\n            }\n        }\n    };\n    Lists.prototype.spaceKeyAction = function (e) {\n        if (e.event.which === 32) {\n            this.spaceList(e);\n        }\n    };\n    Lists.prototype.getAction = function (element) {\n        var parentNode = element.parentNode;\n        return (parentNode.nodeName === 'OL' ? 'OL' : 'UL');\n    };\n    Lists.prototype.revertClean = function () {\n        var collectionNodes = this.parent.editableElement.querySelectorAll('ul, ol');\n        for (var i = 0; i < collectionNodes.length; i++) {\n            var listNodes = collectionNodes[i].querySelectorAll('ul, ol');\n            if (listNodes.length > 0) {\n                for (var j = 0; j < listNodes.length; j++) {\n                    var prevSibling = listNodes[j].previousSibling;\n                    if (prevSibling && prevSibling.tagName === 'LI') {\n                        prevSibling.appendChild(listNodes[j]);\n                    }\n                }\n            }\n        }\n    };\n    Lists.prototype.noPreviousElement = function (elements) {\n        var firstNode;\n        var firstNodeOL;\n        var siblingListOL = elements.querySelectorAll('ol, ul');\n        var siblingListLI = elements\n            .querySelectorAll('li');\n        var siblingListLIFirst = this.domNode.contents(siblingListLI[0])[0];\n        if (siblingListLI.length > 0 && (siblingListLIFirst.nodeName === 'OL' || siblingListLIFirst.nodeName === 'UL')) {\n            firstNode = siblingListLI[0];\n        }\n        else {\n            firstNodeOL = siblingListOL[0];\n        }\n        if (firstNode) {\n            for (var h = this.domNode.contents(elements)[0]; h && !this.domNode.isList(h); null) {\n                var nextSibling = h.nextSibling;\n                prepend([h], firstNode);\n                setStyleAttribute(elements, { 'list-style-type': 'none' });\n                setStyleAttribute(firstNode, { 'list-style-type': '' });\n                h = nextSibling;\n            }\n        }\n        else if (firstNodeOL) {\n            var nestedElement = createElement('li');\n            prepend([nestedElement], firstNodeOL);\n            for (var h = this.domNode.contents(elements)[0]; h && !this.domNode.isList(h); null) {\n                var nextSibling = h.nextSibling;\n                nestedElement.appendChild(h);\n                h = nextSibling;\n            }\n            prepend([firstNodeOL], elements.parentNode);\n            detach(elements);\n            var nestedElementLI = createElement('li', { styles: 'list-style-type: none;' });\n            prepend([nestedElementLI], firstNodeOL.parentNode);\n            append([firstNodeOL], nestedElementLI);\n        }\n        else {\n            var nestedElementLI = createElement('li', { styles: 'list-style-type: none;' });\n            prepend([nestedElementLI], elements.parentNode);\n            var nestedElement = createElement(elements.parentNode.tagName);\n            prepend([nestedElement], nestedElementLI);\n            append([elements], nestedElement);\n        }\n    };\n    Lists.prototype.nestedList = function (elements) {\n        var isNested = false;\n        for (var i = 0; i < elements.length; i++) {\n            var prevSibling = this.domNode.getPreviousNode(elements[i]);\n            if (prevSibling) {\n                isNested = true;\n                var firstNode = void 0;\n                var firstNodeLI = void 0;\n                var siblingListOL = elements[i].querySelectorAll('ol, ul');\n                var siblingListLI = elements[i]\n                    .querySelectorAll('li');\n                var siblingListLIFirst = this.domNode.contents(siblingListLI[0])[0];\n                if (siblingListLI.length > 0 && (siblingListLIFirst.nodeName === 'OL' || siblingListLIFirst.nodeName === 'UL')) {\n                    firstNodeLI = siblingListLI[0];\n                }\n                else {\n                    firstNode = siblingListOL[0];\n                }\n                if (firstNode) {\n                    var nestedElement = createElement('li');\n                    prepend([nestedElement], firstNode);\n                    for (var h = this.domNode.contents(elements[i])[0]; h && !this.domNode.isList(h); null) {\n                        var nextSibling = h.nextSibling;\n                        nestedElement.appendChild(h);\n                        h = nextSibling;\n                    }\n                    append([firstNode], prevSibling);\n                    detach(elements[i]);\n                }\n                else if (firstNodeLI) {\n                    if (prevSibling.tagName === 'LI') {\n                        for (var h = this.domNode.contents(elements[i])[0]; h && !this.domNode.isList(h); null) {\n                            var nextSibling = h.nextSibling;\n                            prepend([h], firstNodeLI);\n                            setStyleAttribute(elements[i], { 'list-style-type': 'none' });\n                            setStyleAttribute(firstNodeLI, { 'list-style-type': '' });\n                            h = nextSibling;\n                        }\n                        append([firstNodeLI.parentNode], prevSibling);\n                        detach(elements[i]);\n                    }\n                }\n                else {\n                    if (prevSibling.tagName === 'LI') {\n                        var nestedElement = createElement(elements[i].parentNode.tagName);\n                        nestedElement.style.listStyleType =\n                            elements[i].parentNode.style.listStyleType;\n                        append([nestedElement], prevSibling);\n                        append([elements[i]], nestedElement);\n                    }\n                    else if (prevSibling.tagName === 'OL' || prevSibling.tagName === 'UL') {\n                        append([elements[i]], prevSibling);\n                    }\n                }\n            }\n            else {\n                var element = elements[i];\n                isNested = true;\n                this.noPreviousElement(element);\n            }\n        }\n        return isNested;\n    };\n    Lists.prototype.applyListsHandler = function (e) {\n        var range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n        if (Browser.userAgent.indexOf('Firefox') !== -1 && range.startContainer === range.endContainer && range.startContainer === this.parent.editableElement) {\n            var startChildNodes = range.startContainer.childNodes;\n            var startNode = ((startChildNodes[(range.startOffset > 0) ? (range.startOffset - 1) :\n                range.startOffset]) || range.startContainer);\n            var endNode = (range.endContainer.childNodes[(range.endOffset > 0) ? (range.endOffset - 1) :\n                range.endOffset] || range.endContainer);\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            var lastSelectionNode = endNode.lastChild.nodeName === 'BR' ? (isNOU(endNode.lastChild.previousSibling) ? endNode\n                : endNode.lastChild.previousSibling) : endNode.lastChild;\n            while (!isNOU(lastSelectionNode) && lastSelectionNode.nodeName !== '#text' && lastSelectionNode.nodeName !== 'IMG' &&\n                lastSelectionNode.nodeName !== 'BR' && lastSelectionNode.nodeName !== 'HR') {\n                lastSelectionNode = lastSelectionNode.lastChild;\n            }\n            this.parent.nodeSelection.setSelectionText(this.parent.currentDocument, startNode, lastSelectionNode, 0, lastSelectionNode.textContent.length);\n            range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n        }\n        if (range.startContainer === range.endContainer && range.startContainer === this.parent.editableElement &&\n            range.startOffset === range.endOffset && range.startOffset === 0 &&\n            this.parent.editableElement.textContent.length === 0 && (this.parent.editableElement.childNodes[0].nodeName !== 'TABLE' &&\n            this.parent.editableElement.childNodes[0].nodeName !== 'IMG')) {\n            var focusNode = range.startContainer.childNodes[0];\n            this.parent.nodeSelection.setSelectionText(this.parent.currentDocument, focusNode, focusNode, 0, 0);\n            range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n        }\n        this.saveSelection = this.parent.nodeSelection.save(range, this.parent.currentDocument);\n        this.currentAction = e.subCommand;\n        this.currentAction = e.subCommand = this.currentAction === 'NumberFormatList' ? 'OL' : this.currentAction === 'BulletFormatList' ? 'UL' : this.currentAction;\n        this.domNode.setMarker(this.saveSelection);\n        var listsNodes = this.domNode.blockNodes(true);\n        if (e.enterAction === 'BR') {\n            this.setSelectionBRConfig();\n            this.parent.domNode.convertToBlockNodes(this.parent.domNode.blockNodes(), true);\n            this.setSelectionBRConfig();\n            listsNodes = this.parent.domNode.blockNodes();\n        }\n        for (var i = 0; i < listsNodes.length; i++) {\n            if (listsNodes[i].tagName === 'TABLE' && !range.collapsed) {\n                listsNodes.splice(i, 1);\n            }\n            if (listsNodes.length > 0 && listsNodes[i].tagName !== 'LI'\n                && 'LI' === listsNodes[i].parentNode.tagName) {\n                listsNodes[i] = listsNodes[i].parentNode;\n            }\n        }\n        this.applyLists(listsNodes, this.currentAction, e.selector, e.item, e);\n        if (e.callBack) {\n            e.callBack({\n                requestType: this.currentAction,\n                event: e.event,\n                editorMode: 'HTML',\n                range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n                elements: this.parent.domNode.blockNodes()\n            });\n        }\n    };\n    Lists.prototype.setSelectionBRConfig = function () {\n        var startElem = this.parent.editableElement.querySelector('.' + markerClassName.startSelection);\n        var endElem = this.parent.editableElement.querySelector('.' + markerClassName.endSelection);\n        if (isNOU(endElem)) {\n            this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument, startElem, 0);\n        }\n        else {\n            this.parent.nodeSelection.setSelectionText(this.parent.currentDocument, startElem, endElem, 0, 0);\n        }\n    };\n    Lists.prototype.applyLists = function (elements, type, selector, item, e) {\n        var isReverse = true;\n        if (this.isRevert(elements, type, item) && isNOU(item)) {\n            this.revertList(elements, e);\n            this.removeEmptyListElements();\n        }\n        else {\n            this.checkLists(elements, type, item);\n            var marginLeftAttribute = '';\n            if (elements[0].style.marginLeft !== '') {\n                marginLeftAttribute = ' style = \"margin-left: ' + elements[0].style.marginLeft + ';\"';\n            }\n            for (var i = 0; i < elements.length; i++) {\n                if (!isNOU(item) && !isNOU(item.listStyle)) {\n                    if (item.listStyle === 'listImage') {\n                        setStyleAttribute(elements[i], { 'list-style-image': item.listImage });\n                    }\n                    else {\n                        setStyleAttribute(elements[i], { 'list-style-image': 'none' });\n                        setStyleAttribute(elements[i], { 'list-style-type': item.listStyle.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase() });\n                    }\n                }\n                elements[i].style.removeProperty('margin-left');\n                var elemAtt = elements[i].tagName === 'IMG' || elements[i].classList.contains('e-editor-select-start') ? '' : this.domNode.attributes(elements[i]);\n                if (elements[i].getAttribute('contenteditable') === 'true'\n                    && elements[i].childNodes.length === 1 && elements[i].childNodes[0].nodeName === 'TABLE') {\n                    var listEle = document.createElement(type);\n                    listEle.innerHTML = '<li><br/></li>';\n                    elements[i].appendChild(listEle);\n                }\n                else if ('LI' !== elements[i].tagName && isNOU(item) &&\n                    elements[i].nodeName === 'BLOCKQUOTE') {\n                    isReverse = false;\n                    var openTag = '<' + type + marginLeftAttribute + '>';\n                    var closeTag = '</' + type + '>';\n                    var newTag = 'li' + elemAtt;\n                    var replaceHTML = elements[i].innerHTML;\n                    var innerHTML = this.domNode.createTagString(newTag, null, replaceHTML);\n                    var collectionString = openTag + innerHTML + closeTag;\n                    elements[i].innerHTML = collectionString;\n                }\n                else if ('LI' !== elements[i].tagName && isNOU(item)) {\n                    isReverse = false;\n                    var openTag = '<' + type + marginLeftAttribute + '>';\n                    var closeTag = '</' + type + '>';\n                    var newTag = 'li' + elemAtt;\n                    var replaceHTML = (elements[i].tagName.toLowerCase() === CONSTANT.DEFAULT_TAG ?\n                        elements[i].innerHTML : elements[i].outerHTML);\n                    var innerHTML = this.domNode.createTagString(newTag, null, replaceHTML);\n                    var collectionString = openTag + innerHTML + closeTag;\n                    this.domNode.replaceWith(elements[i], collectionString);\n                }\n                else if (!isNOU(item) && 'LI' !== elements[i].tagName) {\n                    // eslint-disable-next-line\n                    isReverse = false;\n                    var currentElemAtt = elements[i].tagName === 'IMG' ? '' : this.domNode.attributes(elements[i]);\n                    var openTag = '<' + type + currentElemAtt + '>';\n                    var closeTag = '</' + type + '>';\n                    var newTag = 'li';\n                    var replaceHTML = (elements[i].tagName.toLowerCase() === CONSTANT.DEFAULT_TAG ?\n                        elements[i].innerHTML : elements[i].outerHTML);\n                    var innerHTML = this.domNode.createTagString(newTag, null, replaceHTML);\n                    var collectionString = openTag + innerHTML + closeTag;\n                    this.domNode.replaceWith(elements[i], collectionString);\n                }\n            }\n        }\n        this.cleanNode();\n        if (e.enterAction === 'BR') {\n            var spansToRemove = document.querySelectorAll('span#removeSpan');\n            spansToRemove.forEach(function (span) {\n                var fragment = document.createDocumentFragment();\n                while (span.firstChild) {\n                    fragment.appendChild(span.firstChild);\n                }\n                span.parentNode.replaceChild(fragment, span);\n            });\n        }\n        this.parent.editableElement.focus({ preventScroll: true });\n        if (isIDevice()) {\n            setEditFrameFocus(this.parent.editableElement, selector);\n        }\n        this.saveSelection = this.domNode.saveMarker(this.saveSelection);\n        this.saveSelection.restore();\n    };\n    Lists.prototype.removeEmptyListElements = function () {\n        var listElem = this.parent.editableElement.querySelectorAll('ol, ul');\n        for (var i = 0; i < listElem.length; i++) {\n            if (listElem[i].textContent.trim() === '') {\n                detach(listElem[i]);\n            }\n        }\n    };\n    Lists.prototype.isRevert = function (nodes, tagName, item) {\n        var isRevert = true;\n        for (var i = 0; i < nodes.length; i++) {\n            if (nodes[i].tagName !== 'LI') {\n                return false;\n            }\n            if (nodes[i].parentNode.tagName !== tagName ||\n                isNOU(item) && nodes[i].parentNode.style.listStyleType !== '') {\n                isRevert = false;\n            }\n            if (nodes[i].parentNode.tagName === tagName && nodes[i].parentNode.style.listStyleType !== '') {\n                isRevert = true;\n            }\n        }\n        return isRevert;\n    };\n    Lists.prototype.checkLists = function (nodes, tagName, item) {\n        var nodesTemp = [];\n        for (var i = 0; i < nodes.length; i++) {\n            var node = nodes[i].parentNode;\n            if (!isNOU(item) && 'LI' === nodes[i].tagName && !isNOU(item.listStyle)) {\n                if (item.listStyle === 'listImage') {\n                    setStyleAttribute(node, { 'list-style-image': item.listImage });\n                }\n                else {\n                    setStyleAttribute(node, { 'list-style-image': 'none' });\n                    setStyleAttribute(node, { 'list-style-type': item.listStyle.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase() });\n                }\n            }\n            if ((nodes[i].tagName === 'LI' && node.tagName !== tagName && nodesTemp.indexOf(node) < 0) ||\n                (nodes[i].tagName === 'LI' && node.tagName === tagName && nodesTemp.indexOf(node) < 0 && item !== null)) {\n                nodesTemp.push(node);\n            }\n            if (isNOU(item) && (node.tagName === tagName ||\n                ((node.tagName === 'UL' || node.tagName === 'OL') && node.hasAttribute('style')))) {\n                if (node.hasAttribute('style')) {\n                    node.removeAttribute('style');\n                }\n            }\n        }\n        for (var j = nodesTemp.length - 1; j >= 0; j--) {\n            var h = nodesTemp[j];\n            var replace = '<' + tagName.toLowerCase() + ' '\n                + this.domNode.attributes(h) + '>' + h.innerHTML + '</' + tagName.toLowerCase() + '>';\n            this.domNode.replaceWith(nodesTemp[j], replace);\n        }\n    };\n    Lists.prototype.cleanNode = function () {\n        var liParents = this.parent.editableElement.querySelectorAll('ol + ol, ul + ul');\n        var listStyleType;\n        var firstNodeOL;\n        for (var c = 0; c < liParents.length; c++) {\n            var node = liParents[c];\n            var toFindtopOlUl = true;\n            var containsListElements = node;\n            while (containsListElements.parentElement) {\n                if (containsListElements.parentElement && containsListElements.parentElement.tagName !== 'LI' && containsListElements.parentElement.tagName !== 'OL' && containsListElements.parentElement.tagName !== 'UL') {\n                    break;\n                }\n                containsListElements = containsListElements.parentElement;\n            }\n            if (toFindtopOlUl && (liParents[c].parentElement.parentElement.nodeName === 'OL' || liParents[c].parentElement.parentElement.nodeName === 'UL')) {\n                toFindtopOlUl = false;\n                var preElement = liParents[c].parentElement.parentElement;\n                listStyleType = preElement.style.listStyleType;\n                firstNodeOL = node.previousElementSibling;\n            }\n            if (this.domNode.isList(node.previousElementSibling) &&\n                this.domNode.openTagString(node) === this.domNode.openTagString(node.previousElementSibling)) {\n                var contentNodes = this.domNode.contents(node);\n                for (var f = 0; f < contentNodes.length; f++) {\n                    node.previousElementSibling.appendChild(contentNodes[f]);\n                }\n                node.parentNode.removeChild(node);\n            }\n            else if (!isNOU(node.getAttribute('level'))) {\n                if (node.tagName === node.previousElementSibling.tagName) {\n                    node.previousElementSibling.lastChild.append(node);\n                }\n            }\n            else if (this.domNode.isList(node.previousElementSibling) && containsListElements.contains(node.previousElementSibling) && ((node.tagName === 'OL' || node.tagName === 'UL') && (node.previousElementSibling.nodeName === 'OL' || node.previousElementSibling.nodeName === 'UL'))) {\n                var contentNodes = this.domNode.contents(node);\n                for (var f = 0; f < contentNodes.length; f++) {\n                    node.previousElementSibling.appendChild(contentNodes[f]);\n                }\n                node.parentNode.removeChild(node);\n            }\n        }\n        if (firstNodeOL) {\n            firstNodeOL.style.listStyleType = listStyleType;\n            var range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n            var listOlUlElements = [];\n            if (range.commonAncestorContainer.nodeName === 'UL' || range.commonAncestorContainer.nodeName === 'OL') {\n                if (range.commonAncestorContainer instanceof Element) {\n                    listOlUlElements.push(range.commonAncestorContainer);\n                }\n                listOlUlElements = listOlUlElements.concat(Array.from(range.commonAncestorContainer.querySelectorAll('ol, ul')));\n            }\n            else {\n                listOlUlElements = Array.from(range.commonAncestorContainer.querySelectorAll('ol, ul'));\n            }\n            for (var k = 0; k < listOlUlElements.length; k++) {\n                var listStyle = void 0;\n                var listElements = listOlUlElements[k];\n                while (listElements) {\n                    if (listElements.nodeName === 'OL' || listElements.nodeName === 'OL') {\n                        if (listElements.style.listStyleType !== '' && listElements.style.listStyleType !== 'none' && listElements.nodeName !== 'LI') {\n                            listStyle = listElements.style.listStyleType;\n                        }\n                        else if (!isNOU(listStyle) && (listElements.style.listStyleType === '' || listElements.style.listStyleType === 'none') &&\n                            listElements.nodeName !== 'LI' && (listElements.nodeName === 'UL' || listElements.nodeName === 'OL')) {\n                            listElements.style.listStyleType = listStyle;\n                        }\n                    }\n                    listElements = listElements.querySelector('UL,OL');\n                }\n            }\n        }\n    };\n    Lists.prototype.findUnSelected = function (temp, elements) {\n        temp = temp.slice().reverse();\n        if (temp.length > 0) {\n            var rightIndent = [];\n            var indentElements = [];\n            var lastElement = elements[elements.length - 1];\n            var lastElementChild = [];\n            var childElements = [];\n            lastElementChild = (lastElement.childNodes);\n            for (var z = 0; z < lastElementChild.length; z++) {\n                if (lastElementChild[z].tagName === 'OL' || lastElementChild[z].tagName === 'UL') {\n                    var childLI = lastElementChild[z]\n                        .querySelectorAll('li');\n                    if (childLI.length > 0) {\n                        for (var y = 0; y < childLI.length; y++) {\n                            childElements.push(childLI[y]);\n                        }\n                    }\n                }\n            }\n            for (var i = 0; i < childElements.length; i++) {\n                var count = 0;\n                for (var j = 0; j < temp.length; j++) {\n                    if (!childElements[i].contains((temp[j]))) {\n                        count = count + 1;\n                    }\n                }\n                if (count === temp.length) {\n                    indentElements.push(childElements[i]);\n                }\n            }\n            if (indentElements.length > 0) {\n                for (var x = 0; x < indentElements.length; x++) {\n                    if (this.domNode.contents(indentElements[x])[0].nodeName !== 'OL' &&\n                        this.domNode.contents(indentElements[x])[0].nodeName !== 'UL') {\n                        rightIndent.push(indentElements[x]);\n                    }\n                }\n            }\n            if (rightIndent.length > 0) {\n                this.nestedList(rightIndent);\n            }\n        }\n    };\n    Lists.prototype.revertList = function (elements, e) {\n        var temp = [];\n        for (var i = elements.length - 1; i >= 0; i--) {\n            for (var j = i - 1; j >= 0; j--) {\n                if (elements[j].contains((elements[i])) || elements[j] === elements[i]) {\n                    temp.push(elements[i]);\n                    elements.splice(i, 1);\n                    break;\n                }\n            }\n        }\n        this.findUnSelected(temp, elements);\n        var viewNode = [];\n        for (var i = 0; i < elements.length; i++) {\n            var element = elements[i];\n            if (this.domNode.contents(element)[0].nodeType === 3 && this.domNode.contents(element)[0].textContent.trim().length === 0) {\n                detach(this.domNode.contents(element)[0]);\n            }\n            var parentNode = elements[i].parentNode;\n            var className = element.getAttribute('class');\n            if (temp.length === 0) {\n                var siblingList = elements[i].querySelectorAll('ul, ol');\n                var firstNode = siblingList[0];\n                if (firstNode) {\n                    var child = firstNode\n                        .querySelectorAll('li');\n                    if (child) {\n                        var nestedElement = createElement(firstNode.tagName);\n                        append([nestedElement], firstNode.parentNode);\n                        var nestedElementLI = createElement('li', { styles: 'list-style-type: none;' });\n                        append([nestedElementLI], nestedElement);\n                        append([firstNode], nestedElementLI);\n                    }\n                }\n            }\n            if (element.parentNode.insertBefore(this.closeTag(parentNode.tagName), element),\n                'LI' === parentNode.parentNode.tagName || 'OL' === parentNode.parentNode.tagName ||\n                    'UL' === parentNode.parentNode.tagName) {\n                element.parentNode.insertBefore(this.closeTag('LI'), element);\n            }\n            else {\n                var classAttr = '';\n                if (className) {\n                    // eslint-disable-next-line\n                    classAttr += ' class=\"' + className + '\"';\n                }\n                if (CONSTANT.DEFAULT_TAG && 0 === element.querySelectorAll(CONSTANT.BLOCK_TAGS.join(', ')).length) {\n                    var wrapperclass = isNullOrUndefined(className) ? ' class=\"e-rte-wrap-inner\"' :\n                        ' class=\"' + className + ' e-rte-wrap-inner\"';\n                    var parentElement = parentNode;\n                    if (elements.length === parentElement.querySelectorAll('li').length) {\n                        if (!isNOU(parentElement.style.listStyleType)) {\n                            parentNode.style.removeProperty('list-style-type');\n                        }\n                        if (!isNOU(parentElement.style.listStyleImage)) {\n                            parentNode.style.removeProperty('list-style-image');\n                        }\n                        if (parentElement.style.length === 0) {\n                            parentNode.removeAttribute('style');\n                        }\n                    }\n                    var wrapperTag = isNullOrUndefined(e.enterAction) ? CONSTANT.DEFAULT_TAG : e.enterAction;\n                    var wrapper = '<' + wrapperTag + wrapperclass + this.domNode.attributes(element) + '></' + wrapperTag + '>';\n                    if (e.enterAction !== 'BR') {\n                        this.domNode.wrapInner(element, this.domNode.parseHTMLFragment(wrapper));\n                    }\n                    else {\n                        var wrapperSpan = '<span class=e-rte-wrap-inner id=removeSpan></span>';\n                        var br = document.createElement('br');\n                        this.domNode.wrapInner(element, this.domNode.parseHTMLFragment(wrapperSpan));\n                        element.appendChild(br);\n                    }\n                }\n                else if (this.domNode.contents(element)[0].nodeType === 3) {\n                    var replace = this.domNode.createTagString(CONSTANT.DEFAULT_TAG, parentNode, this.parent.domNode.encode(this.domNode.contents(element)[0].textContent));\n                    this.domNode.replaceWith(this.domNode.contents(element)[0], replace);\n                }\n                else if (this.domNode.contents(element)[0].classList.contains(markerClassName.startSelection) ||\n                    this.domNode.contents(element)[0].classList.contains(markerClassName.endSelection)) {\n                    var replace = this.domNode.createTagString(CONSTANT.DEFAULT_TAG, parentNode, this.domNode.contents(element)[0].outerHTML);\n                    this.domNode.replaceWith(this.domNode.contents(element)[0], replace);\n                }\n                else {\n                    var childNode = element.firstChild;\n                    if (childNode) {\n                        var attributes_1 = element.parentElement.attributes;\n                        if (attributes_1.length > 0) {\n                            for (var d = 0; d < attributes_1.length; d++) {\n                                var e_1 = attributes_1[d];\n                                var existingValue = childNode.getAttribute(e_1.nodeName);\n                                var parentValue = (element.parentElement).getAttribute(e_1.nodeName);\n                                childNode.setAttribute(e_1.nodeName, existingValue ? parentValue + ' ' + existingValue : parentValue);\n                            }\n                        }\n                    }\n                    className = childNode.getAttribute('class');\n                    if (className && childNode.getAttribute('class')) {\n                        attributes(childNode, { 'class': className + ' ' + childNode.getAttribute('class') });\n                    }\n                }\n                append([this.openTag('LI')], element);\n                prepend([this.closeTag('LI')], element);\n            }\n            this.domNode.insertAfter(this.openTag(parentNode.tagName), element);\n            if (parentNode.parentNode.tagName === 'LI') {\n                parentNode = parentNode.parentNode.parentNode;\n            }\n            if (viewNode.indexOf(parentNode) < 0) {\n                viewNode.push(parentNode);\n            }\n        }\n        for (var i = 0; i < viewNode.length; i++) {\n            var node = viewNode[i];\n            var nodeInnerHtml = node.innerHTML;\n            var closeTag = /<span class=\"e-rte-list-close-([a-z]*)\"><\\/span>/g;\n            var openTag = /<span class=\"e-rte-list-open-([a-z]*)\"><\\/span>/g;\n            nodeInnerHtml = nodeInnerHtml.replace(closeTag, '</$1>');\n            nodeInnerHtml = nodeInnerHtml.replace(openTag, '<$1 ' + this.domNode.attributes(node) + '>');\n            this.domNode.replaceWith(node, this.domNode.openTagString(node) + nodeInnerHtml.trim() + this.domNode.closeTagString(node));\n        }\n        var emptyUl = this.parent.editableElement.querySelectorAll('ul:empty, ol:empty');\n        for (var i = 0; i < emptyUl.length; i++) {\n            detach(emptyUl[i]);\n        }\n        var emptyLi = this.parent.editableElement.querySelectorAll('li:empty');\n        for (var i = 0; i < emptyLi.length; i++) {\n            detach(emptyLi[i]);\n        }\n    };\n    Lists.prototype.openTag = function (type) {\n        return this.domNode.parseHTMLFragment('<span class=\"e-rte-list-open-' + type.toLowerCase() + '\"></span>');\n    };\n    Lists.prototype.closeTag = function (type) {\n        return this.domNode.parseHTMLFragment('<span class=\"e-rte-list-close-' + type.toLowerCase() + '\"></span>');\n    };\n    Lists.prototype.destroy = function () {\n        this.removeEventListener();\n        if (this.domNode) {\n            this.domNode = null;\n        }\n    };\n    Lists.prototype.areAllListItemsSelected = function (list, range) {\n        var listItems = list.querySelectorAll('li');\n        for (var i = 0; i < listItems.length; i++) {\n            var listItem = listItems[i];\n            var listItemRange = this.parent.currentDocument.createRange();\n            listItemRange.selectNodeContents(listItem);\n            if (!range.intersectsNode(listItem)) {\n                return false;\n            }\n        }\n        return true;\n    };\n    return Lists;\n}());\nexport { Lists };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}