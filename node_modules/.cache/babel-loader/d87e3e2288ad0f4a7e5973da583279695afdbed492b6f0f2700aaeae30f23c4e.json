{"ast":null,"code":"import \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport * as events from '../base/constant';\nimport { Uploader } from '@syncfusion/ej2-inputs';\n/**\n * ImportExport module called when import and export content in RichTextEditor\n */\nvar ImportExport = /** @class */function () {\n  function ImportExport(parent) {\n    this.parent = parent;\n    this.addEventListener();\n  }\n  ImportExport.prototype.addEventListener = function () {\n    this.parent.on(events.onImport, this.onImport, this);\n    this.parent.on(events.onExport, this.onExport, this);\n    this.parent.on(events.destroy, this.destroy, this);\n  };\n  ImportExport.prototype.onImport = function () {\n    var _this = this;\n    this.uploaderObj = new Uploader({\n      allowedExtensions: '.doc,.docx,.rtf,.dot,.dotx,.docm,.dotm',\n      asyncSettings: {\n        saveUrl: this.parent.importWord.serviceUrl\n      },\n      success: function (args) {\n        _this.parent.executeCommand('importWord', args.e.currentTarget.response, {\n          undo: true\n        });\n      }\n    });\n    this.parent.setProperties({\n      enableXhtml: true\n    }, true);\n    var uploadParentEle = this.parent.createElement('div', {\n      className: 'e-import-uploadwrap e-droparea' + this.parent.getCssClass(true)\n    });\n    var uploadEle = this.parent.createElement('input', {\n      id: this.rteID + '_upload',\n      attrs: {\n        type: 'File',\n        name: 'UploadFiles'\n      },\n      className: this.parent.getCssClass()\n    });\n    uploadParentEle.appendChild(uploadEle);\n    this.uploaderObj.appendTo(uploadEle);\n    this.uploaderObj.element.click();\n    this.uploaderObj.element.closest('.e-upload').style.display = 'none';\n  };\n  ImportExport.prototype.onExport = function (args) {\n    var _this = this;\n    var filename;\n    var serviceUrl;\n    this.parent.setProperties({\n      enableXhtml: true\n    }, true);\n    var rteHtmlData = this.parent.getHtml();\n    var html;\n    if (args.member === 'ExportWord') {\n      filename = this.parent.exportWord.fileName;\n      serviceUrl = this.parent.exportWord.serviceUrl;\n      html = \"<html><head><style>\" + this.parent.exportWord.stylesheet + \"</style></head><body>\" + rteHtmlData + \"</body></html>\";\n    } else if (args.member === 'ExportPdf') {\n      filename = this.parent.exportPdf.fileName;\n      serviceUrl = this.parent.exportPdf.serviceUrl;\n      html = \"<html><head><style>\" + this.parent.exportPdf.stylesheet + \"</style></head><body>\" + rteHtmlData + \"</body></html>\";\n    }\n    var actionBegin = {\n      requestType: args.member,\n      exportValue: html,\n      cancel: false\n    };\n    this.parent.trigger(events.actionBegin, actionBegin, function (actionBeginArgs) {\n      if (!actionBeginArgs.cancel) {\n        fetch(serviceUrl, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            html: actionBeginArgs.exportValue\n          })\n        }).then(function (response) {\n          if (!response.ok) {\n            throw new Error(\"HTTP error! Status: \" + response.status);\n          }\n          return response.blob().then(function (blob) {\n            return {\n              blob: blob,\n              filename: filename\n            };\n          });\n        }).then(function (_a) {\n          var blob = _a.blob,\n            filename = _a.filename;\n          var url = window.URL.createObjectURL(blob);\n          var a = document.createElement('a');\n          a.href = url;\n          a.download = filename;\n          document.body.appendChild(a);\n          a.click();\n          document.body.removeChild(a);\n          window.URL.revokeObjectURL(url);\n          _this.parent.trigger(events.actionComplete, {\n            requestType: args.member\n          });\n        }).catch(function (error) {\n          console.error('Fetch error:', error);\n        });\n      }\n    });\n  };\n  ImportExport.prototype.destroy = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    this.parent.off(events.onImport, this.onImport);\n    this.parent.off(events.onExport, this.onExport);\n    this.parent.off(events.destroy, this.destroy);\n    if (this.uploaderObj && !this.uploaderObj.isDestroyed) {\n      this.uploaderObj.destroy();\n      this.uploaderObj = null;\n    }\n  };\n  /**\n   * For internal use only - Get the module name.\n   *\n   * @returns {void}\n   * @hidden\n   */\n  ImportExport.prototype.getModuleName = function () {\n    return 'importExport';\n  };\n  return ImportExport;\n}();\nexport { ImportExport };","map":{"version":3,"names":["events","Uploader","ImportExport","parent","addEventListener","prototype","on","onImport","onExport","destroy","_this","uploaderObj","allowedExtensions","asyncSettings","saveUrl","importWord","serviceUrl","success","args","executeCommand","e","currentTarget","response","undo","setProperties","enableXhtml","uploadParentEle","createElement","className","getCssClass","uploadEle","id","rteID","attrs","type","name","appendChild","appendTo","element","click","closest","style","display","filename","rteHtmlData","getHtml","html","member","exportWord","fileName","stylesheet","exportPdf","actionBegin","requestType","exportValue","cancel","trigger","actionBeginArgs","fetch","method","headers","body","JSON","stringify","then","ok","Error","status","blob","_a","url","window","URL","createObjectURL","a","document","href","download","removeChild","revokeObjectURL","actionComplete","catch","error","console","isDestroyed","off","getModuleName"],"sources":["/var/www/vue/vue-gantt-chart/node_modules/@syncfusion/ej2-richtexteditor/src/rich-text-editor/actions/import-export.js"],"sourcesContent":["import * as events from '../base/constant';\nimport { Uploader } from '@syncfusion/ej2-inputs';\n/**\n * ImportExport module called when import and export content in RichTextEditor\n */\nvar ImportExport = /** @class */ (function () {\n    function ImportExport(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    ImportExport.prototype.addEventListener = function () {\n        this.parent.on(events.onImport, this.onImport, this);\n        this.parent.on(events.onExport, this.onExport, this);\n        this.parent.on(events.destroy, this.destroy, this);\n    };\n    ImportExport.prototype.onImport = function () {\n        var _this = this;\n        this.uploaderObj = new Uploader({\n            allowedExtensions: '.doc,.docx,.rtf,.dot,.dotx,.docm,.dotm',\n            asyncSettings: {\n                saveUrl: this.parent.importWord.serviceUrl\n            },\n            success: function (args) {\n                _this.parent.executeCommand('importWord', args.e.currentTarget.response, { undo: true });\n            }\n        });\n        this.parent.setProperties({ enableXhtml: true }, true);\n        var uploadParentEle = this.parent.createElement('div', { className: 'e-import-uploadwrap e-droparea' + this.parent.getCssClass(true) });\n        var uploadEle = this.parent.createElement('input', {\n            id: this.rteID + '_upload', attrs: { type: 'File', name: 'UploadFiles' }, className: this.parent.getCssClass()\n        });\n        uploadParentEle.appendChild(uploadEle);\n        this.uploaderObj.appendTo(uploadEle);\n        this.uploaderObj.element.click();\n        this.uploaderObj.element.closest('.e-upload').style.display = 'none';\n    };\n    ImportExport.prototype.onExport = function (args) {\n        var _this = this;\n        var filename;\n        var serviceUrl;\n        this.parent.setProperties({ enableXhtml: true }, true);\n        var rteHtmlData = this.parent.getHtml();\n        var html;\n        if (args.member === 'ExportWord') {\n            filename = this.parent.exportWord.fileName;\n            serviceUrl = this.parent.exportWord.serviceUrl;\n            html = \"<html><head><style>\" + this.parent.exportWord.stylesheet + \"</style></head><body>\" + rteHtmlData + \"</body></html>\";\n        }\n        else if (args.member === 'ExportPdf') {\n            filename = this.parent.exportPdf.fileName;\n            serviceUrl = this.parent.exportPdf.serviceUrl;\n            html = \"<html><head><style>\" + this.parent.exportPdf.stylesheet + \"</style></head><body>\" + rteHtmlData + \"</body></html>\";\n        }\n        var actionBegin = {\n            requestType: args.member,\n            exportValue: html,\n            cancel: false\n        };\n        this.parent.trigger(events.actionBegin, actionBegin, function (actionBeginArgs) {\n            if (!actionBeginArgs.cancel) {\n                fetch(serviceUrl, {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json'\n                    },\n                    body: JSON.stringify({ html: actionBeginArgs.exportValue })\n                })\n                    .then(function (response) {\n                    if (!response.ok) {\n                        throw new Error(\"HTTP error! Status: \" + response.status);\n                    }\n                    return response.blob().then(function (blob) { return ({ blob: blob, filename: filename }); });\n                })\n                    .then(function (_a) {\n                    var blob = _a.blob, filename = _a.filename;\n                    var url = window.URL.createObjectURL(blob);\n                    var a = document.createElement('a');\n                    a.href = url;\n                    a.download = filename;\n                    document.body.appendChild(a);\n                    a.click();\n                    document.body.removeChild(a);\n                    window.URL.revokeObjectURL(url);\n                    _this.parent.trigger(events.actionComplete, { requestType: args.member });\n                })\n                    .catch(function (error) {\n                    console.error('Fetch error:', error);\n                });\n            }\n        });\n    };\n    ImportExport.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off(events.onImport, this.onImport);\n        this.parent.off(events.onExport, this.onExport);\n        this.parent.off(events.destroy, this.destroy);\n        if (this.uploaderObj && !this.uploaderObj.isDestroyed) {\n            this.uploaderObj.destroy();\n            this.uploaderObj = null;\n        }\n    };\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @returns {void}\n     * @hidden\n     */\n    ImportExport.prototype.getModuleName = function () {\n        return 'importExport';\n    };\n    return ImportExport;\n}());\nexport { ImportExport };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}