{"ast":null,"code":"import \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.for-each.js\";\nimport { detach, getUniqueID, append, closest, selectAll, select, isNullOrUndefined as isNOU } from '@syncfusion/ej2-base';\nimport { addClass, removeClass, Browser, isNullOrUndefined, setStyleAttribute } from '@syncfusion/ej2-base';\nimport { isCollide, Tooltip } from '@syncfusion/ej2-popups';\nimport * as events from '../base/constant';\nimport * as classes from '../base/classes';\nimport { RenderType } from '../base/enum';\nimport { setToolbarStatus, updateUndoRedoStatus, isIDevice } from '../base/util';\nimport { BaseToolbar } from './base-toolbar';\nimport { DropDownButtons } from './dropdown-buttons';\nimport { ColorPickerInput } from './color-picker';\n/**\n * `Quick toolbar` module is used to handle Quick toolbar actions.\n */\nvar BaseQuickToolbar = /** @class */function () {\n  function BaseQuickToolbar(parent, locator) {\n    this.parent = parent;\n    this.locator = locator;\n    this.isRendered = false;\n    this.isDestroyed = false;\n    this.renderFactory = this.locator.getService('rendererFactory');\n    this.contentRenderer = this.renderFactory.getRenderer(RenderType.Content);\n    this.popupRenderer = this.renderFactory.getRenderer(RenderType.Popup);\n    this.dropDownButtons = new DropDownButtons(this.parent, this.locator);\n    this.colorPickerObj = new ColorPickerInput(this.parent, this.locator);\n  }\n  BaseQuickToolbar.prototype.appendPopupContent = function () {\n    this.toolbarElement = this.parent.createElement('div', {\n      className: classes.CLS_QUICK_TB\n    });\n    if (this.element.classList.contains(classes.CLS_TEXT_POP)) {\n      this.toolbarElement.classList.add(classes.CLS_TEXT_QUICK_TB);\n    }\n    this.element.appendChild(this.toolbarElement);\n  };\n  /**\n   * render method\n   *\n   * @param {IQuickToolbarOptions} args - specifies the arguments\n   * @returns {void}\n   * @hidden\n    */\n  BaseQuickToolbar.prototype.render = function (args) {\n    var className;\n    if (args.popupType === 'Image') {\n      className = classes.CLS_IMAGE_POP;\n    } else if (args.popupType === 'Inline') {\n      className = classes.CLS_INLINE_POP;\n    } else if (args.popupType === 'Text') {\n      className = classes.CLS_TEXT_POP;\n    } else {\n      className = '';\n    }\n    var popupId = getUniqueID(args.popupType + '_Quick_Popup');\n    this.stringItems = args.toolbarItems;\n    this.element = this.parent.createElement('div', {\n      id: popupId,\n      className: className + ' ' + classes.CLS_RTE_ELEMENTS\n    });\n    this.element.setAttribute('aria-owns', this.parent.getID());\n    this.appendPopupContent();\n    this.createToolbar(args.toolbarItems, args.mode, args.cssClass);\n    this.popupRenderer.renderPopup(this);\n    this.addEventListener();\n  };\n  BaseQuickToolbar.prototype.createToolbar = function (items, mode, cssClass) {\n    this.quickTBarObj = new BaseToolbar(this.parent, this.locator);\n    this.quickTBarObj.render({\n      container: 'quick',\n      target: this.toolbarElement,\n      items: items,\n      mode: mode,\n      cssClass: cssClass\n    });\n    this.quickTBarObj.toolbarObj.refresh();\n  };\n  BaseQuickToolbar.prototype.setPosition = function (e) {\n    var x;\n    var y;\n    var imgWrapper = closest(e.target, '.e-img-caption');\n    var isAligned = e.target.classList.contains('e-imginline') || e.target.classList.contains('e-imgbreak') ? false : true;\n    var target = !isNOU(imgWrapper) ? imgWrapper : e.target;\n    addClass([this.toolbarElement], [classes.CLS_RM_WHITE_SPACE]);\n    var targetOffsetTop;\n    if (!isNOU(closest(target, 'table')) && !target.classList.contains('e-multi-cells-select') && !target.classList.contains('e-rte-image')) {\n      targetOffsetTop = target.offsetTop;\n      var parentTable = closest(target, 'table');\n      while (!isNOU(parentTable)) {\n        targetOffsetTop += parentTable.offsetTop;\n        parentTable = closest(parentTable.parentElement, 'table');\n      }\n    } else {\n      targetOffsetTop = target.classList.contains('e-rte-audio') ? target.parentElement.offsetTop : target.offsetTop;\n    }\n    var parentOffsetTop = window.pageYOffset + e.parentData.top;\n    if (targetOffsetTop - e.editTop > e.popHeight) {\n      y = parentOffsetTop + e.tBarElementHeight + (targetOffsetTop - e.editTop) - e.popHeight - 5;\n    } else if (e.editTop + e.editHeight - (targetOffsetTop + target.offsetHeight) > e.popHeight) {\n      y = parentOffsetTop + e.tBarElementHeight + (targetOffsetTop - e.editTop) + target.offsetHeight + 5;\n    } else {\n      y = e.y;\n    }\n    target = isAligned ? e.target : target;\n    var targetOffsetLeft;\n    if (!isNOU(closest(target, 'table')) && !target.classList.contains('e-multi-cells-select') && !target.classList.contains('e-rte-image')) {\n      targetOffsetLeft = target.offsetLeft;\n      var parentTable = closest(target.parentElement, 'th, td');\n      while (!isNOU(parentTable)) {\n        targetOffsetLeft += parentTable.offsetLeft;\n        parentTable = closest(parentTable.parentElement, 'table');\n      }\n    } else {\n      targetOffsetLeft = target.classList.contains('e-rte-audio') ? target.parentElement.offsetLeft : target.offsetLeft;\n    }\n    if (target.offsetWidth > e.popWidth) {\n      x = target.offsetWidth / 2 - e.popWidth / 2 + e.parentData.left + targetOffsetLeft;\n    } else {\n      x = e.parentData.left + targetOffsetLeft;\n    }\n    this.popupObj.position.X = x + e.popWidth > e.parentData.right ? e.parentData.right - e.popWidth : x;\n    this.popupObj.position.Y = y >= 0 ? y : e.y + 5;\n    this.popupObj.dataBind();\n    removeClass([this.toolbarElement], [classes.CLS_RM_WHITE_SPACE]);\n  };\n  BaseQuickToolbar.prototype.checkCollision = function (e, viewPort, type) {\n    var x;\n    var y;\n    var parentTop = e.parentData.top;\n    var contentTop = e.windowY + parentTop + e.tBarElementHeight;\n    var collision = [];\n    if (viewPort === 'document') {\n      collision = isCollide(e.popup);\n    } else {\n      collision = isCollide(e.popup, e.parentElement);\n    }\n    for (var i = 0; i < collision.length; i++) {\n      switch (collision[i]) {\n        case 'top':\n          if (viewPort === 'document') {\n            y = e.windowY;\n          } else {\n            y = window.pageYOffset + parentTop + e.tBarElementHeight;\n          }\n          break;\n        case 'bottom':\n          {\n            var posY = void 0;\n            if (viewPort === 'document') {\n              if (type === 'inline' || type === 'text') {\n                posY = e.y - e.popHeight - 10;\n              } else {\n                if (e.windowHeight - (parentTop + e.tBarElementHeight) > e.popHeight) {\n                  if (contentTop - e.windowHeight > e.popHeight) {\n                    posY = contentTop + (e.windowHeight - parentTop) - e.popHeight;\n                  } else {\n                    posY = contentTop;\n                  }\n                } else {\n                  posY = e.windowY + (parentTop + e.tBarElementHeight);\n                }\n              }\n            } else {\n              if (e.target.tagName !== 'IMG') {\n                posY = e.parentData.bottom + window.pageYOffset - e.popHeight - 10;\n              } else {\n                posY = e.parentData.bottom + window.pageYOffset - e.popHeight - 5;\n              }\n            }\n            y = posY;\n            break;\n          }\n        case 'right':\n          if (type === 'inline' || type === 'text') {\n            x = window.pageXOffset + (e.windowWidth - (e.popWidth + e.bodyRightSpace + 10));\n          } else {\n            x = e.x - e.popWidth;\n          }\n          break;\n        case 'left':\n          if (type === 'inline' || type === 'text') {\n            x = 0;\n          } else {\n            x = e.parentData.left;\n          }\n          break;\n      }\n    }\n    this.popupObj.position.X = x ? x : this.popupObj.position.X;\n    this.popupObj.position.Y = y ? y : this.popupObj.position.Y;\n    this.popupObj.dataBind();\n  };\n  /**\n   * showPopup method\n   *\n   * @param {number} x - specifies the x value\n   * @param {number} y - specifies the y value\n   * @param {Element} target - specifies the element\n   * @param {string} type - specifies the type\n   * @returns {void}\n   * @hidden\n    */\n  BaseQuickToolbar.prototype.showPopup = function (x, y, target, type) {\n    var _this = this;\n    var eventArgs = {\n      popup: this.popupObj,\n      cancel: false,\n      targetElement: target,\n      positionX: x,\n      positionY: y\n    };\n    this.parent.trigger(events.beforeQuickToolbarOpen, eventArgs, function (beforeQuickToolbarArgs) {\n      if (!beforeQuickToolbarArgs.cancel) {\n        var editPanelTop = void 0;\n        var editPanelHeight = void 0;\n        var bodyStyle = window.getComputedStyle(document.body);\n        var bodyRight = parseFloat(bodyStyle.marginRight.split('px')[0]) + parseFloat(bodyStyle.paddingRight.split('px')[0]);\n        var windowHeight = window.innerHeight;\n        var windowWidth = window.innerWidth;\n        var parent_1 = _this.parent.element;\n        var toolbarAvail = !isNullOrUndefined(_this.parent.getToolbar());\n        var tbHeight = toolbarAvail && _this.parent.toolbarModule.getToolbarHeight();\n        var expTBHeight = toolbarAvail && _this.parent.toolbarModule.getExpandTBarPopHeight();\n        var tBarHeight = toolbarAvail ? tbHeight + expTBHeight : 0;\n        addClass([_this.element], [classes.CLS_HIDE]);\n        if (Browser.isDevice && !isIDevice()) {\n          addClass([_this.parent.getToolbar()], [classes.CLS_HIDE]);\n        }\n        if (_this.parent.iframeSettings.enable) {\n          var cntEle = _this.contentRenderer.getPanel().contentWindow;\n          editPanelTop = cntEle.pageYOffset;\n          editPanelHeight = cntEle.innerHeight;\n        } else {\n          var cntEle = closest(target, '.' + classes.CLS_RTE_CONTENT);\n          editPanelTop = cntEle ? cntEle.scrollTop : 0;\n          editPanelHeight = cntEle ? cntEle.offsetHeight : 0;\n        }\n        if (!_this.parent.inlineMode.enable && !closest(target, 'table') && type !== 'text' && type !== 'link' || target.tagName === 'IMG') {\n          _this.parent.disableToolbarItem(_this.parent.toolbarSettings.items);\n          _this.parent.enableToolbarItem(['Undo', 'Redo']);\n        } else {\n          _this.parent.enableToolbarItem(_this.parent.toolbarSettings.items);\n        }\n        append([_this.element], document.body);\n        if (_this.parent.showTooltip) {\n          _this.tooltip = new Tooltip({\n            target: '#' + _this.element.id + ' [title]',\n            openDelay: 400,\n            showTipPointer: true,\n            beforeRender: _this.tooltipBeforeRender.bind(_this),\n            windowCollision: true,\n            position: 'BottomCenter',\n            cssClass: _this.parent.getCssClass()\n          });\n          _this.tooltip.appendTo(_this.element);\n        }\n        _this.popupObj.position.X = beforeQuickToolbarArgs.positionX + 20;\n        _this.popupObj.position.Y = beforeQuickToolbarArgs.positionY + 20;\n        _this.popupObj.dataBind();\n        _this.popupObj.element.classList.add('e-popup-open');\n        _this.dropDownButtons.renderDropDowns({\n          container: _this.toolbarElement,\n          containerType: 'quick',\n          items: _this.stringItems\n        });\n        _this.colorPickerObj.renderColorPickerInput({\n          container: _this.toolbarElement,\n          containerType: 'quick',\n          items: _this.stringItems\n        });\n        var showPopupData = {\n          x: x,\n          y: y,\n          target: target,\n          editTop: editPanelTop,\n          editHeight: editPanelHeight,\n          popup: _this.popupObj.element,\n          popHeight: _this.popupObj.element.offsetHeight,\n          popWidth: _this.popupObj.element.offsetWidth,\n          parentElement: parent_1,\n          bodyRightSpace: bodyRight,\n          windowY: window.pageYOffset,\n          windowHeight: windowHeight,\n          windowWidth: windowWidth,\n          parentData: parent_1.getBoundingClientRect(),\n          tBarElementHeight: tBarHeight\n        };\n        if ((closest(target, 'TABLE') || target.tagName === 'IMG' || target.tagName === 'AUDIO' || target.tagName === 'VIDEO' || target.tagName === 'IFRAME' || target.classList && (target.classList.contains(classes.CLS_AUDIOWRAP) || target.classList.contains(classes.CLS_CLICKELEM) || target.classList.contains(classes.CLS_VID_CLICK_ELEM))) && (x === beforeQuickToolbarArgs.positionX || y === beforeQuickToolbarArgs.positionY)) {\n          _this.setPosition(showPopupData);\n        }\n        if (!_this.parent.inlineMode.enable) {\n          _this.checkCollision(showPopupData, 'parent', '');\n        }\n        _this.checkCollision(showPopupData, 'document', _this.parent.inlineMode.enable ? 'inline' : type === 'text' ? 'text' : '');\n        _this.popupObj.element.classList.remove('e-popup-open');\n        removeClass([_this.element], [classes.CLS_HIDE]);\n        _this.popupObj.show({\n          name: 'ZoomIn',\n          duration: Browser.isIE ? 250 : 400\n        }, target);\n        if (_this.popupObj && _this.parent.cssClass) {\n          removeClass([_this.popupObj.element], _this.parent.cssClass.replace(/\\s+/g, ' ').trim().split(' '));\n          addClass([_this.popupObj.element], _this.parent.cssClass.replace(/\\s+/g, ' ').trim().split(' '));\n        }\n        setStyleAttribute(_this.element, {\n          maxWidth: window.outerWidth + 'px'\n        });\n        addClass([_this.element], [classes.CLS_POP]);\n        _this.isRendered = true;\n      }\n    });\n  };\n  BaseQuickToolbar.prototype.tooltipBeforeRender = function (args) {\n    if (args.target.querySelector('.e-active')) {\n      args.cancel = true;\n      if (!isNOU(args.target.getAttribute('title'))) {\n        this.parent.notify(events.closeTooltip, {\n          target: args.target,\n          isTitle: true\n        });\n      }\n    }\n  };\n  /**\n   * hidePopup method\n   *\n   * @returns {void}\n   * @hidden\n    */\n  BaseQuickToolbar.prototype.hidePopup = function () {\n    var isSourceCodeEnabled = !isNOU(this.parent.rootContainer) && this.parent.rootContainer.classList.contains('e-source-code-enabled');\n    if (Browser.isDevice && !isIDevice()) {\n      removeClass([this.parent.getToolbar()], [classes.CLS_HIDE]);\n    }\n    if (!isNOU(this.element.querySelectorAll('[data-title]'))) {\n      var removeHandEle = this.element.querySelectorAll('[data-title]');\n      removeHandEle.forEach(function (e) {\n        var event = new MouseEvent('mouseout', {\n          bubbles: true,\n          cancelable: true\n        });\n        e.dispatchEvent(event);\n      });\n    }\n    if (!isNullOrUndefined(document.querySelector('.e-tooltip-wrap'))) {\n      if (!isNullOrUndefined(document.querySelector('#' + this.element.id + ' [data-tooltip-id]'))) {\n        var tooltipTargetEle = document.querySelector('#' + this.element.id + ' [data-tooltip-id]');\n        var dataContent = tooltipTargetEle.getAttribute('data-content');\n        tooltipTargetEle.removeAttribute('data-content');\n        tooltipTargetEle.setAttribute('title', dataContent);\n        tooltipTargetEle.removeAttribute('data-tooltip-id');\n      }\n      this.tooltip.destroy();\n    } else {\n      if (!isNullOrUndefined(this.tooltip)) {\n        this.tooltip.destroy();\n      }\n    }\n    if (!isNullOrUndefined(this.parent.getToolbar()) && !this.parent.inlineMode.enable) {\n      if (!isSourceCodeEnabled) {\n        this.parent.enableToolbarItem(this.parent.toolbarSettings.items);\n      }\n    }\n    this.removeEleFromDOM();\n    this.isRendered = false;\n  };\n  /**\n   * @param {string} item - specifies the string value\n   * @param {number} index - specifies the index value\n   * @returns {void}\n   * @hidden\n    */\n  BaseQuickToolbar.prototype.addQTBarItem = function (item, index) {\n    this.quickTBarObj.toolbarObj.addItems(this.quickTBarObj.getItems(item, 'toolbar'), index);\n  };\n  /**\n   * @param {number} index - specifies the index value\n   * @returns {void}\n   * @hidden\n    */\n  BaseQuickToolbar.prototype.removeQTBarItem = function (index) {\n    this.quickTBarObj.toolbarObj.removeItems(index);\n  };\n  BaseQuickToolbar.prototype.removeEleFromDOM = function () {\n    var element = this.popupObj.element;\n    if (this.isRendered) {\n      this.dropDownButtons.destroyDropDowns();\n      this.colorPickerObj.destroyColorPicker();\n      removeClass([this.element], [classes.CLS_POP]);\n      detach(element);\n      var args = this.popupObj;\n      this.parent.trigger(events.quickToolbarClose, args);\n    }\n  };\n  BaseQuickToolbar.prototype.updateStatus = function (args) {\n    var options = {\n      args: args,\n      dropDownModule: this.dropDownButtons,\n      parent: this.parent,\n      tbElements: selectAll('.' + classes.CLS_TB_ITEM, this.element),\n      tbItems: this.quickTBarObj.toolbarObj.items\n    };\n    setToolbarStatus(options, true, this.parent);\n    if (this.parent.quickToolbarSettings.text && this.parent.quickToolbarModule.textQTBar) {\n      var options_1 = {\n        args: args,\n        dropDownModule: this.parent.quickToolbarModule.textQTBar.dropDownButtons,\n        parent: this.parent,\n        tbElements: selectAll('.' + classes.CLS_TB_ITEM, this.parent.quickToolbarModule.textQTBar.element),\n        tbItems: this.parent.quickToolbarModule.textQTBar.quickTBarObj.toolbarObj.items\n      };\n      setToolbarStatus(options_1, true, this.parent);\n      updateUndoRedoStatus(this.parent.quickToolbarModule.textQTBar.quickTBarObj, this.parent.formatter.editorManager.undoRedoManager.getUndoStatus());\n    }\n    if (!select('.' + classes.CLS_RTE_SOURCE_CODE_TXTAREA, this.parent.element)) {\n      updateUndoRedoStatus(this.parent.getBaseToolbarObject(), this.parent.formatter.editorManager.undoRedoManager.getUndoStatus());\n    }\n  };\n  /**\n   * Destroys the Quick toolbar.\n   *\n   * @function destroy\n   * @returns {void}\n   * @hidden\n    */\n  BaseQuickToolbar.prototype.destroy = function () {\n    if (this.isDestroyed) {\n      return;\n    }\n    if (this.tooltip && !this.tooltip.isDestroyed) {\n      this.tooltip.destroy();\n      this.tooltip = null;\n    }\n    this.removeEventListener();\n    this.quickTBarObj.destroy();\n    this.quickTBarObj = null;\n    if (this.popupObj && !this.popupObj.isDestroyed) {\n      this.removeEleFromDOM();\n      this.popupObj.destroy();\n    }\n    this.colorPickerObj = null;\n    this.dropDownButtons = null;\n    this.stringItems = null;\n    this.dropDownButtons = null;\n    this.colorPickerObj = null;\n    this.toolbarElement = null;\n    this.isDestroyed = true;\n  };\n  /**\n   * addEventListener method\n   *\n   * @returns {void}\n   * @hidden\n    */\n  BaseQuickToolbar.prototype.addEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    this.parent.on(events.destroy, this.destroy, this);\n    this.parent.on(events.modelChanged, this.onPropertyChanged, this);\n    if (this.parent.inlineMode.enable || this.parent.quickToolbarSettings.text) {\n      this.parent.on(events.toolbarUpdated, this.updateStatus, this);\n    }\n  };\n  /**\n   * Called internally if any of the property value changed.\n   *\n   * @param {RichTextEditorModel} e - specifies the model element\n   * @returns {void}\n   * @hidden\n    */\n  BaseQuickToolbar.prototype.onPropertyChanged = function (e) {\n    if (!isNullOrUndefined(e.newProp.inlineMode)) {\n      for (var _i = 0, _a = Object.keys(e.newProp.inlineMode); _i < _a.length; _i++) {\n        var prop = _a[_i];\n        switch (prop) {\n          case 'enable':\n            if (e.newProp.inlineMode.enable) {\n              this.parent.on(events.toolbarUpdated, this.updateStatus, this);\n            } else {\n              this.parent.off(events.toolbarUpdated, this.updateStatus);\n            }\n            break;\n        }\n      }\n    }\n  };\n  /**\n   * removeEventListener method\n   *\n   * @returns {void}\n   * @hidden\n    */\n  BaseQuickToolbar.prototype.removeEventListener = function () {\n    this.parent.off(events.destroy, this.destroy);\n    this.parent.off(events.modelChanged, this.onPropertyChanged);\n    if (this.parent.inlineMode.enable || this.parent.quickToolbarSettings.text) {\n      this.parent.off(events.toolbarUpdated, this.updateStatus);\n    }\n  };\n  return BaseQuickToolbar;\n}();\nexport { BaseQuickToolbar };","map":{"version":3,"names":["detach","getUniqueID","append","closest","selectAll","select","isNullOrUndefined","isNOU","addClass","removeClass","Browser","setStyleAttribute","isCollide","Tooltip","events","classes","RenderType","setToolbarStatus","updateUndoRedoStatus","isIDevice","BaseToolbar","DropDownButtons","ColorPickerInput","BaseQuickToolbar","parent","locator","isRendered","isDestroyed","renderFactory","getService","contentRenderer","getRenderer","Content","popupRenderer","Popup","dropDownButtons","colorPickerObj","prototype","appendPopupContent","toolbarElement","createElement","className","CLS_QUICK_TB","element","classList","contains","CLS_TEXT_POP","add","CLS_TEXT_QUICK_TB","appendChild","render","args","popupType","CLS_IMAGE_POP","CLS_INLINE_POP","popupId","stringItems","toolbarItems","id","CLS_RTE_ELEMENTS","setAttribute","getID","createToolbar","mode","cssClass","renderPopup","addEventListener","items","quickTBarObj","container","target","toolbarObj","refresh","setPosition","e","x","y","imgWrapper","isAligned","CLS_RM_WHITE_SPACE","targetOffsetTop","offsetTop","parentTable","parentElement","parentOffsetTop","window","pageYOffset","parentData","top","editTop","popHeight","tBarElementHeight","editHeight","offsetHeight","targetOffsetLeft","offsetLeft","offsetWidth","popWidth","left","popupObj","position","X","right","Y","dataBind","checkCollision","viewPort","type","parentTop","contentTop","windowY","collision","popup","i","length","posY","windowHeight","tagName","bottom","pageXOffset","windowWidth","bodyRightSpace","showPopup","_this","eventArgs","cancel","targetElement","positionX","positionY","trigger","beforeQuickToolbarOpen","beforeQuickToolbarArgs","editPanelTop","editPanelHeight","bodyStyle","getComputedStyle","document","body","bodyRight","parseFloat","marginRight","split","paddingRight","innerHeight","innerWidth","parent_1","toolbarAvail","getToolbar","tbHeight","toolbarModule","getToolbarHeight","expTBHeight","getExpandTBarPopHeight","tBarHeight","CLS_HIDE","isDevice","iframeSettings","enable","cntEle","getPanel","contentWindow","CLS_RTE_CONTENT","scrollTop","inlineMode","disableToolbarItem","toolbarSettings","enableToolbarItem","showTooltip","tooltip","openDelay","showTipPointer","beforeRender","tooltipBeforeRender","bind","windowCollision","getCssClass","appendTo","renderDropDowns","containerType","renderColorPickerInput","showPopupData","getBoundingClientRect","CLS_AUDIOWRAP","CLS_CLICKELEM","CLS_VID_CLICK_ELEM","remove","show","name","duration","isIE","replace","trim","maxWidth","outerWidth","CLS_POP","querySelector","getAttribute","notify","closeTooltip","isTitle","hidePopup","isSourceCodeEnabled","rootContainer","querySelectorAll","removeHandEle","forEach","event","MouseEvent","bubbles","cancelable","dispatchEvent","tooltipTargetEle","dataContent","removeAttribute","destroy","removeEleFromDOM","addQTBarItem","item","index","addItems","getItems","removeQTBarItem","removeItems","destroyDropDowns","destroyColorPicker","quickToolbarClose","updateStatus","options","dropDownModule","tbElements","CLS_TB_ITEM","tbItems","quickToolbarSettings","text","quickToolbarModule","textQTBar","options_1","formatter","editorManager","undoRedoManager","getUndoStatus","CLS_RTE_SOURCE_CODE_TXTAREA","getBaseToolbarObject","removeEventListener","on","modelChanged","onPropertyChanged","toolbarUpdated","newProp","_i","_a","Object","keys","prop","off"],"sources":["/var/www/vue/vue-gantt-chart/node_modules/@syncfusion/ej2-richtexteditor/src/rich-text-editor/actions/base-quick-toolbar.js"],"sourcesContent":["import { detach, getUniqueID, append, closest, selectAll, select, isNullOrUndefined as isNOU } from '@syncfusion/ej2-base';\nimport { addClass, removeClass, Browser, isNullOrUndefined, setStyleAttribute } from '@syncfusion/ej2-base';\nimport { isCollide, Tooltip } from '@syncfusion/ej2-popups';\nimport * as events from '../base/constant';\nimport * as classes from '../base/classes';\nimport { RenderType } from '../base/enum';\nimport { setToolbarStatus, updateUndoRedoStatus, isIDevice } from '../base/util';\nimport { BaseToolbar } from './base-toolbar';\nimport { DropDownButtons } from './dropdown-buttons';\nimport { ColorPickerInput } from './color-picker';\n/**\n * `Quick toolbar` module is used to handle Quick toolbar actions.\n */\nvar BaseQuickToolbar = /** @class */ (function () {\n    function BaseQuickToolbar(parent, locator) {\n        this.parent = parent;\n        this.locator = locator;\n        this.isRendered = false;\n        this.isDestroyed = false;\n        this.renderFactory = this.locator.getService('rendererFactory');\n        this.contentRenderer = this.renderFactory.getRenderer(RenderType.Content);\n        this.popupRenderer = this.renderFactory.getRenderer(RenderType.Popup);\n        this.dropDownButtons = new DropDownButtons(this.parent, this.locator);\n        this.colorPickerObj = new ColorPickerInput(this.parent, this.locator);\n    }\n    BaseQuickToolbar.prototype.appendPopupContent = function () {\n        this.toolbarElement = this.parent.createElement('div', { className: classes.CLS_QUICK_TB });\n        if (this.element.classList.contains(classes.CLS_TEXT_POP)) {\n            this.toolbarElement.classList.add(classes.CLS_TEXT_QUICK_TB);\n        }\n        this.element.appendChild(this.toolbarElement);\n    };\n    /**\n     * render method\n     *\n     * @param {IQuickToolbarOptions} args - specifies the arguments\n     * @returns {void}\n     * @hidden\n\n     */\n    BaseQuickToolbar.prototype.render = function (args) {\n        var className;\n        if (args.popupType === 'Image') {\n            className = classes.CLS_IMAGE_POP;\n        }\n        else if (args.popupType === 'Inline') {\n            className = classes.CLS_INLINE_POP;\n        }\n        else if (args.popupType === 'Text') {\n            className = classes.CLS_TEXT_POP;\n        }\n        else {\n            className = '';\n        }\n        var popupId = getUniqueID(args.popupType + '_Quick_Popup');\n        this.stringItems = args.toolbarItems;\n        this.element = this.parent.createElement('div', { id: popupId, className: className + ' ' + classes.CLS_RTE_ELEMENTS });\n        this.element.setAttribute('aria-owns', this.parent.getID());\n        this.appendPopupContent();\n        this.createToolbar(args.toolbarItems, args.mode, args.cssClass);\n        this.popupRenderer.renderPopup(this);\n        this.addEventListener();\n    };\n    BaseQuickToolbar.prototype.createToolbar = function (items, mode, cssClass) {\n        this.quickTBarObj = new BaseToolbar(this.parent, this.locator);\n        this.quickTBarObj.render({\n            container: 'quick',\n            target: this.toolbarElement,\n            items: items,\n            mode: mode,\n            cssClass: cssClass\n        });\n        this.quickTBarObj.toolbarObj.refresh();\n    };\n    BaseQuickToolbar.prototype.setPosition = function (e) {\n        var x;\n        var y;\n        var imgWrapper = closest(e.target, '.e-img-caption');\n        var isAligned = (e.target.classList.contains('e-imginline') ||\n            e.target.classList.contains('e-imgbreak')) ? false : true;\n        var target = !isNOU(imgWrapper) ? imgWrapper : e.target;\n        addClass([this.toolbarElement], [classes.CLS_RM_WHITE_SPACE]);\n        var targetOffsetTop;\n        if (!isNOU(closest(target, 'table')) && !target.classList.contains('e-multi-cells-select') && !target.classList.contains('e-rte-image')) {\n            targetOffsetTop = target.offsetTop;\n            var parentTable = closest(target, 'table');\n            while (!isNOU(parentTable)) {\n                targetOffsetTop += parentTable.offsetTop;\n                parentTable = closest(parentTable.parentElement, 'table');\n            }\n        }\n        else {\n            targetOffsetTop = (target.classList.contains('e-rte-audio')) ? target.parentElement.offsetTop : target.offsetTop;\n        }\n        var parentOffsetTop = window.pageYOffset + e.parentData.top;\n        if ((targetOffsetTop - e.editTop) > e.popHeight) {\n            y = parentOffsetTop + e.tBarElementHeight + (targetOffsetTop - e.editTop) - e.popHeight - 5;\n        }\n        else if (((e.editTop + e.editHeight) - (targetOffsetTop + target.offsetHeight)) > e.popHeight) {\n            y = parentOffsetTop + e.tBarElementHeight + (targetOffsetTop - e.editTop) + target.offsetHeight + 5;\n        }\n        else {\n            y = e.y;\n        }\n        target = isAligned ? e.target : target;\n        var targetOffsetLeft;\n        if (!isNOU(closest(target, 'table')) && !target.classList.contains('e-multi-cells-select') && !target.classList.contains('e-rte-image')) {\n            targetOffsetLeft = target.offsetLeft;\n            var parentTable = closest(target.parentElement, 'th, td');\n            while (!isNOU(parentTable)) {\n                targetOffsetLeft += parentTable.offsetLeft;\n                parentTable = closest(parentTable.parentElement, 'table');\n            }\n        }\n        else {\n            targetOffsetLeft = (target.classList.contains('e-rte-audio')) ? target.parentElement.offsetLeft : target.offsetLeft;\n        }\n        if (target.offsetWidth > e.popWidth) {\n            x = (target.offsetWidth / 2) - (e.popWidth / 2) + e.parentData.left + targetOffsetLeft;\n        }\n        else {\n            x = e.parentData.left + targetOffsetLeft;\n        }\n        this.popupObj.position.X = ((x + e.popWidth) > e.parentData.right) ? e.parentData.right - e.popWidth : x;\n        this.popupObj.position.Y = (y >= 0) ? y : e.y + 5;\n        this.popupObj.dataBind();\n        removeClass([this.toolbarElement], [classes.CLS_RM_WHITE_SPACE]);\n    };\n    BaseQuickToolbar.prototype.checkCollision = function (e, viewPort, type) {\n        var x;\n        var y;\n        var parentTop = e.parentData.top;\n        var contentTop = e.windowY + parentTop + e.tBarElementHeight;\n        var collision = [];\n        if (viewPort === 'document') {\n            collision = isCollide(e.popup);\n        }\n        else {\n            collision = isCollide(e.popup, e.parentElement);\n        }\n        for (var i = 0; i < collision.length; i++) {\n            switch (collision[i]) {\n                case 'top':\n                    if (viewPort === 'document') {\n                        y = e.windowY;\n                    }\n                    else {\n                        y = (window.pageYOffset + parentTop) + e.tBarElementHeight;\n                    }\n                    break;\n                case 'bottom': {\n                    var posY = void 0;\n                    if (viewPort === 'document') {\n                        if (type === 'inline' || type === 'text') {\n                            posY = (e.y - e.popHeight - 10);\n                        }\n                        else {\n                            if ((e.windowHeight - (parentTop + e.tBarElementHeight)) > e.popHeight) {\n                                if ((contentTop - e.windowHeight) > e.popHeight) {\n                                    posY = (contentTop + (e.windowHeight - parentTop)) - e.popHeight;\n                                }\n                                else {\n                                    posY = contentTop;\n                                }\n                            }\n                            else {\n                                posY = e.windowY + (parentTop + e.tBarElementHeight);\n                            }\n                        }\n                    }\n                    else {\n                        if (e.target.tagName !== 'IMG') {\n                            posY = (e.parentData.bottom + window.pageYOffset) - e.popHeight - 10;\n                        }\n                        else {\n                            posY = (e.parentData.bottom + window.pageYOffset) - e.popHeight - 5;\n                        }\n                    }\n                    y = posY;\n                    break;\n                }\n                case 'right':\n                    if (type === 'inline' || type === 'text') {\n                        x = window.pageXOffset + (e.windowWidth - (e.popWidth + e.bodyRightSpace + 10));\n                    }\n                    else {\n                        x = e.x - e.popWidth;\n                    }\n                    break;\n                case 'left':\n                    if (type === 'inline' || type === 'text') {\n                        x = 0;\n                    }\n                    else {\n                        x = e.parentData.left;\n                    }\n                    break;\n            }\n        }\n        this.popupObj.position.X = (x) ? x : this.popupObj.position.X;\n        this.popupObj.position.Y = (y) ? y : this.popupObj.position.Y;\n        this.popupObj.dataBind();\n    };\n    /**\n     * showPopup method\n     *\n     * @param {number} x - specifies the x value\n     * @param {number} y - specifies the y value\n     * @param {Element} target - specifies the element\n     * @param {string} type - specifies the type\n     * @returns {void}\n     * @hidden\n\n     */\n    BaseQuickToolbar.prototype.showPopup = function (x, y, target, type) {\n        var _this = this;\n        var eventArgs = { popup: this.popupObj, cancel: false, targetElement: target,\n            positionX: x, positionY: y };\n        this.parent.trigger(events.beforeQuickToolbarOpen, eventArgs, function (beforeQuickToolbarArgs) {\n            if (!beforeQuickToolbarArgs.cancel) {\n                var editPanelTop = void 0;\n                var editPanelHeight = void 0;\n                var bodyStyle = window.getComputedStyle(document.body);\n                var bodyRight = parseFloat(bodyStyle.marginRight.split('px')[0]) + parseFloat(bodyStyle.paddingRight.split('px')[0]);\n                var windowHeight = window.innerHeight;\n                var windowWidth = window.innerWidth;\n                var parent_1 = _this.parent.element;\n                var toolbarAvail = !isNullOrUndefined(_this.parent.getToolbar());\n                var tbHeight = toolbarAvail && _this.parent.toolbarModule.getToolbarHeight();\n                var expTBHeight = toolbarAvail && _this.parent.toolbarModule.getExpandTBarPopHeight();\n                var tBarHeight = (toolbarAvail) ? (tbHeight + expTBHeight) : 0;\n                addClass([_this.element], [classes.CLS_HIDE]);\n                if (Browser.isDevice && !isIDevice()) {\n                    addClass([_this.parent.getToolbar()], [classes.CLS_HIDE]);\n                }\n                if (_this.parent.iframeSettings.enable) {\n                    var cntEle = _this.contentRenderer.getPanel().contentWindow;\n                    editPanelTop = cntEle.pageYOffset;\n                    editPanelHeight = cntEle.innerHeight;\n                }\n                else {\n                    var cntEle = closest(target, '.' + classes.CLS_RTE_CONTENT);\n                    editPanelTop = (cntEle) ? cntEle.scrollTop : 0;\n                    editPanelHeight = (cntEle) ? cntEle.offsetHeight : 0;\n                }\n                if ((!_this.parent.inlineMode.enable && !closest(target, 'table') && type !== 'text' && type !== 'link') || target.tagName === 'IMG') {\n                    _this.parent.disableToolbarItem(_this.parent.toolbarSettings.items);\n                    _this.parent.enableToolbarItem(['Undo', 'Redo']);\n                }\n                else {\n                    _this.parent.enableToolbarItem(_this.parent.toolbarSettings.items);\n                }\n                append([_this.element], document.body);\n                if (_this.parent.showTooltip) {\n                    _this.tooltip = new Tooltip({\n                        target: '#' + _this.element.id + ' [title]',\n                        openDelay: 400,\n                        showTipPointer: true,\n                        beforeRender: _this.tooltipBeforeRender.bind(_this),\n                        windowCollision: true,\n                        position: 'BottomCenter',\n                        cssClass: _this.parent.getCssClass()\n                    });\n                    _this.tooltip.appendTo(_this.element);\n                }\n                _this.popupObj.position.X = beforeQuickToolbarArgs.positionX + 20;\n                _this.popupObj.position.Y = beforeQuickToolbarArgs.positionY + 20;\n                _this.popupObj.dataBind();\n                _this.popupObj.element.classList.add('e-popup-open');\n                _this.dropDownButtons.renderDropDowns({\n                    container: _this.toolbarElement,\n                    containerType: 'quick',\n                    items: _this.stringItems\n                });\n                _this.colorPickerObj.renderColorPickerInput({\n                    container: _this.toolbarElement,\n                    containerType: 'quick',\n                    items: _this.stringItems\n                });\n                var showPopupData = {\n                    x: x, y: y,\n                    target: target,\n                    editTop: editPanelTop,\n                    editHeight: editPanelHeight,\n                    popup: _this.popupObj.element,\n                    popHeight: _this.popupObj.element.offsetHeight,\n                    popWidth: _this.popupObj.element.offsetWidth,\n                    parentElement: parent_1,\n                    bodyRightSpace: bodyRight,\n                    windowY: window.pageYOffset,\n                    windowHeight: windowHeight,\n                    windowWidth: windowWidth,\n                    parentData: parent_1.getBoundingClientRect(),\n                    tBarElementHeight: tBarHeight\n                };\n                if ((closest(target, 'TABLE') || target.tagName === 'IMG' || target.tagName === 'AUDIO' || target.tagName === 'VIDEO' || target.tagName === 'IFRAME' || (target.classList &&\n                    (target.classList.contains(classes.CLS_AUDIOWRAP) || target.classList.contains(classes.CLS_CLICKELEM) ||\n                        target.classList.contains(classes.CLS_VID_CLICK_ELEM)))) &&\n                    (x === beforeQuickToolbarArgs.positionX || y === beforeQuickToolbarArgs.positionY)) {\n                    _this.setPosition(showPopupData);\n                }\n                if (!_this.parent.inlineMode.enable) {\n                    _this.checkCollision(showPopupData, 'parent', '');\n                }\n                _this.checkCollision(showPopupData, 'document', ((_this.parent.inlineMode.enable) ? 'inline' : (type === 'text') ? 'text' : ''));\n                _this.popupObj.element.classList.remove('e-popup-open');\n                removeClass([_this.element], [classes.CLS_HIDE]);\n                _this.popupObj.show({ name: 'ZoomIn', duration: (Browser.isIE ? 250 : 400) }, target);\n                if (_this.popupObj && _this.parent.cssClass) {\n                    removeClass([_this.popupObj.element], _this.parent.cssClass.replace(/\\s+/g, ' ').trim().split(' '));\n                    addClass([_this.popupObj.element], _this.parent.cssClass.replace(/\\s+/g, ' ').trim().split(' '));\n                }\n                setStyleAttribute(_this.element, {\n                    maxWidth: window.outerWidth + 'px'\n                });\n                addClass([_this.element], [classes.CLS_POP]);\n                _this.isRendered = true;\n            }\n        });\n    };\n    BaseQuickToolbar.prototype.tooltipBeforeRender = function (args) {\n        if (args.target.querySelector('.e-active')) {\n            args.cancel = true;\n            if (!isNOU(args.target.getAttribute('title'))) {\n                this.parent.notify(events.closeTooltip, { target: args.target, isTitle: true });\n            }\n        }\n    };\n    /**\n     * hidePopup method\n     *\n     * @returns {void}\n     * @hidden\n\n     */\n    BaseQuickToolbar.prototype.hidePopup = function () {\n        var isSourceCodeEnabled = !isNOU(this.parent.rootContainer) && this.parent.rootContainer.classList.contains('e-source-code-enabled');\n        if (Browser.isDevice && !isIDevice()) {\n            removeClass([this.parent.getToolbar()], [classes.CLS_HIDE]);\n        }\n        if (!isNOU(this.element.querySelectorAll('[data-title]'))) {\n            var removeHandEle = this.element.querySelectorAll('[data-title]');\n            removeHandEle.forEach(function (e) {\n                var event = new MouseEvent('mouseout', { bubbles: true, cancelable: true });\n                e.dispatchEvent(event);\n            });\n        }\n        if (!isNullOrUndefined(document.querySelector('.e-tooltip-wrap'))) {\n            if (!isNullOrUndefined(document.querySelector('#' + this.element.id + ' [data-tooltip-id]'))) {\n                var tooltipTargetEle = document.querySelector('#' + this.element.id + ' [data-tooltip-id]');\n                var dataContent = tooltipTargetEle.getAttribute('data-content');\n                tooltipTargetEle.removeAttribute('data-content');\n                tooltipTargetEle.setAttribute('title', dataContent);\n                tooltipTargetEle.removeAttribute('data-tooltip-id');\n            }\n            this.tooltip.destroy();\n        }\n        else {\n            if (!isNullOrUndefined(this.tooltip)) {\n                this.tooltip.destroy();\n            }\n        }\n        if (!isNullOrUndefined(this.parent.getToolbar()) && !this.parent.inlineMode.enable) {\n            if (!isSourceCodeEnabled) {\n                this.parent.enableToolbarItem(this.parent.toolbarSettings.items);\n            }\n        }\n        this.removeEleFromDOM();\n        this.isRendered = false;\n    };\n    /**\n     * @param {string} item - specifies the string value\n     * @param {number} index - specifies the index value\n     * @returns {void}\n     * @hidden\n\n     */\n    BaseQuickToolbar.prototype.addQTBarItem = function (item, index) {\n        this.quickTBarObj.toolbarObj.addItems(this.quickTBarObj.getItems(item, 'toolbar'), index);\n    };\n    /**\n     * @param {number} index - specifies the index value\n     * @returns {void}\n     * @hidden\n\n     */\n    BaseQuickToolbar.prototype.removeQTBarItem = function (index) {\n        this.quickTBarObj.toolbarObj.removeItems(index);\n    };\n    BaseQuickToolbar.prototype.removeEleFromDOM = function () {\n        var element = this.popupObj.element;\n        if (this.isRendered) {\n            this.dropDownButtons.destroyDropDowns();\n            this.colorPickerObj.destroyColorPicker();\n            removeClass([this.element], [classes.CLS_POP]);\n            detach(element);\n            var args = this.popupObj;\n            this.parent.trigger(events.quickToolbarClose, args);\n        }\n    };\n    BaseQuickToolbar.prototype.updateStatus = function (args) {\n        var options = {\n            args: args,\n            dropDownModule: this.dropDownButtons,\n            parent: this.parent,\n            tbElements: selectAll('.' + classes.CLS_TB_ITEM, this.element),\n            tbItems: this.quickTBarObj.toolbarObj.items\n        };\n        setToolbarStatus(options, true, this.parent);\n        if (this.parent.quickToolbarSettings.text && this.parent.quickToolbarModule.textQTBar) {\n            var options_1 = {\n                args: args,\n                dropDownModule: this.parent.quickToolbarModule.textQTBar.dropDownButtons,\n                parent: this.parent,\n                tbElements: selectAll('.' + classes.CLS_TB_ITEM, this.parent.quickToolbarModule.textQTBar.element),\n                tbItems: this.parent.quickToolbarModule.textQTBar.quickTBarObj.toolbarObj.items\n            };\n            setToolbarStatus(options_1, true, this.parent);\n            updateUndoRedoStatus(this.parent.quickToolbarModule.textQTBar.quickTBarObj, this.parent.formatter.editorManager.undoRedoManager.getUndoStatus());\n        }\n        if (!select('.' + classes.CLS_RTE_SOURCE_CODE_TXTAREA, this.parent.element)) {\n            updateUndoRedoStatus(this.parent.getBaseToolbarObject(), this.parent.formatter.editorManager.undoRedoManager.getUndoStatus());\n        }\n    };\n    /**\n     * Destroys the Quick toolbar.\n     *\n     * @function destroy\n     * @returns {void}\n     * @hidden\n\n     */\n    BaseQuickToolbar.prototype.destroy = function () {\n        if (this.isDestroyed) {\n            return;\n        }\n        if (this.tooltip && !this.tooltip.isDestroyed) {\n            this.tooltip.destroy();\n            this.tooltip = null;\n        }\n        this.removeEventListener();\n        this.quickTBarObj.destroy();\n        this.quickTBarObj = null;\n        if (this.popupObj && !this.popupObj.isDestroyed) {\n            this.removeEleFromDOM();\n            this.popupObj.destroy();\n        }\n        this.colorPickerObj = null;\n        this.dropDownButtons = null;\n        this.stringItems = null;\n        this.dropDownButtons = null;\n        this.colorPickerObj = null;\n        this.toolbarElement = null;\n        this.isDestroyed = true;\n    };\n    /**\n     * addEventListener method\n     *\n     * @returns {void}\n     * @hidden\n\n     */\n    BaseQuickToolbar.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on(events.destroy, this.destroy, this);\n        this.parent.on(events.modelChanged, this.onPropertyChanged, this);\n        if (this.parent.inlineMode.enable || this.parent.quickToolbarSettings.text) {\n            this.parent.on(events.toolbarUpdated, this.updateStatus, this);\n        }\n    };\n    /**\n     * Called internally if any of the property value changed.\n     *\n     * @param {RichTextEditorModel} e - specifies the model element\n     * @returns {void}\n     * @hidden\n\n     */\n    BaseQuickToolbar.prototype.onPropertyChanged = function (e) {\n        if (!isNullOrUndefined(e.newProp.inlineMode)) {\n            for (var _i = 0, _a = Object.keys(e.newProp.inlineMode); _i < _a.length; _i++) {\n                var prop = _a[_i];\n                switch (prop) {\n                    case 'enable':\n                        if (e.newProp.inlineMode.enable) {\n                            this.parent.on(events.toolbarUpdated, this.updateStatus, this);\n                        }\n                        else {\n                            this.parent.off(events.toolbarUpdated, this.updateStatus);\n                        }\n                        break;\n                }\n            }\n        }\n    };\n    /**\n     * removeEventListener method\n     *\n     * @returns {void}\n     * @hidden\n\n     */\n    BaseQuickToolbar.prototype.removeEventListener = function () {\n        this.parent.off(events.destroy, this.destroy);\n        this.parent.off(events.modelChanged, this.onPropertyChanged);\n        if (this.parent.inlineMode.enable || this.parent.quickToolbarSettings.text) {\n            this.parent.off(events.toolbarUpdated, this.updateStatus);\n        }\n    };\n    return BaseQuickToolbar;\n}());\nexport { BaseQuickToolbar };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}