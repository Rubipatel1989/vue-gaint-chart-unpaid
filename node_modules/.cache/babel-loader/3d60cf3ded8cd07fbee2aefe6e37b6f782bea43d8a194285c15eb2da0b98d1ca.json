{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.map.js\";\nimport { extend, addClass, removeClass, setValue, closest, select, EventHandler } from '@syncfusion/ej2-base';\nimport { remove, classList } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, isUndefined } from '@syncfusion/ej2-base';\nimport { CellType } from '../base/enum';\nimport { parentsUntil, refreshForeignData, getObject, addRemoveEventListener, getCellFromRow } from '../base/util';\nimport { getCellByColAndRowIndex, addFixedColumnBorder } from '../base/util';\nimport * as events from '../base/constant';\nimport { RowRenderer } from '../renderer/row-renderer';\nimport { CellRenderer } from '../renderer/cell-renderer';\nimport { Row } from '../models/row';\nimport { Cell } from '../models/cell';\nimport { RowModelGenerator } from '../services/row-model-generator';\nimport { DataUtil } from '@syncfusion/ej2-data';\nimport * as literals from '../base/string-literals';\n/**\n * `BatchEdit` module is used to handle batch editing actions.\n *\n * @hidden\n */\nvar BatchEdit = /** @class */function () {\n  function BatchEdit(parent, serviceLocator, renderer) {\n    this.cellDetails = {};\n    this.originalCell = {};\n    this.cloneCell = {};\n    this.editNext = false;\n    this.preventSaveCell = false;\n    this.initialRender = true;\n    this.validationColObj = [];\n    /** @hidden */\n    this.addBatchRow = false;\n    this.prevEditedBatchCell = false;\n    this.parent = parent;\n    this.serviceLocator = serviceLocator;\n    this.renderer = renderer;\n    this.focus = serviceLocator.getService('focus');\n    this.addEventListener();\n  }\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  BatchEdit.prototype.addEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    this.evtHandlers = [{\n      event: events.click,\n      handler: this.clickHandler\n    }, {\n      event: events.dblclick,\n      handler: this.dblClickHandler\n    }, {\n      event: events.beforeCellFocused,\n      handler: this.onBeforeCellFocused\n    }, {\n      event: events.cellFocused,\n      handler: this.onCellFocused\n    }, {\n      event: events.doubleTap,\n      handler: this.dblClickHandler\n    }, {\n      event: events.keyPressed,\n      handler: this.keyDownHandler\n    }, {\n      event: events.editNextValCell,\n      handler: this.editNextValCell\n    }, {\n      event: events.destroy,\n      handler: this.destroy\n    }];\n    addRemoveEventListener(this.parent, this.evtHandlers, true, this);\n    EventHandler.add(this.parent.element, 'mousedown', this.mouseDownHandler, this);\n    this.dataBoundFunction = this.dataBound.bind(this);\n    this.batchCancelFunction = this.batchCancel.bind(this);\n    this.parent.addEventListener(events.dataBound, this.dataBoundFunction);\n    this.parent.addEventListener(events.batchCancel, this.batchCancelFunction);\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  BatchEdit.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    addRemoveEventListener(this.parent, this.evtHandlers, false);\n    EventHandler.remove(this.parent.element, 'mousedown', this.mouseDownHandler);\n    this.parent.removeEventListener(events.dataBound, this.dataBoundFunction);\n    this.parent.removeEventListener(events.batchCancel, this.batchCancelFunction);\n  };\n  BatchEdit.prototype.batchCancel = function () {\n    this.parent.focusModule.restoreFocus();\n  };\n  BatchEdit.prototype.dataBound = function () {\n    this.parent.notify(events.toolbarRefresh, {});\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  BatchEdit.prototype.destroy = function () {\n    this.removeEventListener();\n  };\n  BatchEdit.prototype.mouseDownHandler = function (e) {\n    if (!isNullOrUndefined(this.parent.element.querySelector('.e-gridform'))) {\n      this.mouseDownElement = e.target;\n    } else {\n      this.mouseDownElement = undefined;\n    }\n  };\n  BatchEdit.prototype.clickHandler = function (e) {\n    if (!parentsUntil(e.target, this.parent.element.id + '_add', true)) {\n      if (this.parent.isEdit && closest(this.form, 'td') !== closest(e.target, 'td') && isNullOrUndefined(this.mouseDownElement) || this.mouseDownElement === e.target) {\n        this.saveCell();\n        this.editNextValCell();\n      }\n      if (parentsUntil(e.target, literals.rowCell) && !this.parent.isEdit) {\n        this.setCellIdx(e.target);\n      }\n    }\n  };\n  BatchEdit.prototype.dblClickHandler = function (e) {\n    var target = parentsUntil(e.target, literals.rowCell);\n    var tr = parentsUntil(e.target, literals.row);\n    var rowIndex = tr && parseInt(tr.getAttribute(literals.dataRowIndex), 10);\n    var colIndex = target && parseInt(target.getAttribute(literals.dataColIndex), 10);\n    if (!isNullOrUndefined(target) && !isNullOrUndefined(rowIndex) && !isNaN(colIndex) && !target.parentElement.classList.contains(literals.editedRow) && this.parent.getColumns()[parseInt(colIndex.toString(), 10)].allowEditing) {\n      this.editCell(rowIndex, this.parent.getColumns()[parseInt(colIndex.toString(), 10)].field, this.isAddRow(rowIndex));\n    }\n  };\n  BatchEdit.prototype.onBeforeCellFocused = function (e) {\n    if (this.parent.isEdit && this.validateFormObj() && (e.byClick || ['tab', 'shiftTab', 'enter', 'shiftEnter'].indexOf(e.keyArgs.action) > -1)) {\n      e.cancel = true;\n      if (e.byClick) {\n        e.clickArgs.preventDefault();\n      } else {\n        e.keyArgs.preventDefault();\n      }\n    }\n  };\n  BatchEdit.prototype.onCellFocused = function (e) {\n    var clear = (!e.container.isContent || !e.container.isDataCell) && !(this.parent.frozenRows && e.container.isHeader);\n    if (this.parent.focusModule.active) {\n      this.prevEditedBatchCell = this.parent.focusModule.active.matrix.current.toString() === this.prevEditedBatchCellMatrix().toString();\n      this.crtRowIndex = [].slice.call(this.parent.focusModule.active.getTable().rows).indexOf(closest(e.element, 'tr'));\n    }\n    if (!e.byKey || clear) {\n      if (this.parent.isEdit && clear) {\n        this.saveCell();\n      }\n      return;\n    }\n    var _a = e.container.indexes,\n      rowIndex = _a[0],\n      cellIndex = _a[1];\n    var actualIndex = e.element.getAttribute('data-colindex') ? parseInt(e.element.getAttribute('data-colindex'), 10) : cellIndex;\n    if (actualIndex !== cellIndex) {\n      cellIndex = actualIndex;\n    }\n    if (this.parent.frozenRows && e.container.isContent) {\n      rowIndex += (this.parent.getContent().querySelector('.e-hiddenrow') ? 0 : this.parent.frozenRows) + this.parent.getHeaderContent().querySelectorAll('.e-insertedrow').length;\n    }\n    var isEdit = this.parent.isEdit;\n    if (!this.parent.element.getElementsByClassName('e-popup-open').length) {\n      isEdit = isEdit && !this.validateFormObj();\n      switch (e.keyArgs.action) {\n        case 'tab':\n        case 'shiftTab':\n          // eslint-disable-next-line no-case-declarations\n          var indent = this.parent.isRowDragable() && this.parent.isDetail() ? 2 : this.parent.isRowDragable() || this.parent.isDetail() ? 1 : 0;\n          // eslint-disable-next-line no-case-declarations\n          var col = this.parent.getColumns()[cellIndex - indent];\n          if (col && !this.parent.isEdit) {\n            this.editCell(rowIndex, col.field);\n          }\n          if (isEdit || this.parent.isLastCellPrimaryKey) {\n            this.editCellFromIndex(rowIndex, cellIndex);\n          }\n          break;\n        case 'enter':\n        case 'shiftEnter':\n          e.keyArgs.preventDefault();\n          // eslint-disable-next-line no-case-declarations\n          var args = {\n            cancel: false,\n            keyArgs: e.keyArgs\n          };\n          this.parent.notify('beforeFocusCellEdit', args);\n          if (!args.cancel && isEdit) {\n            this.editCell(rowIndex, this.cellDetails.column.field);\n          }\n          break;\n        case 'f2':\n          this.editCellFromIndex(rowIndex, cellIndex);\n          this.focus.focus();\n          break;\n      }\n    }\n  };\n  BatchEdit.prototype.isAddRow = function (index) {\n    return this.parent.getDataRows()[parseInt(index.toString(), 10)].classList.contains('e-insertedrow');\n  };\n  BatchEdit.prototype.editCellFromIndex = function (rowIdx, cellIdx) {\n    this.cellDetails.rowIndex = rowIdx;\n    this.cellDetails.cellIndex = cellIdx;\n    this.editCell(rowIdx, this.parent.getColumns()[parseInt(cellIdx.toString(), 10)].field, this.isAddRow(rowIdx));\n  };\n  BatchEdit.prototype.closeEdit = function () {\n    var gObj = this.parent;\n    var rows = this.parent.getRowsObject();\n    var argument = {\n      cancel: false,\n      batchChanges: this.getBatchChanges()\n    };\n    gObj.notify(events.beforeBatchCancel, argument);\n    if (argument.cancel) {\n      return;\n    }\n    if (gObj.isEdit) {\n      this.saveCell(true);\n    }\n    this.isAdded = false;\n    gObj.clearSelection();\n    for (var i = 0; i < rows.length; i++) {\n      var isInsert = false;\n      var isDirty = rows[parseInt(i.toString(), 10)].isDirty;\n      isInsert = this.removeBatchElementChanges(rows[parseInt(i.toString(), 10)], isDirty);\n      if (isInsert) {\n        rows.splice(i, 1);\n      }\n      if (isInsert) {\n        i--;\n      }\n    }\n    if (!gObj.getContentTable().querySelector('tr.e-row')) {\n      gObj.renderModule.renderEmptyRow();\n    }\n    var args = {\n      requestType: 'batchCancel',\n      rows: this.parent.getRowsObject()\n    };\n    gObj.notify(events.batchCancel, {\n      rows: this.parent.getRowsObject().length ? this.parent.getRowsObject() : [new Row({\n        isDataRow: true,\n        cells: [new Cell({\n          isDataCell: true,\n          visible: true\n        })]\n      })]\n    });\n    gObj.selectRow(this.cellDetails.rowIndex);\n    this.refreshRowIdx();\n    gObj.notify(events.toolbarRefresh, {});\n    this.parent.notify(events.tooltipDestroy, {});\n    args = {\n      requestType: 'batchCancel',\n      rows: this.parent.getRowsObject()\n    };\n    gObj.trigger(events.batchCancel, args);\n  };\n  BatchEdit.prototype.removeBatchElementChanges = function (row, isDirty) {\n    var gObj = this.parent;\n    var rowRenderer = new RowRenderer(this.serviceLocator, null, this.parent);\n    var isInstertedRemoved = false;\n    if (isDirty) {\n      row.isDirty = isDirty;\n      var tr = gObj.getRowElementByUID(row.uid);\n      if (tr) {\n        if (tr.classList.contains('e-insertedrow')) {\n          remove(tr);\n          isInstertedRemoved = true;\n        } else {\n          refreshForeignData(row, this.parent.getForeignKeyColumns(), row.data);\n          delete row.changes;\n          delete row.edit;\n          row.isDirty = false;\n          classList(tr, [], ['e-hiddenrow', 'e-updatedtd']);\n          rowRenderer.refresh(row, gObj.getColumns(), false);\n        }\n        if (this.parent.aggregates.length > 0) {\n          var type = 'type';\n          var editType = [];\n          editType[\"\" + type] = 'cancel';\n          this.parent.notify(events.refreshFooterRenderer, editType);\n          if (this.parent.groupSettings.columns.length > 0) {\n            this.parent.notify(events.groupAggregates, editType);\n          }\n        }\n      }\n    }\n    return isInstertedRemoved;\n  };\n  BatchEdit.prototype.deleteRecord = function (fieldname, data) {\n    this.saveCell();\n    if (this.validateFormObj()) {\n      this.saveCell(true);\n    }\n    this.isAdded = false;\n    this.bulkDelete(fieldname, data);\n    if (this.parent.aggregates.length > 0) {\n      if (!(this.parent.isReact || this.parent.isVue)) {\n        this.parent.notify(events.refreshFooterRenderer, {});\n      }\n      if (this.parent.groupSettings.columns.length > 0) {\n        this.parent.notify(events.groupAggregates, {});\n      }\n      if (this.parent.isReact || this.parent.isVue) {\n        this.parent.notify(events.refreshFooterRenderer, {});\n      }\n    }\n  };\n  BatchEdit.prototype.addRecord = function (data) {\n    this.bulkAddRow(data);\n  };\n  BatchEdit.prototype.endEdit = function () {\n    if (this.parent.isEdit && this.validateFormObj()) {\n      return;\n    }\n    this.batchSave();\n  };\n  BatchEdit.prototype.validateFormObj = function () {\n    return this.parent.editModule.formObj && !this.parent.editModule.formObj.validate();\n  };\n  BatchEdit.prototype.batchSave = function () {\n    var gObj = this.parent;\n    var deletedRecords = 'deletedRecords';\n    if (gObj.isCheckBoxSelection) {\n      var checkAllBox = gObj.element.querySelector('.e-checkselectall').parentElement;\n      if (checkAllBox.classList.contains('e-checkbox-disabled') && gObj.pageSettings.totalRecordsCount > gObj.currentViewData.length) {\n        removeClass([checkAllBox], ['e-checkbox-disabled']);\n      }\n    }\n    this.saveCell();\n    if (gObj.isEdit || this.editNextValCell() || gObj.isEdit) {\n      return;\n    }\n    var changes = this.getBatchChanges();\n    if (this.parent.selectionSettings.type === 'Multiple' && changes[\"\" + deletedRecords].length && this.parent.selectionSettings.persistSelection) {\n      changes[\"\" + deletedRecords] = this.removeSelectedData;\n      this.removeSelectedData = [];\n    }\n    var original = {\n      changedRecords: this.parent.getRowsObject().filter(function (row) {\n        return row.isDirty && ['add', 'delete'].indexOf(row.edit) === -1;\n      }).map(function (row) {\n        return row.data;\n      })\n    };\n    var args = {\n      batchChanges: changes,\n      cancel: false\n    };\n    gObj.trigger(events.beforeBatchSave, args, function (beforeBatchSaveArgs) {\n      if (beforeBatchSaveArgs.cancel) {\n        return;\n      }\n      gObj.showSpinner();\n      gObj.notify(events.bulkSave, {\n        changes: changes,\n        original: original\n      });\n    });\n  };\n  BatchEdit.prototype.getBatchChanges = function () {\n    var changes = {\n      addedRecords: [],\n      deletedRecords: [],\n      changedRecords: []\n    };\n    var rows = this.parent.getRowsObject();\n    for (var _i = 0, rows_1 = rows; _i < rows_1.length; _i++) {\n      var row = rows_1[_i];\n      if (row.isDirty) {\n        switch (row.edit) {\n          case 'add':\n            changes.addedRecords.push(row.changes);\n            break;\n          case 'delete':\n            changes.deletedRecords.push(row.data);\n            break;\n          default:\n            changes.changedRecords.push(row.changes);\n        }\n      }\n    }\n    return changes;\n  };\n  /**\n   * @param {string} uid - specifes the uid\n   * @returns {void}\n   * @hidden\n   */\n  BatchEdit.prototype.removeRowObjectFromUID = function (uid) {\n    var rows = this.parent.getRowsObject();\n    var i = 0;\n    for (var len = rows.length; i < len; i++) {\n      if (rows[parseInt(i.toString(), 10)].uid === uid) {\n        break;\n      }\n    }\n    rows.splice(i, 1);\n  };\n  /**\n   * @param {Row<Column>} row - specifies the row object\n   * @returns {void}\n   * @hidden\n   */\n  BatchEdit.prototype.addRowObject = function (row) {\n    var gObj = this.parent;\n    var isTop = gObj.editSettings.newRowPosition === 'Top';\n    var rowClone = row.clone();\n    if (isTop) {\n      gObj.getRowsObject().unshift(rowClone);\n    } else {\n      gObj.getRowsObject().push(rowClone);\n    }\n  };\n  // tslint:disable-next-line:max-func-body-length\n  BatchEdit.prototype.bulkDelete = function (fieldname, data) {\n    var _this = this;\n    this.removeSelectedData = [];\n    var gObj = this.parent;\n    var index = gObj.selectedRowIndex;\n    var selectedRows = gObj.getSelectedRows();\n    var args = {\n      primaryKey: this.parent.getPrimaryKeyFieldNames(),\n      rowIndex: index,\n      rowData: data ? data : gObj.getSelectedRecords(),\n      cancel: false\n    };\n    if (data) {\n      args.row = gObj.editModule.deleteRowUid ? gObj.getRowElementByUID(gObj.editModule.deleteRowUid) : gObj.getRows()[gObj.getCurrentViewRecords().indexOf(data)];\n    } else {\n      args.row = selectedRows;\n    }\n    if (!args.row) {\n      return;\n    }\n    // tslint:disable-next-line:max-func-body-length\n    gObj.trigger(events.beforeBatchDelete, args, function (beforeBatchDeleteArgs) {\n      if (beforeBatchDeleteArgs.cancel) {\n        return;\n      }\n      _this.removeSelectedData = gObj.getSelectedRecords();\n      gObj.clearSelection();\n      beforeBatchDeleteArgs.row = beforeBatchDeleteArgs.row ? beforeBatchDeleteArgs.row : data ? gObj.getRows()[parseInt(index.toString(), 10)] : selectedRows;\n      if (selectedRows.length === 1 || data) {\n        if (Array.isArray(beforeBatchDeleteArgs.row)) {\n          beforeBatchDeleteArgs.row = beforeBatchDeleteArgs.row[0];\n        }\n        var uid = beforeBatchDeleteArgs.row.getAttribute('data-uid');\n        uid = data && _this.parent.editModule.deleteRowUid ? uid = _this.parent.editModule.deleteRowUid : uid;\n        if (beforeBatchDeleteArgs.row.classList.contains('e-insertedrow')) {\n          _this.removeRowObjectFromUID(uid);\n          remove(beforeBatchDeleteArgs.row);\n        } else {\n          var rowObj = gObj.getRowObjectFromUID(uid);\n          rowObj.isDirty = true;\n          rowObj.edit = 'delete';\n          classList(beforeBatchDeleteArgs.row, ['e-hiddenrow', 'e-updatedtd'], []);\n          if (gObj.frozenRows && index < gObj.frozenRows && gObj.getDataRows().length >= gObj.frozenRows) {\n            gObj.getHeaderTable().querySelector(literals.tbody).appendChild(gObj.getRowByIndex(gObj.frozenRows - 1));\n          }\n        }\n        delete beforeBatchDeleteArgs.row;\n      } else {\n        if (data) {\n          index = parseInt(beforeBatchDeleteArgs.row.getAttribute(literals.dataRowIndex), 10);\n        }\n        for (var i = 0; i < selectedRows.length; i++) {\n          var uniqueid = selectedRows[parseInt(i.toString(), 10)].getAttribute('data-uid');\n          if (selectedRows[parseInt(i.toString(), 10)].classList.contains('e-insertedrow')) {\n            _this.removeRowObjectFromUID(uniqueid);\n            remove(selectedRows[parseInt(i.toString(), 10)]);\n          } else {\n            classList(selectedRows[parseInt(i.toString(), 10)], ['e-hiddenrow', 'e-updatedtd'], []);\n            var selectedRow = gObj.getRowObjectFromUID(uniqueid);\n            selectedRow.isDirty = true;\n            selectedRow.edit = 'delete';\n            if (gObj.frozenRows && index < gObj.frozenRows && gObj.getDataRows().length >= gObj.frozenRows) {\n              gObj.getHeaderTable().querySelector(literals.tbody).appendChild(gObj.getRowByIndex(gObj.frozenRows - 1));\n            }\n          }\n        }\n        delete beforeBatchDeleteArgs.row;\n      }\n      _this.refreshRowIdx();\n      if (data) {\n        gObj.editModule.deleteRowUid = undefined;\n      }\n      if (!gObj.isCheckBoxSelection) {\n        gObj.selectRow(index);\n      }\n      gObj.trigger(events.batchDelete, beforeBatchDeleteArgs);\n      gObj.notify(events.batchDelete, {\n        rows: _this.parent.getRowsObject()\n      });\n      gObj.notify(events.toolbarRefresh, {});\n      if (!gObj.getContentTable().querySelector('tr.e-row')) {\n        gObj.renderModule.renderEmptyRow();\n      }\n    });\n  };\n  BatchEdit.prototype.refreshRowIdx = function () {\n    var gObj = this.parent;\n    var rows = gObj.getAllDataRows(true);\n    var dataObjects = gObj.getRowsObject().filter(function (row) {\n      return !row.isDetailRow;\n    });\n    for (var i = 0, j = 0, len = rows.length; i < len; i++) {\n      if (rows[parseInt(i.toString(), 10)].classList.contains(literals.row) && !rows[parseInt(i.toString(), 10)].classList.contains('e-hiddenrow')) {\n        rows[parseInt(i.toString(), 10)].setAttribute(literals.dataRowIndex, j.toString());\n        rows[parseInt(i.toString(), 10)].setAttribute(literals.ariaRowIndex, (j + 1).toString());\n        dataObjects[parseInt(i.toString(), 10)].index = j;\n        j++;\n      } else {\n        rows[parseInt(i.toString(), 10)].removeAttribute(literals.dataRowIndex);\n        rows[parseInt(i.toString(), 10)].removeAttribute(literals.ariaRowIndex);\n        dataObjects[parseInt(i.toString(), 10)].index = -1;\n      }\n    }\n  };\n  BatchEdit.prototype.bulkAddRow = function (data) {\n    var _this = this;\n    var gObj = this.parent;\n    if (!gObj.editSettings.allowAdding) {\n      if (gObj.isEdit) {\n        this.saveCell();\n      }\n      return;\n    }\n    if (gObj.isEdit) {\n      this.saveCell();\n      this.parent.notify(events.editNextValCell, {});\n    }\n    if (this.validateFormObj()) {\n      return;\n    }\n    if (this.initialRender) {\n      var visibleColumns = gObj.getVisibleColumns();\n      for (var i = 0; i < visibleColumns.length; i++) {\n        if (visibleColumns[parseInt(i.toString(), 10)].validationRules && visibleColumns[parseInt(i.toString(), 10)].validationRules['required']) {\n          var obj = {\n            field: visibleColumns[parseInt(i.toString(), 10)]['field'].slice(),\n            cellIdx: i\n          };\n          this.validationColObj.push(obj);\n        }\n      }\n      this.initialRender = false;\n    }\n    this.parent.element.classList.add('e-editing');\n    var defaultData = data ? data : this.getDefaultData();\n    var args = {\n      defaultData: defaultData,\n      primaryKey: gObj.getPrimaryKeyFieldNames(),\n      cancel: false\n    };\n    gObj.trigger(events.beforeBatchAdd, args, function (beforeBatchAddArgs) {\n      if (beforeBatchAddArgs.cancel) {\n        return;\n      }\n      _this.isAdded = true;\n      gObj.clearSelection();\n      var row = new RowRenderer(_this.serviceLocator, null, _this.parent);\n      var model = new RowModelGenerator(_this.parent);\n      var modelData = model.generateRows([beforeBatchAddArgs.defaultData]);\n      var tr = row.render(modelData[0], gObj.getColumns());\n      addFixedColumnBorder(tr);\n      var col;\n      var index;\n      for (var i = 0; i < _this.parent.groupSettings.columns.length; i++) {\n        tr.insertBefore(_this.parent.createElement('td', {\n          className: 'e-indentcell'\n        }), tr.firstChild);\n        modelData[0].cells.unshift(new Cell({\n          cellType: CellType.Indent\n        }));\n      }\n      var tbody = gObj.getContentTable().querySelector(literals.tbody);\n      tr.classList.add('e-insertedrow');\n      if (tbody.querySelector('.e-emptyrow')) {\n        var emptyRow = tbody.querySelector('.e-emptyrow');\n        emptyRow.parentNode.removeChild(emptyRow);\n        if (gObj.frozenRows && gObj.element.querySelector('.e-frozenrow-empty')) {\n          gObj.element.querySelector('.e-frozenrow-empty').classList.remove('e-frozenrow-empty');\n        }\n      }\n      if (gObj.frozenRows && gObj.editSettings.newRowPosition === 'Top') {\n        tbody = gObj.getHeaderTable().querySelector(literals.tbody);\n      } else {\n        tbody = gObj.getContentTable().querySelector(literals.tbody);\n      }\n      if (_this.parent.editSettings.newRowPosition === 'Top') {\n        tbody.insertBefore(tr, tbody.firstChild);\n      } else {\n        tbody.appendChild(tr);\n      }\n      addClass([].slice.call(tr.getElementsByClassName(literals.rowCell)), ['e-updatedtd']);\n      modelData[0].isDirty = true;\n      modelData[0].changes = extend({}, {}, modelData[0].data, true);\n      modelData[0].edit = 'add';\n      _this.addRowObject(modelData[0]);\n      _this.refreshRowIdx();\n      _this.focus.forgetPrevious();\n      gObj.notify(events.batchAdd, {\n        rows: _this.parent.getRowsObject()\n      });\n      var changes = _this.getBatchChanges();\n      var btmIdx = _this.getBottomIndex();\n      if (_this.parent.editSettings.newRowPosition === 'Top') {\n        gObj.selectRow(0);\n      } else {\n        gObj.selectRow(btmIdx);\n      }\n      if (!data) {\n        index = _this.findNextEditableCell(0, true);\n        col = gObj.getColumns()[parseInt(index.toString(), 10)];\n        if (_this.parent.editSettings.newRowPosition === 'Top') {\n          _this.editCell(0, col.field, true);\n        } else {\n          _this.editCell(btmIdx, col.field, true);\n        }\n      }\n      if (_this.parent.aggregates.length > 0 && (data || changes[literals.addedRecords].length)) {\n        _this.parent.notify(events.refreshFooterRenderer, {});\n      }\n      var args1 = {\n        defaultData: beforeBatchAddArgs.defaultData,\n        row: tr,\n        columnObject: col,\n        columnIndex: index,\n        primaryKey: beforeBatchAddArgs.primaryKey,\n        cell: !isNullOrUndefined(index) ? tr.cells[parseInt(index.toString(), 10)] : undefined\n      };\n      gObj.trigger(events.batchAdd, args1);\n    });\n  };\n  BatchEdit.prototype.findNextEditableCell = function (columnIndex, isAdd, isValOnly) {\n    var cols = this.parent.getColumns();\n    var endIndex = cols.length;\n    var validation;\n    for (var i = columnIndex; i < endIndex; i++) {\n      validation = isValOnly ? isNullOrUndefined(cols[parseInt(i.toString(), 10)].validationRules) : false;\n      // if (!isAdd && this.checkNPCell(cols[parseInt(i.toString(), 10)])) {\n      //     return i;\n      // } else\n      if (isAdd && (!cols[parseInt(i.toString(), 10)].template || cols[parseInt(i.toString(), 10)].field) && cols[parseInt(i.toString(), 10)].allowEditing && cols[parseInt(i.toString(), 10)].visible && !(cols[parseInt(i.toString(), 10)].isIdentity && cols[parseInt(i.toString(), 10)].isPrimaryKey) && !validation) {\n        return i;\n      }\n    }\n    return -1;\n  };\n  BatchEdit.prototype.getDefaultData = function () {\n    var gObj = this.parent;\n    var data = {};\n    var dValues = {\n      'number': 0,\n      'string': null,\n      'boolean': false,\n      'date': null,\n      'datetime': null,\n      'dateonly': null\n    };\n    for (var _i = 0, _a = gObj.columnModel; _i < _a.length; _i++) {\n      var col = _a[_i];\n      if (col.field) {\n        setValue(col.field, Object.keys(col).indexOf('defaultValue') >= 0 ? col.defaultValue : dValues[col.type], data);\n      }\n    }\n    return data;\n  };\n  BatchEdit.prototype.setCellIdx = function (target) {\n    var gLen = 0;\n    if (this.parent.allowGrouping) {\n      gLen = this.parent.groupSettings.columns.length;\n    }\n    this.cellDetails.cellIndex = target.cellIndex - gLen;\n    this.cellDetails.rowIndex = parseInt(target.getAttribute('index'), 10);\n  };\n  BatchEdit.prototype.editCell = function (index, field, isAdd) {\n    var gObj = this.parent;\n    var col = gObj.getColumnByField(field);\n    this.index = index;\n    this.field = field;\n    this.isAdd = isAdd;\n    var checkEdit = gObj.isEdit && !(this.cellDetails.column.field === field && this.cellDetails.rowIndex === index && this.parent.getDataRows().length - 1 !== index && this.prevEditedBatchCell);\n    if (gObj.editSettings.allowEditing) {\n      if (!checkEdit && (col.allowEditing || !col.allowEditing && gObj.focusModule.active && gObj.focusModule.active.getTable().rows[this.crtRowIndex] && gObj.focusModule.active.getTable().rows[this.crtRowIndex].classList.contains('e-insertedrow'))) {\n        this.editCellExtend(index, field, isAdd);\n      } else if (checkEdit) {\n        this.editNext = true;\n        this.saveCell();\n      }\n    }\n  };\n  BatchEdit.prototype.editCellExtend = function (index, field, isAdd) {\n    var _this = this;\n    var gObj = this.parent;\n    var col = gObj.getColumnByField(field);\n    var keys = gObj.getPrimaryKeyFieldNames();\n    if (gObj.isEdit) {\n      return;\n    }\n    var rowData = extend({}, {}, this.getDataByIndex(index), true);\n    var row = gObj.getDataRows()[parseInt(index.toString(), 10)];\n    rowData = extend({}, {}, this.getDataByIndex(index), true);\n    if (keys[0] === col.field && !row.classList.contains('e-insertedrow') || col.columns || col.isPrimaryKey && col.isIdentity || col.commands) {\n      this.parent.isLastCellPrimaryKey = true;\n      return;\n    }\n    this.parent.isLastCellPrimaryKey = false;\n    this.parent.element.classList.add('e-editing');\n    var rowObj = gObj.getRowObjectFromUID(row.getAttribute('data-uid'));\n    var cells = [].slice.apply(row.cells);\n    var args = {\n      columnName: col.field,\n      isForeignKey: !isNullOrUndefined(col.foreignKeyValue),\n      primaryKey: keys,\n      rowData: rowData,\n      validationRules: extend({}, col.validationRules ? col.validationRules : {}),\n      value: getObject(col.field, rowData),\n      type: !isAdd ? 'edit' : 'add',\n      cancel: false,\n      foreignKeyData: rowObj && rowObj.foreignKeyData\n    };\n    args.cell = cells[this.getColIndex(cells, this.getCellIdx(col.uid))];\n    args.row = row;\n    args.columnObject = col;\n    if (!args.cell) {\n      return;\n    }\n    gObj.trigger(events.cellEdit, args, function (cellEditArgs) {\n      if (cellEditArgs.cancel) {\n        return;\n      }\n      cellEditArgs.cell = cellEditArgs.cell ? cellEditArgs.cell : cells[_this.getColIndex(cells, _this.getCellIdx(col.uid))];\n      cellEditArgs.row = cellEditArgs.row ? cellEditArgs.row : row;\n      cellEditArgs.columnObject = cellEditArgs.columnObject ? cellEditArgs.columnObject : col;\n      // cellEditArgs.columnObject.index = isNullOrUndefined(cellEditArgs.columnObject.index) ? 0 : cellEditArgs.columnObject.index;\n      _this.cellDetails = {\n        rowData: rowData,\n        column: col,\n        value: cellEditArgs.value,\n        isForeignKey: cellEditArgs.isForeignKey,\n        rowIndex: index,\n        cellIndex: parseInt(cellEditArgs.cell.getAttribute(literals.dataColIndex), 10),\n        foreignKeyData: cellEditArgs.foreignKeyData\n      };\n      if (cellEditArgs.cell.classList.contains('e-updatedtd')) {\n        _this.isColored = true;\n        cellEditArgs.cell.classList.remove('e-updatedtd');\n      }\n      gObj.isEdit = true;\n      gObj.clearSelection();\n      if (!gObj.isCheckBoxSelection || !gObj.isPersistSelection) {\n        gObj.selectRow(_this.cellDetails.rowIndex, true);\n      }\n      _this.renderer.update(cellEditArgs);\n      _this.parent.notify(events.batchEditFormRendered, cellEditArgs);\n      _this.form = select('#' + gObj.element.id + 'EditForm', gObj.element);\n      gObj.editModule.applyFormValidation([col]);\n      _this.parent.element.querySelector('.e-gridpopup').style.display = 'none';\n    });\n  };\n  BatchEdit.prototype.updateCell = function (rowIndex, field, value) {\n    var gObj = this.parent;\n    var col = gObj.getColumnByField(field);\n    var index = gObj.getColumnIndexByField(field);\n    var isInsertedBatchRow = gObj.getRowByIndex(rowIndex).classList.contains('e-insertedrow') && gObj.getRowByIndex(rowIndex).classList.contains('e-batchrow');\n    if (col && (!col.isPrimaryKey || isInsertedBatchRow) && col.allowEditing) {\n      var td_1 = this.parent.isSpan ? getCellFromRow(gObj, rowIndex, index) : getCellByColAndRowIndex(this.parent, col, rowIndex, index);\n      if (this.parent.isSpan && !td_1) {\n        return;\n      }\n      var rowObj_1 = gObj.getRowObjectFromUID(td_1.parentElement.getAttribute('data-uid'));\n      if (gObj.isEdit || !rowObj_1.changes && (!(value instanceof Date) && rowObj_1.data['' + field] !== value || value instanceof Date && new Date(rowObj_1.data['' + field]).toString() !== new Date(value).toString()) || rowObj_1.changes && (!(value instanceof Date) && rowObj_1.changes['' + field] !== value || value instanceof Date && new Date(rowObj_1.changes['' + field]).toString() !== new Date(value).toString())) {\n        this.refreshTD(td_1, col, rowObj_1, value);\n        var isReactChild = this.parent.parentDetails && this.parent.parentDetails.parentInstObj && this.parent.parentDetails.parentInstObj.isReact;\n        if ((this.parent.isReact && this.parent.requireTemplateRef || isReactChild && this.parent.parentDetails.parentInstObj.requireTemplateRef) && col.template) {\n          // eslint-disable-next-line @typescript-eslint/no-this-alias\n          var thisRef_1 = this;\n          var newReactTd_1 = this.newReactTd;\n          thisRef_1.parent.renderTemplates(function () {\n            thisRef_1.parent.trigger(events.queryCellInfo, {\n              cell: newReactTd_1 || td_1,\n              column: col,\n              data: rowObj_1.changes\n            });\n          });\n        } else if ((this.parent.isReact || isReactChild) && col.template) {\n          this.parent.renderTemplates();\n          this.parent.trigger(events.queryCellInfo, {\n            cell: this.newReactTd || td_1,\n            column: col,\n            data: rowObj_1.changes\n          });\n        } else {\n          this.parent.trigger(events.queryCellInfo, {\n            cell: this.newReactTd || td_1,\n            column: col,\n            data: rowObj_1.changes\n          });\n        }\n      }\n    }\n  };\n  BatchEdit.prototype.setChanges = function (rowObj, field, value) {\n    if (!rowObj.changes) {\n      rowObj.changes = extend({}, {}, rowObj.data, true);\n    }\n    if (!isNullOrUndefined(field)) {\n      if (typeof value === 'string') {\n        value = this.parent.sanitize(value);\n      }\n      DataUtil.setValue(field, value, rowObj.changes);\n    }\n    if (rowObj.data[\"\" + field] !== value) {\n      var type = this.parent.getColumnByField(field).type;\n      if (type === 'date' || type === 'datetime') {\n        if (new Date(rowObj.data[\"\" + field]).toString() !== new Date(value).toString()) {\n          rowObj.isDirty = true;\n        }\n      } else {\n        rowObj.isDirty = true;\n      }\n    }\n  };\n  BatchEdit.prototype.updateRow = function (index, data) {\n    var keys = Object.keys(data);\n    for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n      var col = keys_1[_i];\n      this.updateCell(index, col, data[\"\" + col]);\n    }\n  };\n  BatchEdit.prototype.getCellIdx = function (uid) {\n    var cIdx = this.parent.getColumnIndexByUid(uid) + this.parent.groupSettings.columns.length;\n    if (!isNullOrUndefined(this.parent.detailTemplate) || !isNullOrUndefined(this.parent.childGrid)) {\n      cIdx++;\n    }\n    if (this.parent.isRowDragable()) {\n      cIdx++;\n    }\n    return cIdx;\n  };\n  BatchEdit.prototype.refreshTD = function (td, column, rowObj, value) {\n    var cell = new CellRenderer(this.parent, this.serviceLocator);\n    value = column.type === 'number' && !isNullOrUndefined(value) ? parseFloat(value) : value;\n    if (rowObj) {\n      this.setChanges(rowObj, column.field, value);\n      refreshForeignData(rowObj, this.parent.getForeignKeyColumns(), rowObj.changes);\n    }\n    var rowcell = rowObj ? rowObj.cells : undefined;\n    var parentElement;\n    var cellIndex;\n    if (this.parent.isReact) {\n      parentElement = td.parentElement;\n      cellIndex = td.cellIndex;\n    }\n    var index = 0;\n    if (rowObj) {\n      cell.refreshTD(td, rowcell[this.getCellIdx(column.uid) - index], rowObj.changes, {\n        'index': this.getCellIdx(column.uid)\n      });\n    }\n    if (this.parent.isReact) {\n      this.newReactTd = parentElement.cells[parseInt(cellIndex.toString(), 10)];\n      parentElement.cells[parseInt(cellIndex.toString(), 10)].classList.add('e-updatedtd');\n    } else {\n      td.classList.add('e-updatedtd');\n    }\n    td.classList.add('e-updatedtd');\n    this.parent.notify(events.toolbarRefresh, {});\n  };\n  BatchEdit.prototype.getColIndex = function (cells, index) {\n    var cIdx = 0;\n    if (this.parent.allowGrouping && this.parent.groupSettings.columns) {\n      cIdx = this.parent.groupSettings.columns.length;\n    }\n    if (!isNullOrUndefined(this.parent.detailTemplate) || !isNullOrUndefined(this.parent.childGrid)) {\n      cIdx++;\n    }\n    if (this.parent.isRowDragable()) {\n      cIdx++;\n    }\n    for (var m = 0; m < cells.length; m++) {\n      var colIndex = parseInt(cells[parseInt(m.toString(), 10)].getAttribute(literals.dataColIndex), 10);\n      if (colIndex === index - cIdx) {\n        return m;\n      }\n    }\n    return -1;\n  };\n  BatchEdit.prototype.editNextValCell = function () {\n    var gObj = this.parent;\n    var insertedRows = gObj.element.querySelectorAll('.e-insertedrow');\n    var isSingleInsert = insertedRows.length === 1 ? true : false;\n    if (isSingleInsert && this.isAdded && !gObj.isEdit) {\n      var btmIdx = this.getBottomIndex();\n      for (var i = this.cellDetails.cellIndex; i < gObj.getColumns().length; i++) {\n        if (gObj.isEdit) {\n          return;\n        }\n        var index = this.findNextEditableCell(this.cellDetails.cellIndex + 1, true, true);\n        var col = gObj.getColumns()[parseInt(index.toString(), 10)];\n        if (col) {\n          if (this.parent.editSettings.newRowPosition === 'Bottom') {\n            this.editCell(btmIdx, col.field, true);\n          } else {\n            var args = {\n              index: 0,\n              column: col\n            };\n            this.parent.notify(events.nextCellIndex, args);\n            this.editCell(args.index, col.field, true);\n          }\n          this.saveCell();\n        }\n      }\n      if (!gObj.isEdit) {\n        this.isAdded = false;\n      }\n    } else if (!isSingleInsert && this.isAdded && !gObj.isEdit) {\n      for (var i = 0; i < insertedRows.length; i++) {\n        if (!gObj.isEdit) {\n          for (var j = 0; j < this.validationColObj.length; j++) {\n            if (gObj.isEdit) {\n              break;\n            } else if (insertedRows[parseInt(i.toString(), 10)].querySelectorAll('td:not(.e-hide)')[this.validationColObj[parseInt(j.toString(), 10)].cellIdx].innerHTML === '') {\n              this.editCell(parseInt(insertedRows[parseInt(i.toString(), 10)].getAttribute('data-rowindex'), 10), this.validationColObj[parseInt(j.toString(), 10)].field);\n              if (this.validateFormObj()) {\n                this.saveCell();\n              }\n            }\n          }\n        } else {\n          break;\n        }\n      }\n      if (!gObj.isEdit) {\n        this.isAdded = false;\n      }\n    }\n  };\n  BatchEdit.prototype.escapeCellEdit = function () {\n    var args = this.generateCellArgs();\n    args.value = args.previousValue;\n    if (args.value || !this.cellDetails.column.validationRules) {\n      this.successCallBack(args, args.cell.parentElement, args.column, true)(args);\n    }\n  };\n  BatchEdit.prototype.generateCellArgs = function () {\n    var gObj = this.parent;\n    this.parent.element.classList.remove('e-editing');\n    var column = this.cellDetails.column;\n    var obj = {};\n    obj[column.field] = getObject(column.field, this.cellDetails.rowData);\n    var editedData = gObj.editModule.getCurrentEditedData(this.form, obj);\n    var cloneEditedData = extend({}, editedData);\n    editedData = extend({}, editedData, this.cellDetails.rowData);\n    var value = getObject(column.field, cloneEditedData);\n    if (!isNullOrUndefined(column.field) && !isUndefined(value)) {\n      setValue(column.field, value, editedData);\n    }\n    var args = {\n      columnName: column.field,\n      value: getObject(column.field, editedData),\n      rowData: this.cellDetails.rowData,\n      column: column,\n      previousValue: this.cellDetails.value,\n      isForeignKey: this.cellDetails.isForeignKey,\n      cancel: false\n    };\n    args.cell = this.form.parentElement;\n    args.columnObject = column;\n    return args;\n  };\n  BatchEdit.prototype.saveCell = function (isForceSave) {\n    if (this.preventSaveCell || !this.form) {\n      return;\n    }\n    var gObj = this.parent;\n    if (!isForceSave && (!gObj.isEdit || this.validateFormObj())) {\n      return;\n    }\n    this.preventSaveCell = true;\n    var args = this.generateCellArgs();\n    var tr = args.cell.parentElement;\n    var col = args.column;\n    args.cell.removeAttribute('aria-label');\n    if (!isForceSave) {\n      gObj.trigger(events.cellSave, args, this.successCallBack(args, tr, col));\n      gObj.notify(events.batchForm, {\n        formObj: this.form\n      });\n    } else {\n      this.successCallBack(args, tr, col)(args);\n    }\n  };\n  BatchEdit.prototype.successCallBack = function (cellSaveArgs, tr, column, isEscapeCellEdit) {\n    var _this = this;\n    return function (cellSaveArgs) {\n      var gObj = _this.parent;\n      cellSaveArgs.cell = cellSaveArgs.cell ? cellSaveArgs.cell : _this.form.parentElement;\n      cellSaveArgs.columnObject = cellSaveArgs.columnObject ? cellSaveArgs.columnObject : column;\n      // cellSaveArgs.columnObject.index = isNullOrUndefined(cellSaveArgs.columnObject.index) ? 0 : cellSaveArgs.columnObject.index;\n      if (cellSaveArgs.cancel) {\n        _this.preventSaveCell = false;\n        if (_this.editNext) {\n          _this.editNext = false;\n          if (_this.cellDetails.rowIndex === _this.index && _this.cellDetails.column.field === _this.field) {\n            return;\n          }\n          _this.editCellExtend(_this.index, _this.field, _this.isAdd);\n        }\n        return;\n      }\n      gObj.editModule.destroyWidgets([column]);\n      gObj.isEdit = false;\n      gObj.editModule.destroyForm();\n      _this.parent.notify(events.tooltipDestroy, {});\n      var rowObj = gObj.getRowObjectFromUID(tr.getAttribute('data-uid'));\n      _this.refreshTD(cellSaveArgs.cell, column, rowObj, cellSaveArgs.value);\n      if (_this.parent.isReact) {\n        cellSaveArgs.cell = _this.newReactTd;\n      }\n      removeClass([tr], [literals.editedRow, 'e-batchrow']);\n      removeClass([cellSaveArgs.cell], ['e-editedbatchcell', 'e-boolcell']);\n      if (!isNullOrUndefined(cellSaveArgs.value) && cellSaveArgs.value.toString() === (!isNullOrUndefined(_this.cellDetails.value) ? _this.cellDetails.value : '').toString() && !_this.isColored || isNullOrUndefined(cellSaveArgs.value) && isNullOrUndefined(rowObj.data[column.field]) && isNullOrUndefined(_this.cellDetails.value) && !cellSaveArgs.cell.parentElement.classList.contains('e-insertedrow')) {\n        cellSaveArgs.cell.classList.remove('e-updatedtd');\n      }\n      if (isNullOrUndefined(isEscapeCellEdit)) {\n        var isReactCompiler = gObj.isReact && column.template && typeof column.template !== 'string';\n        var isReactChild = gObj.parentDetails && gObj.parentDetails.parentInstObj && gObj.parentDetails.parentInstObj.isReact;\n        if (isReactCompiler || isReactChild) {\n          if (gObj.requireTemplateRef) {\n            gObj.renderTemplates(function () {\n              gObj.trigger(events.cellSaved, cellSaveArgs);\n            });\n          } else {\n            gObj.renderTemplates();\n            gObj.trigger(events.cellSaved, cellSaveArgs);\n          }\n        } else {\n          gObj.trigger(events.cellSaved, cellSaveArgs);\n        }\n      }\n      gObj.notify(events.toolbarRefresh, {});\n      _this.isColored = false;\n      if (_this.parent.aggregates.length > 0) {\n        if (!(_this.parent.isReact || _this.parent.isVue)) {\n          _this.parent.notify(events.refreshFooterRenderer, {});\n        }\n        if (_this.parent.groupSettings.columns.length > 0 && !_this.isAddRow(_this.cellDetails.rowIndex)) {\n          _this.parent.notify(events.groupAggregates, {});\n        }\n        if (_this.parent.isReact || _this.parent.isVue) {\n          _this.parent.notify(events.refreshFooterRenderer, {});\n        }\n      }\n      _this.preventSaveCell = false;\n      if (_this.editNext) {\n        _this.editNext = false;\n        if (_this.cellDetails.rowIndex === _this.index && _this.cellDetails.column.field === _this.field && _this.prevEditedBatchCell) {\n          return;\n        }\n        var col = gObj.getColumnByField(_this.field);\n        if (col && (col.allowEditing || !col.allowEditing && gObj.focusModule.active && gObj.focusModule.active.getTable().rows[_this.crtRowIndex] && gObj.focusModule.active.getTable().rows[_this.crtRowIndex].classList.contains('e-insertedrow'))) {\n          _this.editCellExtend(_this.index, _this.field, _this.isAdd);\n        }\n      }\n      if (isEscapeCellEdit) {\n        gObj.notify(events.restoreFocus, {});\n      }\n    };\n  };\n  BatchEdit.prototype.prevEditedBatchCellMatrix = function () {\n    var editedBatchCellMatrix = [];\n    var gObj = this.parent;\n    var editedBatchCell = gObj.focusModule.active.getTable().querySelector('.e-editedbatchcell');\n    if (editedBatchCell) {\n      var tr = editedBatchCell.parentElement;\n      var rowIndex = [].slice.call(this.parent.focusModule.active.getTable().rows).indexOf(tr);\n      var cellIndex = [].slice.call(tr.cells).indexOf(editedBatchCell);\n      editedBatchCellMatrix = [rowIndex, cellIndex];\n    }\n    return editedBatchCellMatrix;\n  };\n  BatchEdit.prototype.getDataByIndex = function (index) {\n    var row = this.parent.getRowObjectFromUID(this.parent.getDataRows()[parseInt(index.toString(), 10)].getAttribute('data-uid'));\n    return row.changes ? row.changes : row.data;\n  };\n  BatchEdit.prototype.keyDownHandler = function (e) {\n    if (this.addBatchRow || (e.action === 'tab' || e.action === 'shiftTab') && this.parent.isEdit) {\n      var gObj = this.parent;\n      var btmIdx = this.getBottomIndex();\n      var rowcell = parentsUntil(e.target, literals.rowCell);\n      if (this.addBatchRow || rowcell && !this.parent.isReact) {\n        var cell = void 0;\n        if (rowcell) {\n          cell = rowcell.querySelector('.e-field');\n        }\n        if (this.addBatchRow || cell) {\n          var visibleColumns = this.parent.getVisibleColumns();\n          var columnIndex = e.action === 'tab' ? visibleColumns.length - 1 : 0;\n          if (this.addBatchRow || visibleColumns[parseInt(columnIndex.toString(), 10)].field === cell.getAttribute('id').slice(this.parent.element.id.length)) {\n            if (this.cellDetails.rowIndex === btmIdx && e.action === 'tab') {\n              if (gObj.editSettings.newRowPosition === 'Top') {\n                gObj.editSettings.newRowPosition = 'Bottom';\n                this.addRecord();\n                gObj.editSettings.newRowPosition = 'Top';\n              } else {\n                this.addRecord();\n              }\n              this.addBatchRow = false;\n            } else {\n              this.saveCell();\n            }\n          }\n        }\n      }\n    }\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  BatchEdit.prototype.addCancelWhilePaging = function () {\n    if (this.validateFormObj()) {\n      this.parent.notify(events.destroyForm, {});\n      this.parent.isEdit = false;\n      this.editNext = false;\n      this.mouseDownElement = undefined;\n      this.isColored = false;\n    }\n  };\n  BatchEdit.prototype.getBottomIndex = function () {\n    var changes = this.getBatchChanges();\n    return this.parent.getCurrentViewRecords().length + changes[literals.addedRecords].length - changes[literals.deletedRecords].length - 1;\n  };\n  return BatchEdit;\n}();\nexport { BatchEdit };","map":{"version":3,"names":["extend","addClass","removeClass","setValue","closest","select","EventHandler","remove","classList","isNullOrUndefined","isUndefined","CellType","parentsUntil","refreshForeignData","getObject","addRemoveEventListener","getCellFromRow","getCellByColAndRowIndex","addFixedColumnBorder","events","RowRenderer","CellRenderer","Row","Cell","RowModelGenerator","DataUtil","literals","BatchEdit","parent","serviceLocator","renderer","cellDetails","originalCell","cloneCell","editNext","preventSaveCell","initialRender","validationColObj","addBatchRow","prevEditedBatchCell","focus","getService","addEventListener","prototype","isDestroyed","evtHandlers","event","click","handler","clickHandler","dblclick","dblClickHandler","beforeCellFocused","onBeforeCellFocused","cellFocused","onCellFocused","doubleTap","keyPressed","keyDownHandler","editNextValCell","destroy","add","element","mouseDownHandler","dataBoundFunction","dataBound","bind","batchCancelFunction","batchCancel","removeEventListener","focusModule","restoreFocus","notify","toolbarRefresh","e","querySelector","mouseDownElement","target","undefined","id","isEdit","form","saveCell","rowCell","setCellIdx","tr","row","rowIndex","parseInt","getAttribute","dataRowIndex","colIndex","dataColIndex","isNaN","parentElement","contains","editedRow","getColumns","toString","allowEditing","editCell","field","isAddRow","validateFormObj","byClick","indexOf","keyArgs","action","cancel","clickArgs","preventDefault","clear","container","isContent","isDataCell","frozenRows","isHeader","active","matrix","current","prevEditedBatchCellMatrix","crtRowIndex","slice","call","getTable","rows","byKey","_a","indexes","cellIndex","actualIndex","getContent","getHeaderContent","querySelectorAll","length","getElementsByClassName","indent","isRowDragable","isDetail","col","isLastCellPrimaryKey","editCellFromIndex","args","column","index","getDataRows","rowIdx","cellIdx","closeEdit","gObj","getRowsObject","argument","batchChanges","getBatchChanges","beforeBatchCancel","isAdded","clearSelection","i","isInsert","isDirty","removeBatchElementChanges","splice","getContentTable","renderModule","renderEmptyRow","requestType","isDataRow","cells","visible","selectRow","refreshRowIdx","tooltipDestroy","trigger","rowRenderer","isInstertedRemoved","getRowElementByUID","uid","getForeignKeyColumns","data","changes","edit","refresh","aggregates","type","editType","refreshFooterRenderer","groupSettings","columns","groupAggregates","deleteRecord","fieldname","bulkDelete","isReact","isVue","addRecord","bulkAddRow","endEdit","batchSave","editModule","formObj","validate","deletedRecords","isCheckBoxSelection","checkAllBox","pageSettings","totalRecordsCount","currentViewData","selectionSettings","persistSelection","removeSelectedData","original","changedRecords","filter","map","beforeBatchSave","beforeBatchSaveArgs","showSpinner","bulkSave","addedRecords","_i","rows_1","push","removeRowObjectFromUID","len","addRowObject","isTop","editSettings","newRowPosition","rowClone","clone","unshift","_this","selectedRowIndex","selectedRows","getSelectedRows","primaryKey","getPrimaryKeyFieldNames","rowData","getSelectedRecords","deleteRowUid","getRows","getCurrentViewRecords","beforeBatchDelete","beforeBatchDeleteArgs","Array","isArray","rowObj","getRowObjectFromUID","getHeaderTable","tbody","appendChild","getRowByIndex","uniqueid","selectedRow","batchDelete","getAllDataRows","dataObjects","isDetailRow","j","setAttribute","ariaRowIndex","removeAttribute","allowAdding","visibleColumns","getVisibleColumns","validationRules","obj","defaultData","getDefaultData","beforeBatchAdd","beforeBatchAddArgs","model","modelData","generateRows","render","insertBefore","createElement","className","firstChild","cellType","Indent","emptyRow","parentNode","removeChild","forgetPrevious","batchAdd","btmIdx","getBottomIndex","findNextEditableCell","args1","columnObject","columnIndex","cell","isAdd","isValOnly","cols","endIndex","validation","template","isIdentity","isPrimaryKey","dValues","columnModel","Object","keys","defaultValue","gLen","allowGrouping","getColumnByField","checkEdit","editCellExtend","getDataByIndex","commands","apply","columnName","isForeignKey","foreignKeyValue","value","foreignKeyData","getColIndex","getCellIdx","cellEdit","cellEditArgs","isColored","isPersistSelection","update","batchEditFormRendered","applyFormValidation","style","display","updateCell","getColumnIndexByField","isInsertedBatchRow","td_1","isSpan","rowObj_1","Date","refreshTD","isReactChild","parentDetails","parentInstObj","requireTemplateRef","thisRef_1","newReactTd_1","newReactTd","renderTemplates","queryCellInfo","setChanges","sanitize","updateRow","keys_1","cIdx","getColumnIndexByUid","detailTemplate","childGrid","td","parseFloat","rowcell","m","insertedRows","isSingleInsert","nextCellIndex","innerHTML","escapeCellEdit","generateCellArgs","previousValue","successCallBack","editedData","getCurrentEditedData","cloneEditedData","isForceSave","cellSave","batchForm","cellSaveArgs","isEscapeCellEdit","destroyWidgets","destroyForm","isReactCompiler","cellSaved","editedBatchCellMatrix","editedBatchCell","addCancelWhilePaging"],"sources":["/var/www/vue/vue-gantt-chart/node_modules/@syncfusion/ej2-grids/src/grid/actions/batch-edit.js"],"sourcesContent":["import { extend, addClass, removeClass, setValue, closest, select, EventHandler } from '@syncfusion/ej2-base';\nimport { remove, classList } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, isUndefined } from '@syncfusion/ej2-base';\nimport { CellType } from '../base/enum';\nimport { parentsUntil, refreshForeignData, getObject, addRemoveEventListener, getCellFromRow } from '../base/util';\nimport { getCellByColAndRowIndex, addFixedColumnBorder } from '../base/util';\nimport * as events from '../base/constant';\nimport { RowRenderer } from '../renderer/row-renderer';\nimport { CellRenderer } from '../renderer/cell-renderer';\nimport { Row } from '../models/row';\nimport { Cell } from '../models/cell';\nimport { RowModelGenerator } from '../services/row-model-generator';\nimport { DataUtil } from '@syncfusion/ej2-data';\nimport * as literals from '../base/string-literals';\n/**\n * `BatchEdit` module is used to handle batch editing actions.\n *\n * @hidden\n */\nvar BatchEdit = /** @class */ (function () {\n    function BatchEdit(parent, serviceLocator, renderer) {\n        this.cellDetails = {};\n        this.originalCell = {};\n        this.cloneCell = {};\n        this.editNext = false;\n        this.preventSaveCell = false;\n        this.initialRender = true;\n        this.validationColObj = [];\n        /** @hidden */\n        this.addBatchRow = false;\n        this.prevEditedBatchCell = false;\n        this.parent = parent;\n        this.serviceLocator = serviceLocator;\n        this.renderer = renderer;\n        this.focus = serviceLocator.getService('focus');\n        this.addEventListener();\n    }\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    BatchEdit.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.evtHandlers = [{ event: events.click, handler: this.clickHandler },\n            { event: events.dblclick, handler: this.dblClickHandler },\n            { event: events.beforeCellFocused, handler: this.onBeforeCellFocused },\n            { event: events.cellFocused, handler: this.onCellFocused },\n            { event: events.doubleTap, handler: this.dblClickHandler },\n            { event: events.keyPressed, handler: this.keyDownHandler },\n            { event: events.editNextValCell, handler: this.editNextValCell },\n            { event: events.destroy, handler: this.destroy }];\n        addRemoveEventListener(this.parent, this.evtHandlers, true, this);\n        EventHandler.add(this.parent.element, 'mousedown', this.mouseDownHandler, this);\n        this.dataBoundFunction = this.dataBound.bind(this);\n        this.batchCancelFunction = this.batchCancel.bind(this);\n        this.parent.addEventListener(events.dataBound, this.dataBoundFunction);\n        this.parent.addEventListener(events.batchCancel, this.batchCancelFunction);\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    BatchEdit.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        addRemoveEventListener(this.parent, this.evtHandlers, false);\n        EventHandler.remove(this.parent.element, 'mousedown', this.mouseDownHandler);\n        this.parent.removeEventListener(events.dataBound, this.dataBoundFunction);\n        this.parent.removeEventListener(events.batchCancel, this.batchCancelFunction);\n    };\n    BatchEdit.prototype.batchCancel = function () {\n        this.parent.focusModule.restoreFocus();\n    };\n    BatchEdit.prototype.dataBound = function () {\n        this.parent.notify(events.toolbarRefresh, {});\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    BatchEdit.prototype.destroy = function () {\n        this.removeEventListener();\n    };\n    BatchEdit.prototype.mouseDownHandler = function (e) {\n        if (!isNullOrUndefined(this.parent.element.querySelector('.e-gridform'))) {\n            this.mouseDownElement = e.target;\n        }\n        else {\n            this.mouseDownElement = undefined;\n        }\n    };\n    BatchEdit.prototype.clickHandler = function (e) {\n        if (!parentsUntil(e.target, this.parent.element.id + '_add', true)) {\n            if ((this.parent.isEdit && closest(this.form, 'td') !== closest(e.target, 'td'))\n                && isNullOrUndefined(this.mouseDownElement) || this.mouseDownElement === e.target) {\n                this.saveCell();\n                this.editNextValCell();\n            }\n            if (parentsUntil(e.target, literals.rowCell) && !this.parent.isEdit) {\n                this.setCellIdx(e.target);\n            }\n        }\n    };\n    BatchEdit.prototype.dblClickHandler = function (e) {\n        var target = parentsUntil(e.target, literals.rowCell);\n        var tr = parentsUntil(e.target, literals.row);\n        var rowIndex = tr && parseInt(tr.getAttribute(literals.dataRowIndex), 10);\n        var colIndex = target && parseInt(target.getAttribute(literals.dataColIndex), 10);\n        if (!isNullOrUndefined(target) && !isNullOrUndefined(rowIndex) && !isNaN(colIndex)\n            && !target.parentElement.classList.contains(literals.editedRow) &&\n            this.parent.getColumns()[parseInt(colIndex.toString(), 10)].allowEditing) {\n            this.editCell(rowIndex, this.parent.getColumns()[parseInt(colIndex.toString(), 10)].field, this.isAddRow(rowIndex));\n        }\n    };\n    BatchEdit.prototype.onBeforeCellFocused = function (e) {\n        if (this.parent.isEdit && this.validateFormObj() &&\n            (e.byClick || (['tab', 'shiftTab', 'enter', 'shiftEnter'].indexOf(e.keyArgs.action) > -1))) {\n            e.cancel = true;\n            if (e.byClick) {\n                e.clickArgs.preventDefault();\n            }\n            else {\n                e.keyArgs.preventDefault();\n            }\n        }\n    };\n    BatchEdit.prototype.onCellFocused = function (e) {\n        var clear = (!e.container.isContent || !e.container.isDataCell) && !(this.parent.frozenRows && e.container.isHeader);\n        if (this.parent.focusModule.active) {\n            this.prevEditedBatchCell = this.parent.focusModule.active.matrix.current.toString() === this.prevEditedBatchCellMatrix()\n                .toString();\n            this.crtRowIndex = [].slice.call(this.parent.focusModule.active.getTable().rows).indexOf(closest(e.element, 'tr'));\n        }\n        if (!e.byKey || clear) {\n            if ((this.parent.isEdit && clear)) {\n                this.saveCell();\n            }\n            return;\n        }\n        var _a = e.container.indexes, rowIndex = _a[0], cellIndex = _a[1];\n        var actualIndex = e.element.getAttribute('data-colindex') ? parseInt(e.element.getAttribute('data-colindex'), 10) : cellIndex;\n        if (actualIndex !== cellIndex) {\n            cellIndex = actualIndex;\n        }\n        if (this.parent.frozenRows && e.container.isContent) {\n            rowIndex += ((this.parent.getContent().querySelector('.e-hiddenrow') ? 0 : this.parent.frozenRows) +\n                this.parent.getHeaderContent().querySelectorAll('.e-insertedrow').length);\n        }\n        var isEdit = this.parent.isEdit;\n        if (!this.parent.element.getElementsByClassName('e-popup-open').length) {\n            isEdit = isEdit && !this.validateFormObj();\n            switch (e.keyArgs.action) {\n                case 'tab':\n                case 'shiftTab':\n                    // eslint-disable-next-line no-case-declarations\n                    var indent = this.parent.isRowDragable() && this.parent.isDetail() ? 2 :\n                        this.parent.isRowDragable() || this.parent.isDetail() ? 1 : 0;\n                    // eslint-disable-next-line no-case-declarations\n                    var col = this.parent.getColumns()[cellIndex - indent];\n                    if (col && !this.parent.isEdit) {\n                        this.editCell(rowIndex, col.field);\n                    }\n                    if (isEdit || this.parent.isLastCellPrimaryKey) {\n                        this.editCellFromIndex(rowIndex, cellIndex);\n                    }\n                    break;\n                case 'enter':\n                case 'shiftEnter':\n                    e.keyArgs.preventDefault();\n                    // eslint-disable-next-line no-case-declarations\n                    var args = { cancel: false, keyArgs: e.keyArgs };\n                    this.parent.notify('beforeFocusCellEdit', args);\n                    if (!args.cancel && isEdit) {\n                        this.editCell(rowIndex, this.cellDetails.column.field);\n                    }\n                    break;\n                case 'f2':\n                    this.editCellFromIndex(rowIndex, cellIndex);\n                    this.focus.focus();\n                    break;\n            }\n        }\n    };\n    BatchEdit.prototype.isAddRow = function (index) {\n        return this.parent.getDataRows()[parseInt(index.toString(), 10)].classList.contains('e-insertedrow');\n    };\n    BatchEdit.prototype.editCellFromIndex = function (rowIdx, cellIdx) {\n        this.cellDetails.rowIndex = rowIdx;\n        this.cellDetails.cellIndex = cellIdx;\n        this.editCell(rowIdx, this.parent.getColumns()[parseInt(cellIdx.toString(), 10)].field, this.isAddRow(rowIdx));\n    };\n    BatchEdit.prototype.closeEdit = function () {\n        var gObj = this.parent;\n        var rows = this.parent.getRowsObject();\n        var argument = { cancel: false, batchChanges: this.getBatchChanges() };\n        gObj.notify(events.beforeBatchCancel, argument);\n        if (argument.cancel) {\n            return;\n        }\n        if (gObj.isEdit) {\n            this.saveCell(true);\n        }\n        this.isAdded = false;\n        gObj.clearSelection();\n        for (var i = 0; i < rows.length; i++) {\n            var isInsert = false;\n            var isDirty = rows[parseInt(i.toString(), 10)].isDirty;\n            isInsert = this.removeBatchElementChanges(rows[parseInt(i.toString(), 10)], isDirty);\n            if (isInsert) {\n                rows.splice(i, 1);\n            }\n            if (isInsert) {\n                i--;\n            }\n        }\n        if (!gObj.getContentTable().querySelector('tr.e-row')) {\n            gObj.renderModule.renderEmptyRow();\n        }\n        var args = {\n            requestType: 'batchCancel', rows: this.parent.getRowsObject()\n        };\n        gObj.notify(events.batchCancel, {\n            rows: this.parent.getRowsObject().length ? this.parent.getRowsObject() :\n                [new Row({ isDataRow: true, cells: [new Cell({ isDataCell: true, visible: true })] })]\n        });\n        gObj.selectRow(this.cellDetails.rowIndex);\n        this.refreshRowIdx();\n        gObj.notify(events.toolbarRefresh, {});\n        this.parent.notify(events.tooltipDestroy, {});\n        args = { requestType: 'batchCancel', rows: this.parent.getRowsObject() };\n        gObj.trigger(events.batchCancel, args);\n    };\n    BatchEdit.prototype.removeBatchElementChanges = function (row, isDirty) {\n        var gObj = this.parent;\n        var rowRenderer = new RowRenderer(this.serviceLocator, null, this.parent);\n        var isInstertedRemoved = false;\n        if (isDirty) {\n            row.isDirty = isDirty;\n            var tr = gObj.getRowElementByUID(row.uid);\n            if (tr) {\n                if (tr.classList.contains('e-insertedrow')) {\n                    remove(tr);\n                    isInstertedRemoved = true;\n                }\n                else {\n                    refreshForeignData(row, this.parent.getForeignKeyColumns(), row.data);\n                    delete row.changes;\n                    delete row.edit;\n                    row.isDirty = false;\n                    classList(tr, [], ['e-hiddenrow', 'e-updatedtd']);\n                    rowRenderer.refresh(row, gObj.getColumns(), false);\n                }\n                if (this.parent.aggregates.length > 0) {\n                    var type = 'type';\n                    var editType = [];\n                    editType[\"\" + type] = 'cancel';\n                    this.parent.notify(events.refreshFooterRenderer, editType);\n                    if (this.parent.groupSettings.columns.length > 0) {\n                        this.parent.notify(events.groupAggregates, editType);\n                    }\n                }\n            }\n        }\n        return isInstertedRemoved;\n    };\n    BatchEdit.prototype.deleteRecord = function (fieldname, data) {\n        this.saveCell();\n        if (this.validateFormObj()) {\n            this.saveCell(true);\n        }\n        this.isAdded = false;\n        this.bulkDelete(fieldname, data);\n        if (this.parent.aggregates.length > 0) {\n            if (!(this.parent.isReact || this.parent.isVue)) {\n                this.parent.notify(events.refreshFooterRenderer, {});\n            }\n            if (this.parent.groupSettings.columns.length > 0) {\n                this.parent.notify(events.groupAggregates, {});\n            }\n            if (this.parent.isReact || this.parent.isVue) {\n                this.parent.notify(events.refreshFooterRenderer, {});\n            }\n        }\n    };\n    BatchEdit.prototype.addRecord = function (data) {\n        this.bulkAddRow(data);\n    };\n    BatchEdit.prototype.endEdit = function () {\n        if (this.parent.isEdit && this.validateFormObj()) {\n            return;\n        }\n        this.batchSave();\n    };\n    BatchEdit.prototype.validateFormObj = function () {\n        return this.parent.editModule.formObj && !this.parent.editModule.formObj.validate();\n    };\n    BatchEdit.prototype.batchSave = function () {\n        var gObj = this.parent;\n        var deletedRecords = 'deletedRecords';\n        if (gObj.isCheckBoxSelection) {\n            var checkAllBox = gObj.element.querySelector('.e-checkselectall').parentElement;\n            if (checkAllBox.classList.contains('e-checkbox-disabled') &&\n                gObj.pageSettings.totalRecordsCount > gObj.currentViewData.length) {\n                removeClass([checkAllBox], ['e-checkbox-disabled']);\n            }\n        }\n        this.saveCell();\n        if (gObj.isEdit || this.editNextValCell() || gObj.isEdit) {\n            return;\n        }\n        var changes = this.getBatchChanges();\n        if (this.parent.selectionSettings.type === 'Multiple' && changes[\"\" + deletedRecords].length &&\n            this.parent.selectionSettings.persistSelection) {\n            changes[\"\" + deletedRecords] = this.removeSelectedData;\n            this.removeSelectedData = [];\n        }\n        var original = {\n            changedRecords: this.parent.getRowsObject()\n                .filter(function (row) { return row.isDirty && ['add', 'delete'].indexOf(row.edit) === -1; })\n                .map(function (row) { return row.data; })\n        };\n        var args = { batchChanges: changes, cancel: false };\n        gObj.trigger(events.beforeBatchSave, args, function (beforeBatchSaveArgs) {\n            if (beforeBatchSaveArgs.cancel) {\n                return;\n            }\n            gObj.showSpinner();\n            gObj.notify(events.bulkSave, { changes: changes, original: original });\n        });\n    };\n    BatchEdit.prototype.getBatchChanges = function () {\n        var changes = {\n            addedRecords: [],\n            deletedRecords: [],\n            changedRecords: []\n        };\n        var rows = this.parent.getRowsObject();\n        for (var _i = 0, rows_1 = rows; _i < rows_1.length; _i++) {\n            var row = rows_1[_i];\n            if (row.isDirty) {\n                switch (row.edit) {\n                    case 'add':\n                        changes.addedRecords.push(row.changes);\n                        break;\n                    case 'delete':\n                        changes.deletedRecords.push(row.data);\n                        break;\n                    default:\n                        changes.changedRecords.push(row.changes);\n                }\n            }\n        }\n        return changes;\n    };\n    /**\n     * @param {string} uid - specifes the uid\n     * @returns {void}\n     * @hidden\n     */\n    BatchEdit.prototype.removeRowObjectFromUID = function (uid) {\n        var rows = this.parent.getRowsObject();\n        var i = 0;\n        for (var len = rows.length; i < len; i++) {\n            if (rows[parseInt(i.toString(), 10)].uid === uid) {\n                break;\n            }\n        }\n        rows.splice(i, 1);\n    };\n    /**\n     * @param {Row<Column>} row - specifies the row object\n     * @returns {void}\n     * @hidden\n     */\n    BatchEdit.prototype.addRowObject = function (row) {\n        var gObj = this.parent;\n        var isTop = gObj.editSettings.newRowPosition === 'Top';\n        var rowClone = row.clone();\n        if (isTop) {\n            gObj.getRowsObject().unshift(rowClone);\n        }\n        else {\n            gObj.getRowsObject().push(rowClone);\n        }\n    };\n    // tslint:disable-next-line:max-func-body-length\n    BatchEdit.prototype.bulkDelete = function (fieldname, data) {\n        var _this = this;\n        this.removeSelectedData = [];\n        var gObj = this.parent;\n        var index = gObj.selectedRowIndex;\n        var selectedRows = gObj.getSelectedRows();\n        var args = {\n            primaryKey: this.parent.getPrimaryKeyFieldNames(),\n            rowIndex: index,\n            rowData: data ? data : gObj.getSelectedRecords(),\n            cancel: false\n        };\n        if (data) {\n            args.row = gObj.editModule.deleteRowUid ? gObj.getRowElementByUID(gObj.editModule.deleteRowUid)\n                : gObj.getRows()[gObj.getCurrentViewRecords().indexOf(data)];\n        }\n        else {\n            args.row = selectedRows;\n        }\n        if (!args.row) {\n            return;\n        }\n        // tslint:disable-next-line:max-func-body-length\n        gObj.trigger(events.beforeBatchDelete, args, function (beforeBatchDeleteArgs) {\n            if (beforeBatchDeleteArgs.cancel) {\n                return;\n            }\n            _this.removeSelectedData = gObj.getSelectedRecords();\n            gObj.clearSelection();\n            beforeBatchDeleteArgs.row = beforeBatchDeleteArgs.row ?\n                beforeBatchDeleteArgs.row : data ? gObj.getRows()[parseInt(index.toString(), 10)] :\n                selectedRows;\n            if (selectedRows.length === 1 || data) {\n                if (Array.isArray(beforeBatchDeleteArgs.row)) {\n                    beforeBatchDeleteArgs.row = beforeBatchDeleteArgs.row[0];\n                }\n                var uid = beforeBatchDeleteArgs.row.getAttribute('data-uid');\n                uid = data && _this.parent.editModule.deleteRowUid ? uid = _this.parent.editModule.deleteRowUid : uid;\n                if (beforeBatchDeleteArgs.row.classList.contains('e-insertedrow')) {\n                    _this.removeRowObjectFromUID(uid);\n                    remove(beforeBatchDeleteArgs.row);\n                }\n                else {\n                    var rowObj = gObj.getRowObjectFromUID(uid);\n                    rowObj.isDirty = true;\n                    rowObj.edit = 'delete';\n                    classList(beforeBatchDeleteArgs.row, ['e-hiddenrow', 'e-updatedtd'], []);\n                    if (gObj.frozenRows && index < gObj.frozenRows && gObj.getDataRows().length >= gObj.frozenRows) {\n                        gObj.getHeaderTable().querySelector(literals.tbody).appendChild(gObj.getRowByIndex(gObj.frozenRows - 1));\n                    }\n                }\n                delete beforeBatchDeleteArgs.row;\n            }\n            else {\n                if (data) {\n                    index = parseInt(beforeBatchDeleteArgs.row.getAttribute(literals.dataRowIndex), 10);\n                }\n                for (var i = 0; i < selectedRows.length; i++) {\n                    var uniqueid = selectedRows[parseInt(i.toString(), 10)].getAttribute('data-uid');\n                    if (selectedRows[parseInt(i.toString(), 10)].classList.contains('e-insertedrow')) {\n                        _this.removeRowObjectFromUID(uniqueid);\n                        remove(selectedRows[parseInt(i.toString(), 10)]);\n                    }\n                    else {\n                        classList(selectedRows[parseInt(i.toString(), 10)], ['e-hiddenrow', 'e-updatedtd'], []);\n                        var selectedRow = gObj.getRowObjectFromUID(uniqueid);\n                        selectedRow.isDirty = true;\n                        selectedRow.edit = 'delete';\n                        if (gObj.frozenRows && index < gObj.frozenRows && gObj.getDataRows().length >= gObj.frozenRows) {\n                            gObj.getHeaderTable().querySelector(literals.tbody).appendChild(gObj.getRowByIndex(gObj.frozenRows - 1));\n                        }\n                    }\n                }\n                delete beforeBatchDeleteArgs.row;\n            }\n            _this.refreshRowIdx();\n            if (data) {\n                gObj.editModule.deleteRowUid = undefined;\n            }\n            if (!gObj.isCheckBoxSelection) {\n                gObj.selectRow(index);\n            }\n            gObj.trigger(events.batchDelete, beforeBatchDeleteArgs);\n            gObj.notify(events.batchDelete, { rows: _this.parent.getRowsObject() });\n            gObj.notify(events.toolbarRefresh, {});\n            if (!gObj.getContentTable().querySelector('tr.e-row')) {\n                gObj.renderModule.renderEmptyRow();\n            }\n        });\n    };\n    BatchEdit.prototype.refreshRowIdx = function () {\n        var gObj = this.parent;\n        var rows = gObj.getAllDataRows(true);\n        var dataObjects = gObj.getRowsObject().filter(function (row) { return !row.isDetailRow; });\n        for (var i = 0, j = 0, len = rows.length; i < len; i++) {\n            if (rows[parseInt(i.toString(), 10)].classList.contains(literals.row) && !rows[parseInt(i.toString(), 10)].classList.contains('e-hiddenrow')) {\n                rows[parseInt(i.toString(), 10)].setAttribute(literals.dataRowIndex, j.toString());\n                rows[parseInt(i.toString(), 10)].setAttribute(literals.ariaRowIndex, (j + 1).toString());\n                dataObjects[parseInt(i.toString(), 10)].index = j;\n                j++;\n            }\n            else {\n                rows[parseInt(i.toString(), 10)].removeAttribute(literals.dataRowIndex);\n                rows[parseInt(i.toString(), 10)].removeAttribute(literals.ariaRowIndex);\n                dataObjects[parseInt(i.toString(), 10)].index = -1;\n            }\n        }\n    };\n    BatchEdit.prototype.bulkAddRow = function (data) {\n        var _this = this;\n        var gObj = this.parent;\n        if (!gObj.editSettings.allowAdding) {\n            if (gObj.isEdit) {\n                this.saveCell();\n            }\n            return;\n        }\n        if (gObj.isEdit) {\n            this.saveCell();\n            this.parent.notify(events.editNextValCell, {});\n        }\n        if (this.validateFormObj()) {\n            return;\n        }\n        if (this.initialRender) {\n            var visibleColumns = gObj.getVisibleColumns();\n            for (var i = 0; i < visibleColumns.length; i++) {\n                if (visibleColumns[parseInt(i.toString(), 10)].validationRules &&\n                    visibleColumns[parseInt(i.toString(), 10)].validationRules['required']) {\n                    var obj = { field: (visibleColumns[parseInt(i.toString(), 10)]['field']).slice(), cellIdx: i };\n                    this.validationColObj.push(obj);\n                }\n            }\n            this.initialRender = false;\n        }\n        this.parent.element.classList.add('e-editing');\n        var defaultData = data ? data : this.getDefaultData();\n        var args = {\n            defaultData: defaultData,\n            primaryKey: gObj.getPrimaryKeyFieldNames(),\n            cancel: false\n        };\n        gObj.trigger(events.beforeBatchAdd, args, function (beforeBatchAddArgs) {\n            if (beforeBatchAddArgs.cancel) {\n                return;\n            }\n            _this.isAdded = true;\n            gObj.clearSelection();\n            var row = new RowRenderer(_this.serviceLocator, null, _this.parent);\n            var model = new RowModelGenerator(_this.parent);\n            var modelData = model.generateRows([beforeBatchAddArgs.defaultData]);\n            var tr = row.render(modelData[0], gObj.getColumns());\n            addFixedColumnBorder(tr);\n            var col;\n            var index;\n            for (var i = 0; i < _this.parent.groupSettings.columns.length; i++) {\n                tr.insertBefore(_this.parent.createElement('td', { className: 'e-indentcell' }), tr.firstChild);\n                modelData[0].cells.unshift(new Cell({ cellType: CellType.Indent }));\n            }\n            var tbody = gObj.getContentTable().querySelector(literals.tbody);\n            tr.classList.add('e-insertedrow');\n            if (tbody.querySelector('.e-emptyrow')) {\n                var emptyRow = tbody.querySelector('.e-emptyrow');\n                emptyRow.parentNode.removeChild(emptyRow);\n                if (gObj.frozenRows && gObj.element.querySelector('.e-frozenrow-empty')) {\n                    gObj.element.querySelector('.e-frozenrow-empty').classList.remove('e-frozenrow-empty');\n                }\n            }\n            if (gObj.frozenRows && gObj.editSettings.newRowPosition === 'Top') {\n                tbody = gObj.getHeaderTable().querySelector(literals.tbody);\n            }\n            else {\n                tbody = gObj.getContentTable().querySelector(literals.tbody);\n            }\n            if (_this.parent.editSettings.newRowPosition === 'Top') {\n                tbody.insertBefore(tr, tbody.firstChild);\n            }\n            else {\n                tbody.appendChild(tr);\n            }\n            addClass([].slice.call(tr.getElementsByClassName(literals.rowCell)), ['e-updatedtd']);\n            modelData[0].isDirty = true;\n            modelData[0].changes = extend({}, {}, modelData[0].data, true);\n            modelData[0].edit = 'add';\n            _this.addRowObject(modelData[0]);\n            _this.refreshRowIdx();\n            _this.focus.forgetPrevious();\n            gObj.notify(events.batchAdd, { rows: _this.parent.getRowsObject() });\n            var changes = _this.getBatchChanges();\n            var btmIdx = _this.getBottomIndex();\n            if (_this.parent.editSettings.newRowPosition === 'Top') {\n                gObj.selectRow(0);\n            }\n            else {\n                gObj.selectRow(btmIdx);\n            }\n            if (!data) {\n                index = _this.findNextEditableCell(0, true);\n                col = gObj.getColumns()[parseInt(index.toString(), 10)];\n                if (_this.parent.editSettings.newRowPosition === 'Top') {\n                    _this.editCell(0, col.field, true);\n                }\n                else {\n                    _this.editCell(btmIdx, col.field, true);\n                }\n            }\n            if (_this.parent.aggregates.length > 0 && (data || changes[literals.addedRecords].length)) {\n                _this.parent.notify(events.refreshFooterRenderer, {});\n            }\n            var args1 = {\n                defaultData: beforeBatchAddArgs.defaultData, row: tr,\n                columnObject: col, columnIndex: index, primaryKey: beforeBatchAddArgs.primaryKey,\n                cell: !isNullOrUndefined(index) ? tr.cells[parseInt(index.toString(), 10)] : undefined\n            };\n            gObj.trigger(events.batchAdd, args1);\n        });\n    };\n    BatchEdit.prototype.findNextEditableCell = function (columnIndex, isAdd, isValOnly) {\n        var cols = this.parent.getColumns();\n        var endIndex = cols.length;\n        var validation;\n        for (var i = columnIndex; i < endIndex; i++) {\n            validation = isValOnly ? isNullOrUndefined(cols[parseInt(i.toString(), 10)].validationRules) : false;\n            // if (!isAdd && this.checkNPCell(cols[parseInt(i.toString(), 10)])) {\n            //     return i;\n            // } else\n            if (isAdd && (!cols[parseInt(i.toString(), 10)].template || cols[parseInt(i.toString(), 10)].field)\n                && cols[parseInt(i.toString(), 10)].allowEditing && cols[parseInt(i.toString(), 10)].visible &&\n                !(cols[parseInt(i.toString(), 10)].isIdentity && cols[parseInt(i.toString(), 10)].isPrimaryKey) && !validation) {\n                return i;\n            }\n        }\n        return -1;\n    };\n    BatchEdit.prototype.getDefaultData = function () {\n        var gObj = this.parent;\n        var data = {};\n        var dValues = { 'number': 0, 'string': null, 'boolean': false, 'date': null, 'datetime': null, 'dateonly': null };\n        for (var _i = 0, _a = (gObj.columnModel); _i < _a.length; _i++) {\n            var col = _a[_i];\n            if (col.field) {\n                setValue(col.field, Object.keys(col).indexOf('defaultValue') >= 0 ? col.defaultValue : dValues[col.type], data);\n            }\n        }\n        return data;\n    };\n    BatchEdit.prototype.setCellIdx = function (target) {\n        var gLen = 0;\n        if (this.parent.allowGrouping) {\n            gLen = this.parent.groupSettings.columns.length;\n        }\n        this.cellDetails.cellIndex = target.cellIndex - gLen;\n        this.cellDetails.rowIndex = parseInt(target.getAttribute('index'), 10);\n    };\n    BatchEdit.prototype.editCell = function (index, field, isAdd) {\n        var gObj = this.parent;\n        var col = gObj.getColumnByField(field);\n        this.index = index;\n        this.field = field;\n        this.isAdd = isAdd;\n        var checkEdit = gObj.isEdit && !(this.cellDetails.column.field === field\n            && (this.cellDetails.rowIndex === index && this.parent.getDataRows().length - 1 !== index && this.prevEditedBatchCell));\n        if (gObj.editSettings.allowEditing) {\n            if (!checkEdit && (col.allowEditing || (!col.allowEditing && gObj.focusModule.active\n                && gObj.focusModule.active.getTable().rows[this.crtRowIndex]\n                && gObj.focusModule.active.getTable().rows[this.crtRowIndex].classList.contains('e-insertedrow')))) {\n                this.editCellExtend(index, field, isAdd);\n            }\n            else if (checkEdit) {\n                this.editNext = true;\n                this.saveCell();\n            }\n        }\n    };\n    BatchEdit.prototype.editCellExtend = function (index, field, isAdd) {\n        var _this = this;\n        var gObj = this.parent;\n        var col = gObj.getColumnByField(field);\n        var keys = gObj.getPrimaryKeyFieldNames();\n        if (gObj.isEdit) {\n            return;\n        }\n        var rowData = extend({}, {}, this.getDataByIndex(index), true);\n        var row = gObj.getDataRows()[parseInt(index.toString(), 10)];\n        rowData = extend({}, {}, this.getDataByIndex(index), true);\n        if ((keys[0] === col.field && !row.classList.contains('e-insertedrow')) || col.columns ||\n            (col.isPrimaryKey && col.isIdentity) || col.commands) {\n            this.parent.isLastCellPrimaryKey = true;\n            return;\n        }\n        this.parent.isLastCellPrimaryKey = false;\n        this.parent.element.classList.add('e-editing');\n        var rowObj = gObj.getRowObjectFromUID(row.getAttribute('data-uid'));\n        var cells = [].slice.apply(row.cells);\n        var args = {\n            columnName: col.field, isForeignKey: !isNullOrUndefined(col.foreignKeyValue),\n            primaryKey: keys, rowData: rowData,\n            validationRules: extend({}, col.validationRules ? col.validationRules : {}),\n            value: getObject(col.field, rowData),\n            type: !isAdd ? 'edit' : 'add', cancel: false,\n            foreignKeyData: rowObj && rowObj.foreignKeyData\n        };\n        args.cell = cells[this.getColIndex(cells, this.getCellIdx(col.uid))];\n        args.row = row;\n        args.columnObject = col;\n        if (!args.cell) {\n            return;\n        }\n        gObj.trigger(events.cellEdit, args, function (cellEditArgs) {\n            if (cellEditArgs.cancel) {\n                return;\n            }\n            cellEditArgs.cell = cellEditArgs.cell ? cellEditArgs.cell : cells[_this.getColIndex(cells, _this.getCellIdx(col.uid))];\n            cellEditArgs.row = cellEditArgs.row ? cellEditArgs.row : row;\n            cellEditArgs.columnObject = cellEditArgs.columnObject ? cellEditArgs.columnObject : col;\n            // cellEditArgs.columnObject.index = isNullOrUndefined(cellEditArgs.columnObject.index) ? 0 : cellEditArgs.columnObject.index;\n            _this.cellDetails = {\n                rowData: rowData, column: col, value: cellEditArgs.value, isForeignKey: cellEditArgs.isForeignKey, rowIndex: index,\n                cellIndex: parseInt(cellEditArgs.cell.getAttribute(literals.dataColIndex), 10),\n                foreignKeyData: cellEditArgs.foreignKeyData\n            };\n            if (cellEditArgs.cell.classList.contains('e-updatedtd')) {\n                _this.isColored = true;\n                cellEditArgs.cell.classList.remove('e-updatedtd');\n            }\n            gObj.isEdit = true;\n            gObj.clearSelection();\n            if (!gObj.isCheckBoxSelection || !gObj.isPersistSelection) {\n                gObj.selectRow(_this.cellDetails.rowIndex, true);\n            }\n            _this.renderer.update(cellEditArgs);\n            _this.parent.notify(events.batchEditFormRendered, cellEditArgs);\n            _this.form = select('#' + gObj.element.id + 'EditForm', gObj.element);\n            gObj.editModule.applyFormValidation([col]);\n            _this.parent.element.querySelector('.e-gridpopup').style.display = 'none';\n        });\n    };\n    BatchEdit.prototype.updateCell = function (rowIndex, field, value) {\n        var gObj = this.parent;\n        var col = gObj.getColumnByField(field);\n        var index = gObj.getColumnIndexByField(field);\n        var isInsertedBatchRow = gObj.getRowByIndex(rowIndex).classList.contains('e-insertedrow') &&\n            gObj.getRowByIndex(rowIndex).classList.contains('e-batchrow');\n        if (col && (!col.isPrimaryKey || isInsertedBatchRow) && col.allowEditing) {\n            var td_1 = this.parent.isSpan ? getCellFromRow(gObj, rowIndex, index) :\n                getCellByColAndRowIndex(this.parent, col, rowIndex, index);\n            if (this.parent.isSpan && !td_1) {\n                return;\n            }\n            var rowObj_1 = gObj.getRowObjectFromUID(td_1.parentElement.getAttribute('data-uid'));\n            if (gObj.isEdit ||\n                (!rowObj_1.changes && ((!(value instanceof Date) && rowObj_1.data['' + field] !== value) ||\n                    ((value instanceof Date) && new Date(rowObj_1.data['' + field]).toString() !== new Date(value).toString()))) ||\n                (rowObj_1.changes && ((!(value instanceof Date) && rowObj_1.changes['' + field] !== value) ||\n                    ((value instanceof Date) && new Date(rowObj_1.changes['' + field]).toString() !== new Date(value).toString())))) {\n                this.refreshTD(td_1, col, rowObj_1, value);\n                var isReactChild = this.parent.parentDetails && this.parent.parentDetails.parentInstObj &&\n                    this.parent.parentDetails.parentInstObj.isReact;\n                if (((this.parent.isReact && this.parent.requireTemplateRef) || (isReactChild &&\n                    this.parent.parentDetails.parentInstObj.requireTemplateRef)) && col.template) {\n                    // eslint-disable-next-line @typescript-eslint/no-this-alias\n                    var thisRef_1 = this;\n                    var newReactTd_1 = this.newReactTd;\n                    thisRef_1.parent.renderTemplates(function () {\n                        thisRef_1.parent.trigger(events.queryCellInfo, {\n                            cell: newReactTd_1 || td_1, column: col, data: rowObj_1.changes\n                        });\n                    });\n                }\n                else if ((this.parent.isReact || isReactChild) && col.template) {\n                    this.parent.renderTemplates();\n                    this.parent.trigger(events.queryCellInfo, {\n                        cell: this.newReactTd || td_1, column: col, data: rowObj_1.changes\n                    });\n                }\n                else {\n                    this.parent.trigger(events.queryCellInfo, {\n                        cell: this.newReactTd || td_1, column: col, data: rowObj_1.changes\n                    });\n                }\n            }\n        }\n    };\n    BatchEdit.prototype.setChanges = function (rowObj, field, value) {\n        if (!rowObj.changes) {\n            rowObj.changes = extend({}, {}, rowObj.data, true);\n        }\n        if (!isNullOrUndefined(field)) {\n            if (typeof value === 'string') {\n                value = this.parent.sanitize(value);\n            }\n            DataUtil.setValue(field, value, rowObj.changes);\n        }\n        if (rowObj.data[\"\" + field] !== value) {\n            var type = this.parent.getColumnByField(field).type;\n            if ((type === 'date' || type === 'datetime')) {\n                if (new Date(rowObj.data[\"\" + field]).toString() !== new Date(value).toString()) {\n                    rowObj.isDirty = true;\n                }\n            }\n            else {\n                rowObj.isDirty = true;\n            }\n        }\n    };\n    BatchEdit.prototype.updateRow = function (index, data) {\n        var keys = Object.keys(data);\n        for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n            var col = keys_1[_i];\n            this.updateCell(index, col, data[\"\" + col]);\n        }\n    };\n    BatchEdit.prototype.getCellIdx = function (uid) {\n        var cIdx = this.parent.getColumnIndexByUid(uid) + this.parent.groupSettings.columns.length;\n        if (!isNullOrUndefined(this.parent.detailTemplate) || !isNullOrUndefined(this.parent.childGrid)) {\n            cIdx++;\n        }\n        if (this.parent.isRowDragable()) {\n            cIdx++;\n        }\n        return cIdx;\n    };\n    BatchEdit.prototype.refreshTD = function (td, column, rowObj, value) {\n        var cell = new CellRenderer(this.parent, this.serviceLocator);\n        value = column.type === 'number' && !isNullOrUndefined(value) ? parseFloat(value) : value;\n        if (rowObj) {\n            this.setChanges(rowObj, column.field, value);\n            refreshForeignData(rowObj, this.parent.getForeignKeyColumns(), rowObj.changes);\n        }\n        var rowcell = rowObj ? rowObj.cells : undefined;\n        var parentElement;\n        var cellIndex;\n        if (this.parent.isReact) {\n            parentElement = td.parentElement;\n            cellIndex = td.cellIndex;\n        }\n        var index = 0;\n        if (rowObj) {\n            cell.refreshTD(td, rowcell[this.getCellIdx(column.uid) - index], rowObj.changes, { 'index': this.getCellIdx(column.uid) });\n        }\n        if (this.parent.isReact) {\n            this.newReactTd = parentElement.cells[parseInt(cellIndex.toString(), 10)];\n            parentElement.cells[parseInt(cellIndex.toString(), 10)].classList.add('e-updatedtd');\n        }\n        else {\n            td.classList.add('e-updatedtd');\n        }\n        td.classList.add('e-updatedtd');\n        this.parent.notify(events.toolbarRefresh, {});\n    };\n    BatchEdit.prototype.getColIndex = function (cells, index) {\n        var cIdx = 0;\n        if (this.parent.allowGrouping && this.parent.groupSettings.columns) {\n            cIdx = this.parent.groupSettings.columns.length;\n        }\n        if (!isNullOrUndefined(this.parent.detailTemplate) || !isNullOrUndefined(this.parent.childGrid)) {\n            cIdx++;\n        }\n        if (this.parent.isRowDragable()) {\n            cIdx++;\n        }\n        for (var m = 0; m < cells.length; m++) {\n            var colIndex = parseInt(cells[parseInt(m.toString(), 10)].getAttribute(literals.dataColIndex), 10);\n            if (colIndex === index - cIdx) {\n                return m;\n            }\n        }\n        return -1;\n    };\n    BatchEdit.prototype.editNextValCell = function () {\n        var gObj = this.parent;\n        var insertedRows = gObj.element.querySelectorAll('.e-insertedrow');\n        var isSingleInsert = insertedRows.length === 1 ? true : false;\n        if (isSingleInsert && this.isAdded && !gObj.isEdit) {\n            var btmIdx = this.getBottomIndex();\n            for (var i = this.cellDetails.cellIndex; i < gObj.getColumns().length; i++) {\n                if (gObj.isEdit) {\n                    return;\n                }\n                var index = this.findNextEditableCell(this.cellDetails.cellIndex + 1, true, true);\n                var col = gObj.getColumns()[parseInt(index.toString(), 10)];\n                if (col) {\n                    if (this.parent.editSettings.newRowPosition === 'Bottom') {\n                        this.editCell(btmIdx, col.field, true);\n                    }\n                    else {\n                        var args = { index: 0, column: col };\n                        this.parent.notify(events.nextCellIndex, args);\n                        this.editCell(args.index, col.field, true);\n                    }\n                    this.saveCell();\n                }\n            }\n            if (!gObj.isEdit) {\n                this.isAdded = false;\n            }\n        }\n        else if (!isSingleInsert && this.isAdded && !gObj.isEdit) {\n            for (var i = 0; i < insertedRows.length; i++) {\n                if (!gObj.isEdit) {\n                    for (var j = 0; j < this.validationColObj.length; j++) {\n                        if (gObj.isEdit) {\n                            break;\n                        }\n                        else if (insertedRows[parseInt(i.toString(), 10)].querySelectorAll('td:not(.e-hide)')[this.validationColObj[parseInt(j.toString(), 10)].cellIdx].innerHTML === '') {\n                            this.editCell(parseInt(insertedRows[parseInt(i.toString(), 10)].getAttribute('data-rowindex'), 10), this.validationColObj[parseInt(j.toString(), 10)].field);\n                            if (this.validateFormObj()) {\n                                this.saveCell();\n                            }\n                        }\n                    }\n                }\n                else {\n                    break;\n                }\n            }\n            if (!gObj.isEdit) {\n                this.isAdded = false;\n            }\n        }\n    };\n    BatchEdit.prototype.escapeCellEdit = function () {\n        var args = this.generateCellArgs();\n        args.value = args.previousValue;\n        if (args.value || !this.cellDetails.column.validationRules) {\n            this.successCallBack(args, args.cell.parentElement, args.column, true)(args);\n        }\n    };\n    BatchEdit.prototype.generateCellArgs = function () {\n        var gObj = this.parent;\n        this.parent.element.classList.remove('e-editing');\n        var column = this.cellDetails.column;\n        var obj = {};\n        obj[column.field] = getObject(column.field, this.cellDetails.rowData);\n        var editedData = gObj.editModule.getCurrentEditedData(this.form, obj);\n        var cloneEditedData = extend({}, editedData);\n        editedData = extend({}, editedData, this.cellDetails.rowData);\n        var value = getObject(column.field, cloneEditedData);\n        if (!isNullOrUndefined(column.field) && !isUndefined(value)) {\n            setValue(column.field, value, editedData);\n        }\n        var args = {\n            columnName: column.field,\n            value: getObject(column.field, editedData),\n            rowData: this.cellDetails.rowData,\n            column: column,\n            previousValue: this.cellDetails.value,\n            isForeignKey: this.cellDetails.isForeignKey,\n            cancel: false\n        };\n        args.cell = this.form.parentElement;\n        args.columnObject = column;\n        return args;\n    };\n    BatchEdit.prototype.saveCell = function (isForceSave) {\n        if (this.preventSaveCell || !this.form) {\n            return;\n        }\n        var gObj = this.parent;\n        if (!isForceSave && (!gObj.isEdit || this.validateFormObj())) {\n            return;\n        }\n        this.preventSaveCell = true;\n        var args = this.generateCellArgs();\n        var tr = args.cell.parentElement;\n        var col = args.column;\n        args.cell.removeAttribute('aria-label');\n        if (!isForceSave) {\n            gObj.trigger(events.cellSave, args, this.successCallBack(args, tr, col));\n            gObj.notify(events.batchForm, { formObj: this.form });\n        }\n        else {\n            this.successCallBack(args, tr, col)(args);\n        }\n    };\n    BatchEdit.prototype.successCallBack = function (cellSaveArgs, tr, column, isEscapeCellEdit) {\n        var _this = this;\n        return function (cellSaveArgs) {\n            var gObj = _this.parent;\n            cellSaveArgs.cell = cellSaveArgs.cell ? cellSaveArgs.cell : _this.form.parentElement;\n            cellSaveArgs.columnObject = cellSaveArgs.columnObject ? cellSaveArgs.columnObject : column;\n            // cellSaveArgs.columnObject.index = isNullOrUndefined(cellSaveArgs.columnObject.index) ? 0 : cellSaveArgs.columnObject.index;\n            if (cellSaveArgs.cancel) {\n                _this.preventSaveCell = false;\n                if (_this.editNext) {\n                    _this.editNext = false;\n                    if (_this.cellDetails.rowIndex === _this.index && _this.cellDetails.column.field === _this.field) {\n                        return;\n                    }\n                    _this.editCellExtend(_this.index, _this.field, _this.isAdd);\n                }\n                return;\n            }\n            gObj.editModule.destroyWidgets([column]);\n            gObj.isEdit = false;\n            gObj.editModule.destroyForm();\n            _this.parent.notify(events.tooltipDestroy, {});\n            var rowObj = gObj.getRowObjectFromUID(tr.getAttribute('data-uid'));\n            _this.refreshTD(cellSaveArgs.cell, column, rowObj, cellSaveArgs.value);\n            if (_this.parent.isReact) {\n                cellSaveArgs.cell = _this.newReactTd;\n            }\n            removeClass([tr], [literals.editedRow, 'e-batchrow']);\n            removeClass([cellSaveArgs.cell], ['e-editedbatchcell', 'e-boolcell']);\n            if (!isNullOrUndefined(cellSaveArgs.value) && cellSaveArgs.value.toString() ===\n                (!isNullOrUndefined(_this.cellDetails.value) ? _this.cellDetails.value : '').toString() && !_this.isColored\n                || (isNullOrUndefined(cellSaveArgs.value) && isNullOrUndefined(rowObj.data[column.field]) &&\n                    isNullOrUndefined(_this.cellDetails.value) && !cellSaveArgs.cell.parentElement.classList.contains('e-insertedrow'))) {\n                cellSaveArgs.cell.classList.remove('e-updatedtd');\n            }\n            if (isNullOrUndefined(isEscapeCellEdit)) {\n                var isReactCompiler = gObj.isReact && column.template && typeof (column.template) !== 'string';\n                var isReactChild = gObj.parentDetails && gObj.parentDetails.parentInstObj\n                    && gObj.parentDetails.parentInstObj.isReact;\n                if (isReactCompiler || isReactChild) {\n                    if (gObj.requireTemplateRef) {\n                        gObj.renderTemplates(function () {\n                            gObj.trigger(events.cellSaved, cellSaveArgs);\n                        });\n                    }\n                    else {\n                        gObj.renderTemplates();\n                        gObj.trigger(events.cellSaved, cellSaveArgs);\n                    }\n                }\n                else {\n                    gObj.trigger(events.cellSaved, cellSaveArgs);\n                }\n            }\n            gObj.notify(events.toolbarRefresh, {});\n            _this.isColored = false;\n            if (_this.parent.aggregates.length > 0) {\n                if (!(_this.parent.isReact || _this.parent.isVue)) {\n                    _this.parent.notify(events.refreshFooterRenderer, {});\n                }\n                if (_this.parent.groupSettings.columns.length > 0 && !_this.isAddRow(_this.cellDetails.rowIndex)) {\n                    _this.parent.notify(events.groupAggregates, {});\n                }\n                if (_this.parent.isReact || _this.parent.isVue) {\n                    _this.parent.notify(events.refreshFooterRenderer, {});\n                }\n            }\n            _this.preventSaveCell = false;\n            if (_this.editNext) {\n                _this.editNext = false;\n                if (_this.cellDetails.rowIndex === _this.index && _this.cellDetails.column.field === _this.field && _this.prevEditedBatchCell) {\n                    return;\n                }\n                var col = gObj.getColumnByField(_this.field);\n                if (col && (col.allowEditing || (!col.allowEditing && gObj.focusModule.active\n                    && gObj.focusModule.active.getTable().rows[_this.crtRowIndex]\n                    && gObj.focusModule.active.getTable().rows[_this.crtRowIndex].classList.contains('e-insertedrow')))) {\n                    _this.editCellExtend(_this.index, _this.field, _this.isAdd);\n                }\n            }\n            if (isEscapeCellEdit) {\n                gObj.notify(events.restoreFocus, {});\n            }\n        };\n    };\n    BatchEdit.prototype.prevEditedBatchCellMatrix = function () {\n        var editedBatchCellMatrix = [];\n        var gObj = this.parent;\n        var editedBatchCell = gObj.focusModule.active.getTable().querySelector('.e-editedbatchcell');\n        if (editedBatchCell) {\n            var tr = editedBatchCell.parentElement;\n            var rowIndex = [].slice.call(this.parent.focusModule.active.getTable().rows).indexOf(tr);\n            var cellIndex = [].slice.call(tr.cells).indexOf(editedBatchCell);\n            editedBatchCellMatrix = [rowIndex, cellIndex];\n        }\n        return editedBatchCellMatrix;\n    };\n    BatchEdit.prototype.getDataByIndex = function (index) {\n        var row = this.parent.getRowObjectFromUID(this.parent.getDataRows()[parseInt(index.toString(), 10)].getAttribute('data-uid'));\n        return row.changes ? row.changes : row.data;\n    };\n    BatchEdit.prototype.keyDownHandler = function (e) {\n        if (this.addBatchRow || ((e.action === 'tab' || e.action === 'shiftTab') && this.parent.isEdit)) {\n            var gObj = this.parent;\n            var btmIdx = this.getBottomIndex();\n            var rowcell = parentsUntil(e.target, literals.rowCell);\n            if (this.addBatchRow || (rowcell && !this.parent.isReact)) {\n                var cell = void 0;\n                if (rowcell) {\n                    cell = rowcell.querySelector('.e-field');\n                }\n                if (this.addBatchRow || cell) {\n                    var visibleColumns = this.parent.getVisibleColumns();\n                    var columnIndex = e.action === 'tab' ? visibleColumns.length - 1 : 0;\n                    if (this.addBatchRow\n                        || visibleColumns[parseInt(columnIndex.toString(), 10)].field === cell.getAttribute('id').slice(this.parent.element.id.length)) {\n                        if (this.cellDetails.rowIndex === btmIdx && e.action === 'tab') {\n                            if (gObj.editSettings.newRowPosition === 'Top') {\n                                gObj.editSettings.newRowPosition = 'Bottom';\n                                this.addRecord();\n                                gObj.editSettings.newRowPosition = 'Top';\n                            }\n                            else {\n                                this.addRecord();\n                            }\n                            this.addBatchRow = false;\n                        }\n                        else {\n                            this.saveCell();\n                        }\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    BatchEdit.prototype.addCancelWhilePaging = function () {\n        if (this.validateFormObj()) {\n            this.parent.notify(events.destroyForm, {});\n            this.parent.isEdit = false;\n            this.editNext = false;\n            this.mouseDownElement = undefined;\n            this.isColored = false;\n        }\n    };\n    BatchEdit.prototype.getBottomIndex = function () {\n        var changes = this.getBatchChanges();\n        return this.parent.getCurrentViewRecords().length + changes[literals.addedRecords].length -\n            changes[literals.deletedRecords].length - 1;\n    };\n    return BatchEdit;\n}());\nexport { BatchEdit };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}