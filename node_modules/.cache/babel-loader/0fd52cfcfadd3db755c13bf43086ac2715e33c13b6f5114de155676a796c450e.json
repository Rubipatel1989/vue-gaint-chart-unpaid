{"ast":null,"code":"import { detach, isNullOrUndefined, select, extend, isNullOrUndefined as isNOU } from '@syncfusion/ej2-base';\nimport { closest, addClass, removeClass, Browser } from '@syncfusion/ej2-base';\nimport * as events from '../base/constant';\nimport { CLS_RTE_ELEMENTS } from '../base/classes';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { RenderType } from '../base/enum';\nimport { dispatchEvent, parseHtml } from '../base/util';\nimport { isIDevice } from '../../common/util';\n/**\n * `Link` module is used to handle undo actions.\n */\nvar Link = /** @class */function () {\n  function Link(parent, serviceLocator) {\n    this.parent = parent;\n    this.rteID = parent.element.id;\n    this.i10n = serviceLocator.getService('rteLocale');\n    this.addEventListener();\n    this.serviceLocator = serviceLocator;\n    this.rendererFactory = serviceLocator.getService('rendererFactory');\n    this.dialogRenderObj = serviceLocator.getService('dialogRenderObject');\n    this.isDestroyed = false;\n    this.mouseDown = this.onDocumentClick.bind(this);\n  }\n  Link.prototype.addEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    this.parent.on(events.insertLink, this.linkDialog, this);\n    this.parent.on(events.showLinkDialog, this.showDialog, this);\n    this.parent.on(events.closeLinkDialog, this.closeDialog, this);\n    this.parent.on(events.keyDown, this.onKeyDown, this);\n    this.parent.on(events.insertCompleted, this.showLinkQuickToolbar, this);\n    this.parent.on(events.clearDialogObj, this.clearDialogObj, this);\n    this.parent.on(events.linkToolbarAction, this.onToolbarAction, this);\n    this.parent.on(events.iframeMouseDown, this.onIframeMouseDown, this);\n    this.parent.on(events.unLink, this.removeLink, this);\n    this.parent.on(events.editLink, this.editLink, this);\n    this.parent.on(events.openLink, this.openLink, this);\n    this.parent.on(events.editAreaClick, this.editAreaClickHandler, this);\n    this.parent.on(events.bindCssClass, this.setCssClass, this);\n    this.parent.on(events.destroy, this.destroy, this);\n  };\n  Link.prototype.onToolbarAction = function (args) {\n    var item = args.args.item;\n    switch (item.subCommand) {\n      case 'OpenLink':\n        this.parent.notify(events.openLink, args);\n        break;\n      case 'EditLink':\n        this.parent.notify(events.editLink, args);\n        break;\n      case 'RemoveLink':\n        this.parent.notify(events.unLink, args);\n        break;\n    }\n  };\n  Link.prototype.removeEventListener = function () {\n    this.parent.off(events.insertLink, this.linkDialog);\n    this.parent.off(events.showLinkDialog, this.showDialog);\n    this.parent.off(events.closeLinkDialog, this.closeDialog);\n    this.parent.off(events.keyDown, this.onKeyDown);\n    this.parent.off(events.insertCompleted, this.showLinkQuickToolbar);\n    this.parent.off(events.clearDialogObj, this.clearDialogObj);\n    this.parent.off(events.linkToolbarAction, this.onToolbarAction);\n    this.parent.off(events.unLink, this.removeLink);\n    this.parent.off(events.iframeMouseDown, this.onIframeMouseDown);\n    this.parent.off(events.editLink, this.editLink);\n    this.parent.off(events.openLink, this.openLink);\n    this.parent.off(events.editAreaClick, this.editAreaClickHandler);\n    this.parent.off(events.bindCssClass, this.setCssClass);\n    this.parent.off(events.destroy, this.destroy);\n  };\n  Link.prototype.onIframeMouseDown = function () {\n    if (this.dialogObj) {\n      this.dialogObj.hide({\n        returnValue: true\n      });\n    }\n  };\n  Link.prototype.updateCss = function (currentObj, e) {\n    if (currentObj && e.cssClass) {\n      if (isNullOrUndefined(e.oldCssClass)) {\n        currentObj.setProperties({\n          cssClass: (currentObj.cssClass + ' ' + e.cssClass).trim()\n        });\n      } else {\n        currentObj.setProperties({\n          cssClass: (currentObj.cssClass.replace(e.oldCssClass, '').trim() + ' ' + e.cssClass).trim()\n        });\n      }\n    }\n  };\n  // eslint-disable-next-line @typescript-eslint/tslint/config\n  Link.prototype.setCssClass = function (e) {\n    this.updateCss(this.checkBoxObj, e);\n    this.updateCss(this.dialogObj, e);\n  };\n  Link.prototype.showLinkQuickToolbar = function (e) {\n    if (!isNullOrUndefined(e.args) && e.args.action !== 'enter' && e.args.action !== 'space') {\n      var pageX = void 0;\n      var pageY = void 0;\n      if (e.type !== 'Links' || isNullOrUndefined(this.parent.quickToolbarModule) || isNullOrUndefined(this.parent.quickToolbarModule.linkQTBar)) {\n        return;\n      }\n      this.quickToolObj = this.parent.quickToolbarModule;\n      var parentTop = this.parent.element.getBoundingClientRect().top;\n      var parentLeft = this.parent.element.getBoundingClientRect().left;\n      var range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n      var target_1;\n      [].forEach.call(e.elements, function (element, index) {\n        if (index === 0) {\n          target_1 = element.nodeName === '#text' ? element.parentNode : element;\n        }\n      });\n      if (e.isNotify) {\n        var tbElement = this.parent.toolbarModule.getToolbarElement();\n        var linkTop = target_1.getBoundingClientRect().top;\n        var linkLeft = target_1.getBoundingClientRect().left;\n        var linkPos = linkTop - parentTop;\n        var tbHeight = tbElement ? tbElement.offsetHeight + this.parent.toolbarModule.getExpandTBarPopHeight() : 0;\n        pageX = this.parent.iframeSettings.enable ? parentLeft + linkLeft : target_1.getBoundingClientRect().left;\n        pageY = window.pageYOffset + (this.parent.iframeSettings.enable ? parentTop + tbHeight + linkTop : parentTop + linkPos);\n      } else {\n        var args = void 0;\n        args = e.args.touches ? e.args.changedTouches[0] : args = e.args;\n        pageX = this.parent.iframeSettings.enable ? window.pageXOffset + parentLeft + args.clientX : args.pageX;\n        pageY = this.parent.iframeSettings.enable ? window.pageYOffset + parentTop + args.clientY : args.pageY;\n      }\n      if (this.quickToolObj.linkQTBar) {\n        this.quickToolObj.linkQTBar.showPopup(pageX, pageY, range.endContainer, 'link');\n      }\n    }\n  };\n  Link.prototype.hideLinkQuickToolbar = function () {\n    if (this.quickToolObj && this.quickToolObj.linkQTBar && document.body.contains(this.quickToolObj.linkQTBar.element)) {\n      this.quickToolObj.linkQTBar.hidePopup();\n    }\n  };\n  Link.prototype.editAreaClickHandler = function (e) {\n    if (this.parent.readonly) {\n      this.hideLinkQuickToolbar();\n      return;\n    }\n    var args = e.args;\n    var showOnRightClick = this.parent.quickToolbarSettings.showOnRightClick;\n    if (args.which === 2 || showOnRightClick && args.which === 1 || !showOnRightClick && args.which === 3) {\n      return;\n    }\n    if (this.parent.editorMode === 'HTML' && this.parent.quickToolbarModule && this.parent.quickToolbarModule.linkQTBar) {\n      this.quickToolObj = this.parent.quickToolbarModule;\n      var target = args.target;\n      target = this.getAnchorNode(target);\n      this.contentModule = this.rendererFactory.getRenderer(RenderType.Content);\n      var isPopupOpen = this.quickToolObj.linkQTBar.element.classList.contains('e-rte-pop');\n      if (target.nodeName === 'A' && target.childNodes.length > 0 && target.childNodes[0].nodeName !== 'IMG' && e.args.target.nodeName !== 'IMG' && !isNOU(closest(this.parent.getRange().startContainer.parentElement, 'A')) && !isNOU(closest(this.parent.getRange().endContainer.parentElement, 'A'))) {\n        if (isPopupOpen) {\n          return;\n        }\n        if (e.args.ctrlKey === false) {\n          this.showLinkQuickToolbar({\n            args: args,\n            isNotify: false,\n            type: 'Links',\n            elements: [args.target]\n          });\n        } else {\n          var selection = this.parent.formatter.editorManager.nodeSelection;\n          var range = selection.getRange(this.parent.contentModule.getDocument());\n          var args_1 = {\n            args: {\n              item: {\n                subCommand: 'OpenLink',\n                command: 'Links',\n                name: ''\n              },\n              originalEvent: e.args\n            },\n            selectNode: selection.getNodeCollection(range),\n            selectParent: selection.getParentNodeCollection(range),\n            selection: selection.save(range, this.parent.contentModule.getDocument())\n          };\n          this.parent.notify(events.openLink, args_1);\n        }\n      } else {\n        this.hideLinkQuickToolbar();\n      }\n    }\n  };\n  Link.prototype.onKeyDown = function (event) {\n    var originalEvent = event.args;\n    switch (originalEvent.action) {\n      case 'escape':\n        if (!isNullOrUndefined(this.dialogObj)) {\n          this.dialogObj.close();\n        }\n        break;\n      case 'insert-link':\n        this.openDialog(true, event);\n        originalEvent.preventDefault();\n        break;\n    }\n  };\n  Link.prototype.openDialog = function (isInternal, event) {\n    if (!isInternal) {\n      this.parent.contentModule.getEditPanel().focus();\n    }\n    if (this.parent.editorMode === 'HTML') {\n      var range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n      var save = this.parent.formatter.editorManager.nodeSelection.save(range, this.parent.contentModule.getDocument());\n      var selectNodeEle = this.parent.formatter.editorManager.nodeSelection.getNodeCollection(range);\n      var selectParentEle = this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(range);\n      var eventArgs = {\n        args: event ? event.args : {\n          item: {\n            command: 'Links',\n            subCommand: 'CreateLink'\n          },\n          originalEvent: undefined,\n          name: !isInternal ? 'showDialog' : null\n        },\n        selectNode: selectNodeEle,\n        selection: save,\n        selectParent: selectParentEle\n      };\n      this.linkDialog(eventArgs);\n    } else {\n      var textArea = this.parent.contentModule.getEditPanel();\n      this.parent.formatter.editorManager.markdownSelection.save(textArea.selectionStart, textArea.selectionEnd);\n      this.linkDialog({\n        args: {\n          item: {\n            command: 'Links',\n            subCommand: 'Link'\n          },\n          originalEvent: event && event.args\n        },\n        member: 'link',\n        text: this.parent.formatter.editorManager.markdownSelection.getSelectedText(this.parent.contentModule.getEditPanel()),\n        module: 'Markdown',\n        name: 'insertLink'\n      });\n    }\n  };\n  Link.prototype.showDialog = function () {\n    this.openDialog(false);\n    this.setCssClass({\n      cssClass: this.parent.getCssClass()\n    });\n  };\n  Link.prototype.closeDialog = function () {\n    if (this.dialogObj) {\n      this.dialogObj.hide({\n        returnValue: true\n      });\n    }\n  };\n  Link.prototype.clearDialogObj = function () {\n    if (this.dialogObj) {\n      this.dialogObj.destroy();\n      detach(this.dialogObj.element);\n      this.dialogObj = null;\n    }\n  };\n  Link.prototype.linkDialog = function (e, inputDetails) {\n    var _this = this;\n    if (this.dialogObj) {\n      this.dialogObj.hide({\n        returnValue: true\n      });\n      return;\n    }\n    if (this.parent.editorMode === 'HTML' && e.selectParent.length > 0 && !isNullOrUndefined(e.selectParent[0].classList) && e.selectParent[0].classList.contains('e-rte-anchor') && isNullOrUndefined(inputDetails)) {\n      this.editLink(e);\n      return;\n    }\n    var linkWebAddress = this.i10n.getConstant('linkWebUrl');\n    var linkDisplayText = this.i10n.getConstant('linkText');\n    var linkTooltip = this.i10n.getConstant('linkTooltipLabel');\n    var urlPlace = this.i10n.getConstant('linkurl');\n    var textPlace = this.i10n.getConstant('textPlaceholder');\n    var title = this.i10n.getConstant('linkTitle');\n    var linkDialogEle = this.parent.createElement('div', {\n      className: 'e-rte-link-dialog' + this.parent.getCssClass(true),\n      id: this.rteID + '_rtelink'\n    });\n    this.parent.rootContainer.appendChild(linkDialogEle);\n    var linkContent = this.parent.createElement('div', {\n      className: 'e-rte-linkcontent' + this.parent.getCssClass(true),\n      id: this.rteID + '_linkContent'\n    });\n    var htmlTextbox = this.parent.editorMode === 'HTML' ? '<label>' + linkTooltip + '</label></div><div class=\"e-rte-field' + this.parent.getCssClass(true) + '\">' + '<input type=\"text\" data-role =\"none\" spellcheck=\"false\" placeholder = \"' + title + '\"aria-label=\"' + this.i10n.getConstant('linkTitle') + '\" class=\"e-input e-rte-linkTitle' + this.parent.getCssClass(true) + '\"></div>' + '<div class=\"e-rte-label' + this.parent.getCssClass(true) + '\"></div>' + '<div class=\"e-rte-field' + this.parent.getCssClass(true) + '\">' + '<input type=\"checkbox\" class=\"e-rte-linkTarget' + this.parent.getCssClass(true) + '\"  data-role =\"none\"></div>' : '';\n    var content = '<div class=\"e-rte-label' + this.parent.getCssClass(true) + '\"><label>' + linkWebAddress + '</label></div>' + '<div class=\"e-rte-field' + this.parent.getCssClass(true) + '\">' + '<input type=\"text\" data-role =\"none\" spellcheck=\"false\" placeholder=\"' + urlPlace + '\"aria-label=\"' + this.i10n.getConstant('linkWebUrl') + '\" class=\"e-input e-rte-linkurl' + this.parent.getCssClass(true) + '\"/></div>' + '<div class=\"e-rte-label' + this.parent.getCssClass(true) + '\">' + '<label>' + linkDisplayText + '</label></div><div class=\"e-rte-field' + this.parent.getCssClass(true) + '\"> ' + '<input type=\"text\" data-role =\"none\" spellcheck=\"false\" class=\"e-input e-rte-linkText' + this.parent.getCssClass(true) + '\"aria-label=\"' + this.i10n.getConstant('linkText') + '\" placeholder=\"' + textPlace + '\">' + '</div><div class=\"e-rte-label' + this.parent.getCssClass(true) + '\">' + htmlTextbox;\n    var contentElem = parseHtml(content);\n    linkContent.appendChild(contentElem);\n    var linkTarget = linkContent.querySelector('.e-rte-linkTarget');\n    var linkUrl = linkContent.querySelector('.e-rte-linkurl');\n    var linkText = linkContent.querySelector('.e-rte-linkText');\n    var linkTitle = linkContent.querySelector('.e-rte-linkTitle');\n    var linkOpenLabel = this.i10n.getConstant('linkOpenInNewWindow');\n    this.checkBoxObj = new CheckBox({\n      label: linkOpenLabel,\n      checked: true,\n      enableRtl: this.parent.enableRtl,\n      cssClass: this.parent.getCssClass()\n    });\n    this.checkBoxObj.isStringTemplate = true;\n    this.checkBoxObj.createElement = this.parent.createElement;\n    this.checkBoxObj.appendTo(linkTarget);\n    var selectText = this.parent.editorMode === 'HTML' ? e.selection.getRange(this.parent.contentModule.getDocument()).toString() : e.text;\n    var linkInsert = this.i10n.getConstant('dialogInsert');\n    var linkCancel = this.i10n.getConstant('dialogCancel');\n    var selection = e.selection;\n    var selectObj = {\n      selfLink: this,\n      selection: e.selection,\n      selectParent: e.selectParent,\n      args: e.args\n    };\n    var dialogModel = {\n      header: this.i10n.getConstant('linkHeader'),\n      content: linkContent,\n      cssClass: CLS_RTE_ELEMENTS + this.parent.getCssClass(true),\n      enableRtl: this.parent.enableRtl,\n      locale: this.parent.locale,\n      showCloseIcon: true,\n      closeOnEscape: true,\n      width: Browser.isDevice ? '290px' : '310px',\n      isModal: Browser.isDevice,\n      buttons: [{\n        click: this.insertlink.bind(selectObj),\n        buttonModel: {\n          content: linkInsert,\n          cssClass: 'e-flat e-insertLink' + this.parent.getCssClass(true),\n          isPrimary: true\n        }\n      }, {\n        click: this.cancelDialog.bind(selectObj),\n        buttonModel: {\n          cssClass: 'e-flat' + this.parent.getCssClass(true),\n          content: linkCancel\n        }\n      }],\n      target: Browser.isDevice ? document.body : this.parent.element,\n      animationSettings: {\n        effect: 'None'\n      },\n      close: function (event) {\n        _this.parent.isBlur = false;\n        if (event && event.event.returnValue) {\n          if (_this.parent.editorMode === 'HTML') {\n            selection.restore();\n          } else {\n            _this.parent.formatter.editorManager.markdownSelection.restore(_this.parent.contentModule.getEditPanel());\n          }\n        }\n        _this.dialogObj.destroy();\n        detach(_this.dialogObj.element);\n        var args = _this.dialogObj;\n        _this.dialogRenderObj.close(args);\n        _this.dialogObj = null;\n      }\n    };\n    // eslint-disable-next-line\n    this.dialogObj = this.dialogRenderObj.render(dialogModel);\n    this.dialogObj.createElement = this.parent.createElement;\n    this.dialogObj.appendTo(linkDialogEle);\n    linkDialogEle.style.maxHeight = 'inherit';\n    if (isNullOrUndefined(this.dialogObj)) {\n      return;\n    }\n    if (!isNullOrUndefined(inputDetails)) {\n      linkUrl.value = inputDetails.url;\n      linkText.value = inputDetails.text;\n      linkTitle.value = inputDetails.title;\n      // eslint-disable-next-line\n      inputDetails.target ? this.checkBoxObj.checked = true : this.checkBoxObj.checked = false;\n      this.dialogObj.header = inputDetails.header;\n      this.dialogObj.element.querySelector('.e-insertLink').textContent = inputDetails.btnText;\n    }\n    this.checkUrl(false);\n    if (this.parent.editorMode === 'HTML' && isNullOrUndefined(inputDetails) && (!isNullOrUndefined(selectText) && selectText !== '' && e.selection.range.startOffset === 0 || e.selection.range.startOffset !== e.selection.range.endOffset) || e.module === 'Markdown') {\n      linkText.value = selectText;\n    }\n    this.parent.element.ownerDocument.addEventListener('mousedown', this.mouseDown);\n    if (this.quickToolObj) {\n      this.hideLinkQuickToolbar();\n      if (this.quickToolObj.inlineQTBar && document.body.contains(this.quickToolObj.inlineQTBar.element)) {\n        this.quickToolObj.inlineQTBar.hidePopup();\n      }\n      if (this.quickToolObj.textQTBar && this.parent.element.ownerDocument.body.contains(this.quickToolObj.textQTBar.element)) {\n        this.quickToolObj.textQTBar.hidePopup();\n      }\n    }\n  };\n  // eslint-disable-next-line\n  Link.prototype.insertlink = function (e) {\n    var linkEle = this.selfLink.dialogObj.element;\n    var linkUrl = linkEle.querySelector('.e-rte-linkurl').value.trim();\n    var linkText = linkEle.querySelector('.e-rte-linkText').value;\n    var linkTitle;\n    if (this.selfLink.parent.editorMode === 'HTML') {\n      linkTitle = linkEle.querySelector('.e-rte-linkTitle').value;\n    }\n    var target = this.selfLink.checkBoxObj.checked ? '_blank' : null;\n    var linkLabel = this.selfLink.checkBoxObj.checked ? this.selfLink.i10n.getConstant('linkAriaLabel') : null;\n    if (this.selfLink.parent.editorMode === 'Markdown' && linkUrl === '') {\n      linkUrl = 'http://';\n    }\n    if (linkUrl === '') {\n      this.selfLink.checkUrl(true);\n      return;\n    }\n    if (!this.selfLink.isUrl(linkUrl)) {\n      if (this.selfLink.parent.editorMode === 'Markdown') {\n        linkText = linkText !== '' ? linkText : '';\n      } else {\n        linkText = linkText === '' ? linkUrl : linkText;\n      }\n      if (!this.selfLink.parent.enableAutoUrl) {\n        linkUrl = linkUrl.indexOf('http') > -1 ? linkUrl : 'http://' + linkUrl;\n      } else {\n        // eslint-disable-next-line\n        linkUrl = linkUrl;\n      }\n    } else {\n      this.selfLink.checkUrl(false);\n    }\n    var proxy = this.selfLink;\n    if (proxy.parent.editorMode === 'HTML' && isNullOrUndefined(closest(this.selection.range.startContainer.parentNode, '[id='\n    // eslint-disable-next-line\n    + \"'\" + proxy.parent.contentModule.getPanel().id + \"'\" + ']'))) {\n      proxy.parent.contentModule.getEditPanel().focus();\n      if (Browser.isIE && proxy.parent.iframeSettings.enable) {\n        this.selection.restore();\n      }\n      var range = proxy.parent.formatter.editorManager.nodeSelection.getRange(proxy.parent.contentModule.getDocument());\n      this.selection = proxy.parent.formatter.editorManager.nodeSelection.save(range, proxy.parent.contentModule.getDocument());\n      this.selectParent = proxy.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(range);\n    }\n    var value = {\n      url: linkUrl,\n      text: linkText,\n      title: linkTitle,\n      target: target,\n      ariaLabel: linkLabel,\n      selection: this.selection,\n      selectParent: this.selectParent\n    };\n    if (document.body.contains(proxy.dialogObj.element)) {\n      this.selfLink.dialogObj.hide({\n        returnValue: false\n      });\n    }\n    if (this.selfLink.dialogObj !== null) {\n      return;\n    }\n    if (isIDevice() && proxy.parent.iframeSettings.enable) {\n      select('iframe', proxy.parent.element).contentWindow.focus();\n    }\n    if (proxy.parent.editorMode === 'HTML') {\n      this.selection.restore();\n    }\n    if (proxy.parent.formatter.getUndoRedoStack().length === 0) {\n      proxy.parent.formatter.saveData();\n    }\n    var argsValue;\n    if (!isNullOrUndefined(this.args) && this.args.code === 'KeyK') {\n      var originalEvent = this.args;\n      extend(this.args, {\n        item: {\n          command: 'Links',\n          subCommand: 'CreateLink'\n        },\n        originalEvent: originalEvent\n      }, true);\n      var argsVal = {\n        item: {\n          command: 'Links',\n          subCommand: 'CreateLink'\n        },\n        originalEvent: originalEvent\n      };\n      argsValue = argsVal;\n    } else {\n      argsValue = this.args;\n    }\n    this.selfLink.parent.formatter.process(this.selfLink.parent, argsValue, !isNullOrUndefined(this.args) && this.args.originalEvent, value);\n    this.selfLink.parent.contentModule.getEditPanel().focus();\n  };\n  Link.prototype.isUrl = function (url) {\n    var regExp = RegExp;\n    var regexp = new regExp('(ftp|http|https)://(\\\\w+:{0,1}\\\\w*@)?(\\\\S+)(:[0-9]+)?(/|/([\\\\w#!:.?+=&%@\\\\-\\\\/]))?', 'gi');\n    return regexp.test(url);\n  };\n  Link.prototype.checkUrl = function (e) {\n    var linkEle = this.dialogObj.element;\n    var linkUrl = linkEle.querySelector('.e-rte-linkurl');\n    if (e) {\n      addClass([linkUrl], 'e-error');\n      linkUrl.setSelectionRange(0, linkUrl.value.length);\n      linkUrl.focus();\n    } else {\n      removeClass([linkUrl], 'e-error');\n    }\n  };\n  Link.prototype.removeLink = function (e) {\n    if (this.parent.formatter.getUndoRedoStack().length === 0) {\n      this.parent.formatter.saveData();\n    }\n    var selectParentEle = this.getAnchorNode(e.selectParent[0]);\n    this.parent.formatter.process(this.parent, e.args, e.args, {\n      selectNode: e.selectNode,\n      selectParent: e.selectParent,\n      selection: e.selection,\n      text: selectParentEle.innerText,\n      subCommand: e.args.item.subCommand\n    });\n    if (isIDevice() && this.parent.iframeSettings.enable) {\n      select('iframe', this.parent.element).contentWindow.focus();\n    } else {\n      this.parent.contentModule.getEditPanel().focus();\n    }\n    this.hideLinkQuickToolbar();\n  };\n  Link.prototype.openLink = function (e) {\n    var selectParentEle = this.getAnchorNode(e.selectParent[0]);\n    if (selectParentEle.classList.contains('e-rte-anchor') || selectParentEle.tagName === 'A') {\n      var sanitizedHTML = this.parent.htmlEditorModule.sanitizeHelper(selectParentEle.outerHTML);\n      var tempEle = document.createElement('div');\n      tempEle.innerHTML = sanitizedHTML;\n      this.parent.formatter.process(this.parent, e.args, e.args, {\n        url: tempEle.firstChild.href,\n        text: selectParentEle.innerText,\n        target: selectParentEle.target === '' ? '_self' : '_blank',\n        selectNode: e.selectNode,\n        subCommand: e.args.item.subCommand\n      });\n      tempEle.remove();\n    }\n  };\n  Link.prototype.getAnchorNode = function (element) {\n    var selectParent = closest(element, 'a');\n    return selectParent ? selectParent : element;\n  };\n  Link.prototype.editLink = function (e) {\n    var selectedNode = this.getAnchorNode(e.selectNode[0]);\n    var selectParentEle = this.getAnchorNode(e.selectParent[0]);\n    selectParentEle = selectedNode.nodeName === 'A' ? selectedNode : selectParentEle;\n    if (selectParentEle.classList.contains('e-rte-anchor') || selectParentEle.tagName === 'A') {\n      var linkUpdate = this.i10n.getConstant('dialogUpdate');\n      var inputDetails = {\n        url: selectParentEle.getAttribute('href'),\n        text: selectParentEle.innerText,\n        title: selectParentEle.title,\n        target: selectParentEle.target,\n        header: this.i10n.getConstant('editLink'),\n        btnText: linkUpdate\n      };\n      this.linkDialog(e, inputDetails);\n    }\n  };\n  // eslint-disable-next-line\n  Link.prototype.cancelDialog = function (e) {\n    this.selfLink.parent.isBlur = false;\n    this.selfLink.dialogObj.hide({\n      returnValue: true\n    });\n    if (isIDevice()) {\n      this.selection.restore();\n    } else {\n      var x = window.scrollX;\n      var y = window.scrollY;\n      this.selfLink.parent.contentModule.getEditPanel().focus();\n      window.scrollTo(x, y);\n    }\n  };\n  Link.prototype.onDocumentClick = function (e) {\n    var target = e.target;\n    if (!isNullOrUndefined(this.dialogObj) && (\n    // eslint-disable-next-line\n    !closest(target, '[id=' + \"'\" + this.dialogObj.element.id + \"'\" + ']') && this.parent.toolbarSettings.enable && this.parent.getToolbarElement() && !this.parent.getToolbarElement().contains(e.target) || (this.parent.getToolbarElement() && this.parent.getToolbarElement().contains(e.target) || this.parent.inlineMode.enable && !closest(target, '#' + this.dialogObj.element.id)) && !closest(target, '#' + this.parent.getID() + '_toolbar_CreateLink') && !target.querySelector('#' + this.parent.getID() + '_toolbar_CreateLink'))) {\n      this.parent.notify(events.documentClickClosedBy, {\n        closedBy: 'outside click'\n      });\n      this.dialogObj.hide({\n        returnValue: true\n      });\n      this.parent.element.ownerDocument.removeEventListener('mousedown', this.mouseDown);\n      this.mouseDown = null;\n      this.parent.isBlur = true;\n      dispatchEvent(this.parent.element, 'focusout');\n    }\n  };\n  /**\n   * Destroys the ToolBar.\n   *\n   * @function destroy\n   * @returns {void}\n   * @hidden\n    */\n  Link.prototype.destroy = function () {\n    if (this.isDestroyed) {\n      return;\n    }\n    this.parent.element.ownerDocument.removeEventListener('mousedown', this.mouseDown);\n    this.mouseDown = null;\n    this.removeEventListener();\n    this.isDestroyed = true;\n  };\n  /**\n   * For internal use only - Get the module name.\n   *\n   * @returns {void}\n   */\n  Link.prototype.getModuleName = function () {\n    return 'link';\n  };\n  return Link;\n}();\nexport { Link };","map":{"version":3,"names":["detach","isNullOrUndefined","select","extend","isNOU","closest","addClass","removeClass","Browser","events","CLS_RTE_ELEMENTS","CheckBox","RenderType","dispatchEvent","parseHtml","isIDevice","Link","parent","serviceLocator","rteID","element","id","i10n","getService","addEventListener","rendererFactory","dialogRenderObj","isDestroyed","mouseDown","onDocumentClick","bind","prototype","on","insertLink","linkDialog","showLinkDialog","showDialog","closeLinkDialog","closeDialog","keyDown","onKeyDown","insertCompleted","showLinkQuickToolbar","clearDialogObj","linkToolbarAction","onToolbarAction","iframeMouseDown","onIframeMouseDown","unLink","removeLink","editLink","openLink","editAreaClick","editAreaClickHandler","bindCssClass","setCssClass","destroy","args","item","subCommand","notify","removeEventListener","off","dialogObj","hide","returnValue","updateCss","currentObj","e","cssClass","oldCssClass","setProperties","trim","replace","checkBoxObj","action","pageX","pageY","type","quickToolbarModule","linkQTBar","quickToolObj","parentTop","getBoundingClientRect","top","parentLeft","left","range","formatter","editorManager","nodeSelection","getRange","contentModule","getDocument","target_1","forEach","call","elements","index","nodeName","parentNode","isNotify","tbElement","toolbarModule","getToolbarElement","linkTop","linkLeft","linkPos","tbHeight","offsetHeight","getExpandTBarPopHeight","iframeSettings","enable","window","pageYOffset","touches","changedTouches","pageXOffset","clientX","clientY","showPopup","endContainer","hideLinkQuickToolbar","document","body","contains","hidePopup","readonly","showOnRightClick","quickToolbarSettings","which","editorMode","target","getAnchorNode","getRenderer","Content","isPopupOpen","classList","childNodes","length","startContainer","parentElement","ctrlKey","selection","args_1","command","name","originalEvent","selectNode","getNodeCollection","selectParent","getParentNodeCollection","save","event","close","openDialog","preventDefault","isInternal","getEditPanel","focus","selectNodeEle","selectParentEle","eventArgs","undefined","textArea","markdownSelection","selectionStart","selectionEnd","member","text","getSelectedText","module","getCssClass","inputDetails","_this","linkWebAddress","getConstant","linkDisplayText","linkTooltip","urlPlace","textPlace","title","linkDialogEle","createElement","className","rootContainer","appendChild","linkContent","htmlTextbox","content","contentElem","linkTarget","querySelector","linkUrl","linkText","linkTitle","linkOpenLabel","label","checked","enableRtl","isStringTemplate","appendTo","selectText","toString","linkInsert","linkCancel","selectObj","selfLink","dialogModel","header","locale","showCloseIcon","closeOnEscape","width","isDevice","isModal","buttons","click","insertlink","buttonModel","isPrimary","cancelDialog","animationSettings","effect","isBlur","restore","render","style","maxHeight","value","url","textContent","btnText","checkUrl","startOffset","endOffset","ownerDocument","inlineQTBar","textQTBar","linkEle","linkLabel","isUrl","enableAutoUrl","indexOf","proxy","getPanel","isIE","ariaLabel","contentWindow","getUndoRedoStack","saveData","argsValue","code","argsVal","process","regExp","RegExp","regexp","test","setSelectionRange","innerText","tagName","sanitizedHTML","htmlEditorModule","sanitizeHelper","outerHTML","tempEle","innerHTML","firstChild","href","remove","selectedNode","linkUpdate","getAttribute","x","scrollX","y","scrollY","scrollTo","toolbarSettings","inlineMode","getID","documentClickClosedBy","closedBy","getModuleName"],"sources":["/var/www/vue/vue-gantt-chart/node_modules/@syncfusion/ej2-richtexteditor/src/rich-text-editor/renderer/link-module.js"],"sourcesContent":["import { detach, isNullOrUndefined, select, extend, isNullOrUndefined as isNOU } from '@syncfusion/ej2-base';\nimport { closest, addClass, removeClass, Browser } from '@syncfusion/ej2-base';\nimport * as events from '../base/constant';\nimport { CLS_RTE_ELEMENTS } from '../base/classes';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { RenderType } from '../base/enum';\nimport { dispatchEvent, parseHtml } from '../base/util';\nimport { isIDevice } from '../../common/util';\n/**\n * `Link` module is used to handle undo actions.\n */\nvar Link = /** @class */ (function () {\n    function Link(parent, serviceLocator) {\n        this.parent = parent;\n        this.rteID = parent.element.id;\n        this.i10n = serviceLocator.getService('rteLocale');\n        this.addEventListener();\n        this.serviceLocator = serviceLocator;\n        this.rendererFactory = serviceLocator.getService('rendererFactory');\n        this.dialogRenderObj = serviceLocator.getService('dialogRenderObject');\n        this.isDestroyed = false;\n        this.mouseDown = this.onDocumentClick.bind(this);\n    }\n    Link.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on(events.insertLink, this.linkDialog, this);\n        this.parent.on(events.showLinkDialog, this.showDialog, this);\n        this.parent.on(events.closeLinkDialog, this.closeDialog, this);\n        this.parent.on(events.keyDown, this.onKeyDown, this);\n        this.parent.on(events.insertCompleted, this.showLinkQuickToolbar, this);\n        this.parent.on(events.clearDialogObj, this.clearDialogObj, this);\n        this.parent.on(events.linkToolbarAction, this.onToolbarAction, this);\n        this.parent.on(events.iframeMouseDown, this.onIframeMouseDown, this);\n        this.parent.on(events.unLink, this.removeLink, this);\n        this.parent.on(events.editLink, this.editLink, this);\n        this.parent.on(events.openLink, this.openLink, this);\n        this.parent.on(events.editAreaClick, this.editAreaClickHandler, this);\n        this.parent.on(events.bindCssClass, this.setCssClass, this);\n        this.parent.on(events.destroy, this.destroy, this);\n    };\n    Link.prototype.onToolbarAction = function (args) {\n        var item = args.args.item;\n        switch (item.subCommand) {\n            case 'OpenLink':\n                this.parent.notify(events.openLink, args);\n                break;\n            case 'EditLink':\n                this.parent.notify(events.editLink, args);\n                break;\n            case 'RemoveLink':\n                this.parent.notify(events.unLink, args);\n                break;\n        }\n    };\n    Link.prototype.removeEventListener = function () {\n        this.parent.off(events.insertLink, this.linkDialog);\n        this.parent.off(events.showLinkDialog, this.showDialog);\n        this.parent.off(events.closeLinkDialog, this.closeDialog);\n        this.parent.off(events.keyDown, this.onKeyDown);\n        this.parent.off(events.insertCompleted, this.showLinkQuickToolbar);\n        this.parent.off(events.clearDialogObj, this.clearDialogObj);\n        this.parent.off(events.linkToolbarAction, this.onToolbarAction);\n        this.parent.off(events.unLink, this.removeLink);\n        this.parent.off(events.iframeMouseDown, this.onIframeMouseDown);\n        this.parent.off(events.editLink, this.editLink);\n        this.parent.off(events.openLink, this.openLink);\n        this.parent.off(events.editAreaClick, this.editAreaClickHandler);\n        this.parent.off(events.bindCssClass, this.setCssClass);\n        this.parent.off(events.destroy, this.destroy);\n    };\n    Link.prototype.onIframeMouseDown = function () {\n        if (this.dialogObj) {\n            this.dialogObj.hide({ returnValue: true });\n        }\n    };\n    Link.prototype.updateCss = function (currentObj, e) {\n        if (currentObj && e.cssClass) {\n            if (isNullOrUndefined(e.oldCssClass)) {\n                currentObj.setProperties({ cssClass: (currentObj.cssClass + ' ' + e.cssClass).trim() });\n            }\n            else {\n                currentObj.setProperties({ cssClass: (currentObj.cssClass.replace(e.oldCssClass, '').trim() + ' ' + e.cssClass).trim() });\n            }\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/tslint/config\n    Link.prototype.setCssClass = function (e) {\n        this.updateCss(this.checkBoxObj, e);\n        this.updateCss(this.dialogObj, e);\n    };\n    Link.prototype.showLinkQuickToolbar = function (e) {\n        if (!isNullOrUndefined(e.args) && e.args.action !== 'enter' &&\n            e.args.action !== 'space') {\n            var pageX = void 0;\n            var pageY = void 0;\n            if (e.type !== 'Links' || isNullOrUndefined(this.parent.quickToolbarModule) ||\n                isNullOrUndefined(this.parent.quickToolbarModule.linkQTBar)) {\n                return;\n            }\n            this.quickToolObj = this.parent.quickToolbarModule;\n            var parentTop = this.parent.element.getBoundingClientRect().top;\n            var parentLeft = this.parent.element.getBoundingClientRect().left;\n            var range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n            var target_1;\n            [].forEach.call(e.elements, function (element, index) {\n                if (index === 0) {\n                    target_1 = ((element.nodeName === '#text') ? (element.parentNode) : element);\n                }\n            });\n            if (e.isNotify) {\n                var tbElement = this.parent.toolbarModule.getToolbarElement();\n                var linkTop = target_1.getBoundingClientRect().top;\n                var linkLeft = target_1.getBoundingClientRect().left;\n                var linkPos = linkTop - parentTop;\n                var tbHeight = (tbElement) ? (tbElement.offsetHeight + this.parent.toolbarModule.getExpandTBarPopHeight()) : 0;\n                pageX = (this.parent.iframeSettings.enable) ? parentLeft + linkLeft : target_1.getBoundingClientRect().left;\n                pageY = window.pageYOffset + ((this.parent.iframeSettings.enable) ?\n                    (parentTop + tbHeight + linkTop) : (parentTop + linkPos));\n            }\n            else {\n                var args = void 0;\n                args = e.args.touches ? e.args.changedTouches[0] : args = e.args;\n                pageX = (this.parent.iframeSettings.enable) ? window.pageXOffset + parentLeft + args.clientX : args.pageX;\n                pageY = (this.parent.iframeSettings.enable) ? window.pageYOffset + parentTop + args.clientY : args.pageY;\n            }\n            if (this.quickToolObj.linkQTBar) {\n                this.quickToolObj.linkQTBar.showPopup(pageX, pageY, range.endContainer, 'link');\n            }\n        }\n    };\n    Link.prototype.hideLinkQuickToolbar = function () {\n        if (this.quickToolObj && this.quickToolObj.linkQTBar && document.body.contains(this.quickToolObj.linkQTBar.element)) {\n            this.quickToolObj.linkQTBar.hidePopup();\n        }\n    };\n    Link.prototype.editAreaClickHandler = function (e) {\n        if (this.parent.readonly) {\n            this.hideLinkQuickToolbar();\n            return;\n        }\n        var args = e.args;\n        var showOnRightClick = this.parent.quickToolbarSettings.showOnRightClick;\n        if (args.which === 2 || (showOnRightClick && args.which === 1) || (!showOnRightClick && args.which === 3)) {\n            return;\n        }\n        if (this.parent.editorMode === 'HTML' && this.parent.quickToolbarModule && this.parent.quickToolbarModule.linkQTBar) {\n            this.quickToolObj = this.parent.quickToolbarModule;\n            var target = args.target;\n            target = this.getAnchorNode(target);\n            this.contentModule = this.rendererFactory.getRenderer(RenderType.Content);\n            var isPopupOpen = this.quickToolObj.linkQTBar.element.classList.contains('e-rte-pop');\n            if (target.nodeName === 'A' && (target.childNodes.length > 0 && target.childNodes[0].nodeName !== 'IMG') &&\n                e.args.target.nodeName !== 'IMG' &&\n                !isNOU(closest(this.parent.getRange().startContainer.parentElement, 'A')) && !isNOU(closest(this.parent.getRange().endContainer.parentElement, 'A'))) {\n                if (isPopupOpen) {\n                    return;\n                }\n                if (e.args.ctrlKey === false) {\n                    this.showLinkQuickToolbar({\n                        args: args,\n                        isNotify: false,\n                        type: 'Links',\n                        elements: [args.target]\n                    });\n                }\n                else {\n                    var selection = this.parent.formatter.editorManager.nodeSelection;\n                    var range = selection.getRange(this.parent.contentModule.getDocument());\n                    var args_1 = {\n                        args: {\n                            item: {\n                                subCommand: 'OpenLink',\n                                command: 'Links',\n                                name: ''\n                            },\n                            originalEvent: e.args\n                        },\n                        selectNode: selection.getNodeCollection(range),\n                        selectParent: selection.getParentNodeCollection(range),\n                        selection: selection.save(range, this.parent.contentModule.getDocument())\n                    };\n                    this.parent.notify(events.openLink, args_1);\n                }\n            }\n            else {\n                this.hideLinkQuickToolbar();\n            }\n        }\n    };\n    Link.prototype.onKeyDown = function (event) {\n        var originalEvent = event.args;\n        switch (originalEvent.action) {\n            case 'escape':\n                if (!isNullOrUndefined(this.dialogObj)) {\n                    this.dialogObj.close();\n                }\n                break;\n            case 'insert-link':\n                this.openDialog(true, event);\n                originalEvent.preventDefault();\n                break;\n        }\n    };\n    Link.prototype.openDialog = function (isInternal, event) {\n        if (!isInternal) {\n            this.parent.contentModule.getEditPanel().focus();\n        }\n        if (this.parent.editorMode === 'HTML') {\n            var range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n            var save = this.parent.formatter.editorManager.nodeSelection.save(range, this.parent.contentModule.getDocument());\n            var selectNodeEle = this.parent.formatter.editorManager.nodeSelection.getNodeCollection(range);\n            var selectParentEle = this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(range);\n            var eventArgs = {\n                args: event ? event.args : {\n                    item: { command: 'Links', subCommand: 'CreateLink' },\n                    originalEvent: undefined,\n                    name: !isInternal ? 'showDialog' : null\n                },\n                selectNode: selectNodeEle, selection: save, selectParent: selectParentEle\n            };\n            this.linkDialog(eventArgs);\n        }\n        else {\n            var textArea = this.parent.contentModule.getEditPanel();\n            this.parent.formatter.editorManager.markdownSelection.save(textArea.selectionStart, textArea.selectionEnd);\n            this.linkDialog({\n                args: {\n                    item: { command: 'Links', subCommand: 'Link' },\n                    originalEvent: event && event.args\n                },\n                member: 'link',\n                text: this.parent.formatter.editorManager.markdownSelection.getSelectedText(this.parent.contentModule.getEditPanel()),\n                module: 'Markdown',\n                name: 'insertLink'\n            });\n        }\n    };\n    Link.prototype.showDialog = function () {\n        this.openDialog(false);\n        this.setCssClass({ cssClass: this.parent.getCssClass() });\n    };\n    Link.prototype.closeDialog = function () {\n        if (this.dialogObj) {\n            this.dialogObj.hide({ returnValue: true });\n        }\n    };\n    Link.prototype.clearDialogObj = function () {\n        if (this.dialogObj) {\n            this.dialogObj.destroy();\n            detach(this.dialogObj.element);\n            this.dialogObj = null;\n        }\n    };\n    Link.prototype.linkDialog = function (e, inputDetails) {\n        var _this = this;\n        if (this.dialogObj) {\n            this.dialogObj.hide({ returnValue: true });\n            return;\n        }\n        if (this.parent.editorMode === 'HTML' && (e.selectParent.length > 0 &&\n            !isNullOrUndefined(e.selectParent[0].classList) &&\n            e.selectParent[0].classList.contains('e-rte-anchor')) && isNullOrUndefined(inputDetails)) {\n            this.editLink(e);\n            return;\n        }\n        var linkWebAddress = this.i10n.getConstant('linkWebUrl');\n        var linkDisplayText = this.i10n.getConstant('linkText');\n        var linkTooltip = this.i10n.getConstant('linkTooltipLabel');\n        var urlPlace = this.i10n.getConstant('linkurl');\n        var textPlace = this.i10n.getConstant('textPlaceholder');\n        var title = this.i10n.getConstant('linkTitle');\n        var linkDialogEle = this.parent.createElement('div', {\n            className: 'e-rte-link-dialog' + this.parent.getCssClass(true), id: this.rteID + '_rtelink'\n        });\n        this.parent.rootContainer.appendChild(linkDialogEle);\n        var linkContent = this.parent.createElement('div', {\n            className: 'e-rte-linkcontent' + this.parent.getCssClass(true), id: this.rteID + '_linkContent'\n        });\n        var htmlTextbox = (this.parent.editorMode === 'HTML') ? '<label>' + linkTooltip +\n            '</label></div><div class=\"e-rte-field' + this.parent.getCssClass(true) + '\">' +\n            '<input type=\"text\" data-role =\"none\" spellcheck=\"false\" placeholder = \"' + title + '\"aria-label=\"' + this.i10n.getConstant('linkTitle') + '\" class=\"e-input e-rte-linkTitle' + this.parent.getCssClass(true) + '\"></div>' +\n            '<div class=\"e-rte-label' + this.parent.getCssClass(true) + '\"></div>' + '<div class=\"e-rte-field' + this.parent.getCssClass(true) + '\">' +\n            '<input type=\"checkbox\" class=\"e-rte-linkTarget' + this.parent.getCssClass(true) + '\"  data-role =\"none\"></div>' : '';\n        var content = '<div class=\"e-rte-label' + this.parent.getCssClass(true) + '\"><label>' + linkWebAddress + '</label></div>' + '<div class=\"e-rte-field' + this.parent.getCssClass(true) + '\">' +\n            '<input type=\"text\" data-role =\"none\" spellcheck=\"false\" placeholder=\"' + urlPlace + '\"aria-label=\"' + this.i10n.getConstant('linkWebUrl') + '\" class=\"e-input e-rte-linkurl' + this.parent.getCssClass(true) + '\"/></div>' +\n            '<div class=\"e-rte-label' + this.parent.getCssClass(true) + '\">' + '<label>' + linkDisplayText + '</label></div><div class=\"e-rte-field' + this.parent.getCssClass(true) + '\"> ' +\n            '<input type=\"text\" data-role =\"none\" spellcheck=\"false\" class=\"e-input e-rte-linkText' + this.parent.getCssClass(true) + '\"aria-label=\"' + this.i10n.getConstant('linkText') + '\" placeholder=\"' + textPlace + '\">' +\n            '</div><div class=\"e-rte-label' + this.parent.getCssClass(true) + '\">' + htmlTextbox;\n        var contentElem = parseHtml(content);\n        linkContent.appendChild(contentElem);\n        var linkTarget = linkContent.querySelector('.e-rte-linkTarget');\n        var linkUrl = linkContent.querySelector('.e-rte-linkurl');\n        var linkText = linkContent.querySelector('.e-rte-linkText');\n        var linkTitle = linkContent.querySelector('.e-rte-linkTitle');\n        var linkOpenLabel = this.i10n.getConstant('linkOpenInNewWindow');\n        this.checkBoxObj = new CheckBox({ label: linkOpenLabel, checked: true, enableRtl: this.parent.enableRtl,\n            cssClass: this.parent.getCssClass() });\n        this.checkBoxObj.isStringTemplate = true;\n        this.checkBoxObj.createElement = this.parent.createElement;\n        this.checkBoxObj.appendTo(linkTarget);\n        var selectText = (this.parent.editorMode === 'HTML') ?\n            e.selection.getRange(this.parent.contentModule.getDocument()).toString() : e.text;\n        var linkInsert = this.i10n.getConstant('dialogInsert');\n        var linkCancel = this.i10n.getConstant('dialogCancel');\n        var selection = e.selection;\n        var selectObj = { selfLink: this, selection: e.selection, selectParent: e.selectParent, args: e.args };\n        var dialogModel = {\n            header: this.i10n.getConstant('linkHeader'),\n            content: linkContent,\n            cssClass: CLS_RTE_ELEMENTS + this.parent.getCssClass(true),\n            enableRtl: this.parent.enableRtl,\n            locale: this.parent.locale,\n            showCloseIcon: true, closeOnEscape: true, width: (Browser.isDevice) ? '290px' : '310px',\n            isModal: Browser.isDevice,\n            buttons: [{\n                    click: this.insertlink.bind(selectObj),\n                    buttonModel: { content: linkInsert, cssClass: 'e-flat e-insertLink' + this.parent.getCssClass(true), isPrimary: true }\n                },\n                { click: this.cancelDialog.bind(selectObj), buttonModel: { cssClass: 'e-flat' + this.parent.getCssClass(true), content: linkCancel } }],\n            target: (Browser.isDevice) ? document.body : this.parent.element,\n            animationSettings: { effect: 'None' },\n            close: function (event) {\n                _this.parent.isBlur = false;\n                if (event && event.event.returnValue) {\n                    if (_this.parent.editorMode === 'HTML') {\n                        selection.restore();\n                    }\n                    else {\n                        _this.parent.formatter.editorManager.markdownSelection.restore(_this.parent.contentModule.getEditPanel());\n                    }\n                }\n                _this.dialogObj.destroy();\n                detach(_this.dialogObj.element);\n                var args = _this.dialogObj;\n                _this.dialogRenderObj.close(args);\n                _this.dialogObj = null;\n            }\n        };\n        // eslint-disable-next-line\n        this.dialogObj = this.dialogRenderObj.render(dialogModel);\n        this.dialogObj.createElement = this.parent.createElement;\n        this.dialogObj.appendTo(linkDialogEle);\n        linkDialogEle.style.maxHeight = 'inherit';\n        if (isNullOrUndefined(this.dialogObj)) {\n            return;\n        }\n        if (!isNullOrUndefined(inputDetails)) {\n            linkUrl.value = inputDetails.url;\n            linkText.value = inputDetails.text;\n            linkTitle.value = inputDetails.title;\n            // eslint-disable-next-line\n            (inputDetails.target) ? this.checkBoxObj.checked = true : this.checkBoxObj.checked = false;\n            this.dialogObj.header = inputDetails.header;\n            this.dialogObj.element.querySelector('.e-insertLink').textContent = inputDetails.btnText;\n        }\n        this.checkUrl(false);\n        if ((this.parent.editorMode === 'HTML' && isNullOrUndefined(inputDetails) && ((!isNullOrUndefined(selectText)\n            && selectText !== '') && (e.selection.range.startOffset === 0) || e.selection.range.startOffset !==\n            e.selection.range.endOffset)) || e.module === 'Markdown') {\n            linkText.value = selectText;\n        }\n        this.parent.element.ownerDocument.addEventListener('mousedown', this.mouseDown);\n        if (this.quickToolObj) {\n            this.hideLinkQuickToolbar();\n            if (this.quickToolObj.inlineQTBar && document.body.contains(this.quickToolObj.inlineQTBar.element)) {\n                this.quickToolObj.inlineQTBar.hidePopup();\n            }\n            if (this.quickToolObj.textQTBar && this.parent.element.ownerDocument.body.contains(this.quickToolObj.textQTBar.element)) {\n                this.quickToolObj.textQTBar.hidePopup();\n            }\n        }\n    };\n    // eslint-disable-next-line\n    Link.prototype.insertlink = function (e) {\n        var linkEle = this.selfLink.dialogObj.element;\n        var linkUrl = linkEle.querySelector('.e-rte-linkurl').value.trim();\n        var linkText = linkEle.querySelector('.e-rte-linkText').value;\n        var linkTitle;\n        if (this.selfLink.parent.editorMode === 'HTML') {\n            linkTitle = linkEle.querySelector('.e-rte-linkTitle').value;\n        }\n        var target = (this.selfLink.checkBoxObj.checked) ? '_blank' : null;\n        var linkLabel = (this.selfLink.checkBoxObj.checked) ? this.selfLink.i10n.getConstant('linkAriaLabel') : null;\n        if (this.selfLink.parent.editorMode === 'Markdown' && linkUrl === '') {\n            linkUrl = 'http://';\n        }\n        if (linkUrl === '') {\n            this.selfLink.checkUrl(true);\n            return;\n        }\n        if (!this.selfLink.isUrl(linkUrl)) {\n            if (this.selfLink.parent.editorMode === 'Markdown') {\n                linkText = (linkText !== '') ? linkText : '';\n            }\n            else {\n                linkText = (linkText === '') ? linkUrl : linkText;\n            }\n            if (!this.selfLink.parent.enableAutoUrl) {\n                linkUrl = linkUrl.indexOf('http') > -1 ? linkUrl : 'http://' + linkUrl;\n            }\n            else {\n                // eslint-disable-next-line\n                linkUrl = linkUrl;\n            }\n        }\n        else {\n            this.selfLink.checkUrl(false);\n        }\n        var proxy = this.selfLink;\n        if (proxy.parent.editorMode === 'HTML' && isNullOrUndefined(closest(this.selection.range.startContainer.parentNode, '[id='\n            // eslint-disable-next-line\n            + \"'\" + proxy.parent.contentModule.getPanel().id + \"'\" + ']'))) {\n            proxy.parent.contentModule.getEditPanel().focus();\n            if (Browser.isIE && proxy.parent.iframeSettings.enable) {\n                this.selection.restore();\n            }\n            var range = proxy.parent.formatter.editorManager.nodeSelection.getRange(proxy.parent.contentModule.getDocument());\n            this.selection = proxy.parent.formatter.editorManager.nodeSelection.save(range, proxy.parent.contentModule.getDocument());\n            this.selectParent = proxy.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(range);\n        }\n        var value = {\n            url: linkUrl, text: linkText, title: linkTitle, target: target, ariaLabel: linkLabel,\n            selection: this.selection, selectParent: this.selectParent\n        };\n        if (document.body.contains(proxy.dialogObj.element)) {\n            this.selfLink.dialogObj.hide({ returnValue: false });\n        }\n        if (this.selfLink.dialogObj !== null) {\n            return;\n        }\n        if (isIDevice() && proxy.parent.iframeSettings.enable) {\n            select('iframe', proxy.parent.element).contentWindow.focus();\n        }\n        if (proxy.parent.editorMode === 'HTML') {\n            this.selection.restore();\n        }\n        if (proxy.parent.formatter.getUndoRedoStack().length === 0) {\n            proxy.parent.formatter.saveData();\n        }\n        var argsValue;\n        if (!isNullOrUndefined(this.args) &&\n            this.args.code === 'KeyK') {\n            var originalEvent = this.args;\n            extend(this.args, { item: { command: 'Links', subCommand: 'CreateLink' }, originalEvent: originalEvent }, true);\n            var argsVal = {\n                item: { command: 'Links', subCommand: 'CreateLink' }, originalEvent: originalEvent\n            };\n            argsValue = argsVal;\n        }\n        else {\n            argsValue = this.args;\n        }\n        this.selfLink.parent.formatter.process(this.selfLink.parent, argsValue, (!isNullOrUndefined(this.args) &&\n            this.args.originalEvent), value);\n        this.selfLink.parent.contentModule.getEditPanel().focus();\n    };\n    Link.prototype.isUrl = function (url) {\n        var regExp = RegExp;\n        var regexp = new regExp('(ftp|http|https)://(\\\\w+:{0,1}\\\\w*@)?(\\\\S+)(:[0-9]+)?(/|/([\\\\w#!:.?+=&%@\\\\-\\\\/]))?', 'gi');\n        return regexp.test(url);\n    };\n    Link.prototype.checkUrl = function (e) {\n        var linkEle = this.dialogObj.element;\n        var linkUrl = linkEle.querySelector('.e-rte-linkurl');\n        if (e) {\n            addClass([linkUrl], 'e-error');\n            linkUrl.setSelectionRange(0, linkUrl.value.length);\n            linkUrl.focus();\n        }\n        else {\n            removeClass([linkUrl], 'e-error');\n        }\n    };\n    Link.prototype.removeLink = function (e) {\n        if (this.parent.formatter.getUndoRedoStack().length === 0) {\n            this.parent.formatter.saveData();\n        }\n        var selectParentEle = this.getAnchorNode(e.selectParent[0]);\n        this.parent.formatter.process(this.parent, e.args, e.args, {\n            selectNode: e.selectNode, selectParent: e.selectParent, selection: e.selection,\n            text: selectParentEle.innerText,\n            subCommand: e.args.item.subCommand\n        });\n        if (isIDevice() && this.parent.iframeSettings.enable) {\n            select('iframe', this.parent.element).contentWindow.focus();\n        }\n        else {\n            this.parent.contentModule.getEditPanel().focus();\n        }\n        this.hideLinkQuickToolbar();\n    };\n    Link.prototype.openLink = function (e) {\n        var selectParentEle = this.getAnchorNode(e.selectParent[0]);\n        if (selectParentEle.classList.contains('e-rte-anchor') || selectParentEle.tagName === 'A') {\n            var sanitizedHTML = this.parent.htmlEditorModule.sanitizeHelper(selectParentEle.outerHTML);\n            var tempEle = document.createElement('div');\n            tempEle.innerHTML = sanitizedHTML;\n            this.parent.formatter.process(this.parent, e.args, e.args, {\n                url: tempEle.firstChild.href, text: selectParentEle.innerText,\n                target: selectParentEle.target === '' ? '_self' : '_blank', selectNode: e.selectNode,\n                subCommand: e.args.item.subCommand\n            });\n            tempEle.remove();\n        }\n    };\n    Link.prototype.getAnchorNode = function (element) {\n        var selectParent = closest(element, 'a');\n        return (selectParent ? selectParent : element);\n    };\n    Link.prototype.editLink = function (e) {\n        var selectedNode = this.getAnchorNode(e.selectNode[0]);\n        var selectParentEle = this.getAnchorNode(e.selectParent[0]);\n        selectParentEle = selectedNode.nodeName === 'A' ? selectedNode : selectParentEle;\n        if (selectParentEle.classList.contains('e-rte-anchor') || selectParentEle.tagName === 'A') {\n            var linkUpdate = this.i10n.getConstant('dialogUpdate');\n            var inputDetails = {\n                url: selectParentEle.getAttribute('href'), text: selectParentEle.innerText,\n                title: selectParentEle.title, target: selectParentEle.target,\n                header: this.i10n.getConstant('editLink'), btnText: linkUpdate\n            };\n            this.linkDialog(e, inputDetails);\n        }\n    };\n    // eslint-disable-next-line\n    Link.prototype.cancelDialog = function (e) {\n        this.selfLink.parent.isBlur = false;\n        this.selfLink.dialogObj.hide({ returnValue: true });\n        if (isIDevice()) {\n            this.selection.restore();\n        }\n        else {\n            var x = window.scrollX;\n            var y = window.scrollY;\n            this.selfLink.parent.contentModule.getEditPanel().focus();\n            window.scrollTo(x, y);\n        }\n    };\n    Link.prototype.onDocumentClick = function (e) {\n        var target = e.target;\n        if (!isNullOrUndefined(this.dialogObj) && ((\n        // eslint-disable-next-line\n        !closest(target, '[id=' + \"'\" + this.dialogObj.element.id + \"'\" + ']') && this.parent.toolbarSettings.enable &&\n            this.parent.getToolbarElement() && !this.parent.getToolbarElement().contains(e.target)) ||\n            (((this.parent.getToolbarElement() && this.parent.getToolbarElement().contains(e.target)) ||\n                this.parent.inlineMode.enable && !closest(target, '#' + this.dialogObj.element.id)) &&\n                !closest(target, '#' + this.parent.getID() + '_toolbar_CreateLink') &&\n                !target.querySelector('#' + this.parent.getID() + '_toolbar_CreateLink')))) {\n            this.parent.notify(events.documentClickClosedBy, { closedBy: 'outside click' });\n            this.dialogObj.hide({ returnValue: true });\n            this.parent.element.ownerDocument.removeEventListener('mousedown', this.mouseDown);\n            this.mouseDown = null;\n            this.parent.isBlur = true;\n            dispatchEvent(this.parent.element, 'focusout');\n        }\n    };\n    /**\n     * Destroys the ToolBar.\n     *\n     * @function destroy\n     * @returns {void}\n     * @hidden\n\n     */\n    Link.prototype.destroy = function () {\n        if (this.isDestroyed) {\n            return;\n        }\n        this.parent.element.ownerDocument.removeEventListener('mousedown', this.mouseDown);\n        this.mouseDown = null;\n        this.removeEventListener();\n        this.isDestroyed = true;\n    };\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @returns {void}\n     */\n    Link.prototype.getModuleName = function () {\n        return 'link';\n    };\n    return Link;\n}());\nexport { Link };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}