{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport * as CONSTANT from './../base/constant';\nimport { NodeSelection } from '../../selection/selection';\nimport { NodeCutter } from './nodecutter';\nimport { InsertHtml } from './inserthtml';\nimport { createElement, isNullOrUndefined as isNOU, closest } from '@syncfusion/ej2-base';\nimport * as EVENTS from './../../common/constant';\n/**\n * Link internal component\n *\n * @hidden\n\n */\nvar LinkCommand = /** @class */function () {\n  /**\n   * Constructor for creating the Formats plugin\n   *\n   * @param {EditorManager} parent - specifies the editor manager\n   * @hidden\n    */\n  function LinkCommand(parent) {\n    this.parent = parent;\n    this.addEventListener();\n  }\n  LinkCommand.prototype.addEventListener = function () {\n    this.parent.observer.on(CONSTANT.LINK, this.linkCommand, this);\n    this.parent.observer.on(EVENTS.INTERNAL_DESTROY, this.destroy, this);\n  };\n  LinkCommand.prototype.removeEventListener = function () {\n    this.parent.observer.off(CONSTANT.LINK, this.linkCommand);\n    this.parent.observer.off(EVENTS.INTERNAL_DESTROY, this.destroy);\n  };\n  LinkCommand.prototype.linkCommand = function (e) {\n    switch (e.value.toString().toLocaleLowerCase()) {\n      case 'createlink':\n      case 'editlink':\n        this.createLink(e);\n        break;\n      case 'openlink':\n        this.openLink(e);\n        break;\n      case 'removelink':\n        this.removeLink(e);\n        break;\n    }\n  };\n  LinkCommand.prototype.createLink = function (e) {\n    var closestAnchor = !isNOU(e.item.selectParent) && e.item.selectParent.length > 0 && closest(e.item.selectParent[0], 'a');\n    closestAnchor = !isNOU(closestAnchor) ? closestAnchor : !isNOU(e.item.selectParent) && e.item.selectParent.length > 0 ? e.item.selectParent[0] : null;\n    if (!isNOU(closestAnchor) && closestAnchor.tagName === 'A') {\n      var anchorEle = closestAnchor;\n      var linkText = '';\n      if (!isNOU(e.item.url)) {\n        anchorEle.setAttribute('href', e.item.url);\n      }\n      if (!isNOU(e.item.title)) {\n        anchorEle.setAttribute('title', e.item.title);\n      }\n      if (!isNOU(e.item.text) && e.item.text !== '') {\n        linkText = anchorEle.innerText;\n        if (anchorEle.firstChild.nodeName === '#text') {\n          anchorEle.innerText = e.item.text;\n        } else {\n          anchorEle.firstChild.innerText = e.item.text;\n        }\n      }\n      if (!isNOU(e.item.target)) {\n        anchorEle.setAttribute('target', e.item.target);\n        anchorEle.setAttribute('aria-label', e.item.ariaLabel);\n      } else {\n        anchorEle.removeAttribute('target');\n        anchorEle.removeAttribute('aria-label');\n      }\n      if (linkText === e.item.text) {\n        e.item.selection.setSelectionText(this.parent.currentDocument, anchorEle, anchorEle, 1, 1);\n        e.item.selection.restore();\n      } else {\n        var startIndex = e.item.action === 'Paste' ? anchorEle.childNodes[0].textContent.length : 0;\n        var endIndex = anchorEle.firstChild.nodeName === '#text' ? anchorEle.childNodes[0].textContent.length : anchorEle.childNodes.length;\n        e.item.selection.setSelectionText(this.parent.currentDocument, anchorEle.childNodes[0], anchorEle.childNodes[0], startIndex, endIndex);\n      }\n    } else {\n      var domSelection = new NodeSelection(this.parent.editableElement);\n      var range = domSelection.getRange(this.parent.currentDocument);\n      if (range.endContainer.nodeName === '#text' && range.startContainer.textContent.length === range.endOffset + 1 && range.endContainer.textContent.charAt(range.endOffset) === ' ' && !isNOU(range.endContainer.nextSibling) && range.endContainer.nextSibling.nodeName === 'A') {\n        domSelection.setSelectionText(this.parent.currentDocument, range.startContainer, range.endContainer, range.startOffset, range.endOffset + 1);\n        range = domSelection.getRange(this.parent.currentDocument);\n      }\n      var text = isNOU(e.item.text) ? true : e.item.text.replace(/ /g, '').localeCompare(range.toString().replace(/\\n/g, ' ').replace(/ /g, '')) < 0;\n      if (e.event && e.event.type === 'keydown' && (e.event.keyCode === 32 || e.event.keyCode === 13) || e.item.action === 'Paste' || range.collapsed || text) {\n        var anchor = this.createAchorNode(e);\n        anchor.innerText = e.item.text === '' ? e.item.url : e.item.text;\n        var text_1 = anchor.innerText;\n        // Replace spaces with non-breaking spaces\n        var modifiedText = text_1.replace(/  +/g, function (match) {\n          return '\\u00A0'.repeat(match.length);\n        });\n        anchor.innerText = modifiedText;\n        e.item.selection.restore();\n        InsertHtml.Insert(this.parent.currentDocument, anchor, this.parent.editableElement);\n        if (e.event && e.event.type === 'keydown' && (e.event.keyCode === 32 || e.event.keyCode === 13)) {\n          var startContainer = e.item.selection.range.startContainer;\n          startContainer.textContent = this.removeText(startContainer.textContent, e.item.text);\n        } else {\n          var startIndex = e.item.action === 'Paste' ? anchor.childNodes[0].textContent.length : 0;\n          e.item.selection.setSelectionText(this.parent.currentDocument, anchor.childNodes[0], anchor.childNodes[0], startIndex, anchor.childNodes[0].textContent.length);\n        }\n      } else {\n        this.createLinkNode(e);\n      }\n    }\n    if (e.callBack) {\n      e.callBack({\n        requestType: 'Links',\n        editorMode: 'HTML',\n        event: e.event,\n        range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n        elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n      });\n    }\n  };\n  LinkCommand.prototype.createLinkNode = function (e) {\n    var domSelection = new NodeSelection(this.parent.editableElement);\n    var nodeCutter = new NodeCutter();\n    var range = domSelection.getRange(this.parent.currentDocument);\n    var nodes = this.getSelectionNodes(domSelection.getNodeCollection(range));\n    var save = domSelection.save(range, this.parent.currentDocument);\n    var txtArray = [];\n    var inlineNodes = [];\n    var currentNode;\n    var removeNodes = [];\n    var anchorNodes = [];\n    var finalinlineNodes = [];\n    var cloneNode;\n    for (var index = 0; index < nodes.length; index++) {\n      nodes[index] = nodeCutter.GetSpliceNode(range, nodes[index]);\n      txtArray[index] = nodes[index];\n    }\n    for (var i = 0; i < txtArray.length; i++) {\n      var check = true;\n      currentNode = txtArray[i];\n      while (check === true) {\n        if (currentNode.parentNode.nodeName === 'A') {\n          var anchorEle = currentNode.parentNode;\n          currentNode.parentNode.parentNode.insertBefore(anchorEle.firstChild, anchorEle);\n          currentNode.parentNode.removeChild(anchorEle);\n        }\n        if (this.isBlockNode(currentNode.parentNode) || txtArray.length === 0 || i === 0 || i === txtArray.length - 1 || range.startContainer.nodeType === 3) {\n          inlineNodes[i] = currentNode;\n          check = false;\n        } else {\n          currentNode = currentNode.parentNode;\n        }\n      }\n    }\n    for (var i = 0, j_1 = 0; i < inlineNodes.length; i++) {\n      if (i === 0) {\n        finalinlineNodes[j_1] = inlineNodes[i];\n      }\n      if (inlineNodes.length > 1 && i < inlineNodes.length - 1) {\n        if (inlineNodes[i].parentElement === inlineNodes[i + 1].parentElement && inlineNodes[i] === inlineNodes[i + 1]) {\n          continue;\n        } else {\n          finalinlineNodes[j_1 + 1] = inlineNodes[i + 1];\n          j_1++;\n        }\n      }\n    }\n    var j = 0;\n    anchorNodes[j] = this.createAchorNode(e);\n    for (var i = 0; i < finalinlineNodes.length; i++) {\n      if (i === 0) {\n        cloneNode = finalinlineNodes[i].cloneNode(true);\n        anchorNodes[i].appendChild(cloneNode);\n      }\n      if (i < finalinlineNodes.length - 1) {\n        if (finalinlineNodes[i].parentNode === finalinlineNodes[i + 1].parentNode) {\n          var cln = finalinlineNodes[i + 1].cloneNode(true);\n          anchorNodes[j].appendChild(cln);\n        } else {\n          j = j + 1;\n          anchorNodes[j] = this.createAchorNode(e);\n          cloneNode = finalinlineNodes[i + 1].cloneNode(true);\n          anchorNodes[j].appendChild(cloneNode);\n        }\n      }\n    }\n    this.parent.nodeSelection.setRange(document, save.range);\n    for (var i = 0, j_2 = 0, k = 0; i <= finalinlineNodes.length; i++) {\n      if (i === 0) {\n        finalinlineNodes[i].parentNode.insertBefore(anchorNodes[j_2], finalinlineNodes[i].nextSibling);\n        if (this.parent.domNode.blockNodes().length === 1 && anchorNodes.length === 1) {\n          this.parent.nodeSelection.setSelectionNode(this.parent.currentDocument, anchorNodes[j_2]);\n        }\n        removeNodes[k] = finalinlineNodes[i];\n        k++;\n      }\n      if (i < finalinlineNodes.length - 1) {\n        if (finalinlineNodes[i].parentNode === finalinlineNodes[i + 1].parentNode) {\n          removeNodes[k] = finalinlineNodes[i + 1];\n          k++;\n        } else {\n          j_2 = j_2 + 1;\n          finalinlineNodes[i + 1].parentNode.insertBefore(anchorNodes[j_2], finalinlineNodes[i + 1]);\n          removeNodes[k] = finalinlineNodes[i + 1];\n          k++;\n        }\n      }\n    }\n    for (var i = 0; i < removeNodes.length; i++) {\n      if (removeNodes[i].parentNode) {\n        removeNodes[i].parentNode.removeChild(removeNodes[i]);\n      }\n    }\n  };\n  LinkCommand.prototype.createAchorNode = function (e) {\n    var anchorEle = createElement('a', {\n      className: 'e-rte-anchor',\n      attrs: {\n        href: e.item.url,\n        title: isNOU(e.item.title) || e.item.title === '' ? e.item.url : e.item.title\n      }\n    });\n    if (!isNOU(e.item.target)) {\n      anchorEle.setAttribute('target', e.item.target);\n    }\n    if (!isNOU(e.item.ariaLabel)) {\n      anchorEle.setAttribute('aria-label', e.item.ariaLabel);\n    }\n    return anchorEle;\n  };\n  LinkCommand.prototype.getSelectionNodes = function (nodeCollection) {\n    nodeCollection = nodeCollection.reverse();\n    for (var index = 0; index < nodeCollection.length; index++) {\n      if (nodeCollection[index].nodeType !== 3 || nodeCollection[index].textContent.trim() === '') {\n        if (nodeCollection[index].nodeName !== 'IMG') {\n          nodeCollection.splice(index, 1);\n          index--;\n        }\n      }\n    }\n    return nodeCollection.reverse();\n  };\n  LinkCommand.prototype.isBlockNode = function (element) {\n    return !!element && element.nodeType === Node.ELEMENT_NODE && CONSTANT.BLOCK_TAGS.indexOf(element.tagName.toLowerCase()) >= 0;\n  };\n  LinkCommand.prototype.removeText = function (text, val) {\n    var arr = text.split(' ');\n    for (var i = 0; i < arr.length; i++) {\n      if (arr[i] === val) {\n        arr.splice(i, 1);\n        i--;\n      }\n    }\n    return arr.join(' ') + ' ';\n  };\n  LinkCommand.prototype.openLink = function (e) {\n    document.defaultView.open(e.item.url, e.item.target);\n    this.callBack(e);\n  };\n  LinkCommand.prototype.removeLink = function (e) {\n    var blockNodes = this.parent.domNode.blockNodes();\n    if (blockNodes.length < 2) {\n      this.parent.domNode.setMarker(e.item.selection);\n      var closestAnchor = closest(e.item.selectParent[0], 'a');\n      var selectParent = closestAnchor ? closestAnchor : e.item.selectParent[0];\n      var parent_1 = selectParent.parentNode;\n      var child = [];\n      for (; selectParent.firstChild; null) {\n        if (parent_1) {\n          child.push(parent_1.insertBefore(selectParent.firstChild, selectParent));\n        } else {\n          break;\n        }\n      }\n      parent_1.removeChild(selectParent);\n      if (child && child.length === 1) {\n        e.item.selection.startContainer = e.item.selection.getNodeArray(child[child.length - 1], true);\n        e.item.selection.endContainer = e.item.selection.startContainer;\n      }\n      e.item.selection = this.parent.domNode.saveMarker(e.item.selection);\n    } else {\n      for (var i = 0; i < blockNodes.length; i++) {\n        var linkNode = blockNodes[i].querySelectorAll('a');\n        for (var j = 0; j < linkNode.length; j++) {\n          if (this.parent.currentDocument.getSelection().containsNode(linkNode[j], true)) {\n            linkNode[j].outerHTML = linkNode[j].innerHTML;\n          }\n        }\n      }\n    }\n    e.item.selection.restore();\n    this.callBack(e);\n  };\n  LinkCommand.prototype.callBack = function (e) {\n    if (e.callBack) {\n      e.callBack({\n        requestType: e.item.subCommand,\n        editorMode: 'HTML',\n        event: e.event,\n        range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n        elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n      });\n    }\n  };\n  LinkCommand.prototype.destroy = function () {\n    this.removeEventListener();\n  };\n  return LinkCommand;\n}();\nexport { LinkCommand };","map":{"version":3,"names":["CONSTANT","NodeSelection","NodeCutter","InsertHtml","createElement","isNullOrUndefined","isNOU","closest","EVENTS","LinkCommand","parent","addEventListener","prototype","observer","on","LINK","linkCommand","INTERNAL_DESTROY","destroy","removeEventListener","off","e","value","toString","toLocaleLowerCase","createLink","openLink","removeLink","closestAnchor","item","selectParent","length","tagName","anchorEle","linkText","url","setAttribute","title","text","innerText","firstChild","nodeName","target","ariaLabel","removeAttribute","selection","setSelectionText","currentDocument","restore","startIndex","action","childNodes","textContent","endIndex","domSelection","editableElement","range","getRange","endContainer","startContainer","endOffset","charAt","nextSibling","startOffset","replace","localeCompare","event","type","keyCode","collapsed","anchor","createAchorNode","text_1","modifiedText","match","repeat","Insert","removeText","createLinkNode","callBack","requestType","editorMode","nodeSelection","elements","getSelectedNodes","nodeCutter","nodes","getSelectionNodes","getNodeCollection","save","txtArray","inlineNodes","currentNode","removeNodes","anchorNodes","finalinlineNodes","cloneNode","index","GetSpliceNode","i","check","parentNode","insertBefore","removeChild","isBlockNode","nodeType","j_1","parentElement","j","appendChild","cln","setRange","document","j_2","k","domNode","blockNodes","setSelectionNode","className","attrs","href","nodeCollection","reverse","trim","splice","element","Node","ELEMENT_NODE","BLOCK_TAGS","indexOf","toLowerCase","val","arr","split","join","defaultView","open","setMarker","parent_1","child","push","getNodeArray","saveMarker","linkNode","querySelectorAll","getSelection","containsNode","outerHTML","innerHTML","subCommand"],"sources":["/var/www/vue/vue-gantt-chart/node_modules/@syncfusion/ej2-richtexteditor/src/editor-manager/plugin/link.js"],"sourcesContent":["import * as CONSTANT from './../base/constant';\nimport { NodeSelection } from '../../selection/selection';\nimport { NodeCutter } from './nodecutter';\nimport { InsertHtml } from './inserthtml';\nimport { createElement, isNullOrUndefined as isNOU, closest } from '@syncfusion/ej2-base';\nimport * as EVENTS from './../../common/constant';\n/**\n * Link internal component\n *\n * @hidden\n\n */\nvar LinkCommand = /** @class */ (function () {\n    /**\n     * Constructor for creating the Formats plugin\n     *\n     * @param {EditorManager} parent - specifies the editor manager\n     * @hidden\n\n     */\n    function LinkCommand(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    LinkCommand.prototype.addEventListener = function () {\n        this.parent.observer.on(CONSTANT.LINK, this.linkCommand, this);\n        this.parent.observer.on(EVENTS.INTERNAL_DESTROY, this.destroy, this);\n    };\n    LinkCommand.prototype.removeEventListener = function () {\n        this.parent.observer.off(CONSTANT.LINK, this.linkCommand);\n        this.parent.observer.off(EVENTS.INTERNAL_DESTROY, this.destroy);\n    };\n    LinkCommand.prototype.linkCommand = function (e) {\n        switch (e.value.toString().toLocaleLowerCase()) {\n            case 'createlink':\n            case 'editlink':\n                this.createLink(e);\n                break;\n            case 'openlink':\n                this.openLink(e);\n                break;\n            case 'removelink':\n                this.removeLink(e);\n                break;\n        }\n    };\n    LinkCommand.prototype.createLink = function (e) {\n        var closestAnchor = (!isNOU(e.item.selectParent) && e.item.selectParent.length > 0) &&\n            closest(e.item.selectParent[0], 'a');\n        closestAnchor = !isNOU(closestAnchor) ? closestAnchor :\n            (!isNOU(e.item.selectParent) && e.item.selectParent.length > 0) ? (e.item.selectParent[0]) : null;\n        if (!isNOU(closestAnchor) && closestAnchor.tagName === 'A') {\n            var anchorEle = closestAnchor;\n            var linkText = '';\n            if (!isNOU(e.item.url)) {\n                anchorEle.setAttribute('href', e.item.url);\n            }\n            if (!isNOU(e.item.title)) {\n                anchorEle.setAttribute('title', e.item.title);\n            }\n            if (!isNOU(e.item.text) && e.item.text !== '') {\n                linkText = anchorEle.innerText;\n                if (anchorEle.firstChild.nodeName === '#text') {\n                    anchorEle.innerText = e.item.text;\n                }\n                else {\n                    anchorEle.firstChild.innerText = e.item.text;\n                }\n            }\n            if (!isNOU(e.item.target)) {\n                anchorEle.setAttribute('target', e.item.target);\n                anchorEle.setAttribute('aria-label', e.item.ariaLabel);\n            }\n            else {\n                anchorEle.removeAttribute('target');\n                anchorEle.removeAttribute('aria-label');\n            }\n            if (linkText === e.item.text) {\n                e.item.selection.setSelectionText(this.parent.currentDocument, anchorEle, anchorEle, 1, 1);\n                e.item.selection.restore();\n            }\n            else {\n                var startIndex = e.item.action === 'Paste' ? anchorEle.childNodes[0].textContent.length : 0;\n                var endIndex = anchorEle.firstChild.nodeName === '#text' ? anchorEle.childNodes[0].textContent.length : anchorEle.childNodes.length;\n                e.item.selection.setSelectionText(this.parent.currentDocument, anchorEle.childNodes[0], anchorEle.childNodes[0], startIndex, endIndex);\n            }\n        }\n        else {\n            var domSelection = new NodeSelection(this.parent.editableElement);\n            var range = domSelection.getRange(this.parent.currentDocument);\n            if (range.endContainer.nodeName === '#text' && range.startContainer.textContent.length === (range.endOffset + 1) &&\n                range.endContainer.textContent.charAt(range.endOffset) === ' ' && (!isNOU(range.endContainer.nextSibling) && range.endContainer.nextSibling.nodeName === 'A')) {\n                domSelection.setSelectionText(this.parent.currentDocument, range.startContainer, range.endContainer, range.startOffset, range.endOffset + 1);\n                range = domSelection.getRange(this.parent.currentDocument);\n            }\n            var text = isNOU(e.item.text) ? true : e.item.text.replace(/ /g, '').localeCompare(range.toString()\n                .replace(/\\n/g, ' ').replace(/ /g, '')) < 0;\n            if (e.event && e.event.type === 'keydown' && (e.event.keyCode === 32\n                || e.event.keyCode === 13) || e.item.action === 'Paste' || range.collapsed || text) {\n                var anchor = this.createAchorNode(e);\n                anchor.innerText = e.item.text === '' ? e.item.url : e.item.text;\n                var text_1 = anchor.innerText;\n                // Replace spaces with non-breaking spaces\n                var modifiedText = text_1.replace(/  +/g, function (match) {\n                    return '\\u00A0'.repeat(match.length);\n                });\n                anchor.innerText = modifiedText;\n                e.item.selection.restore();\n                InsertHtml.Insert(this.parent.currentDocument, anchor, this.parent.editableElement);\n                if (e.event && e.event.type === 'keydown' && (e.event.keyCode === 32\n                    || e.event.keyCode === 13)) {\n                    var startContainer = e.item.selection.range.startContainer;\n                    startContainer.textContent = this.removeText(startContainer.textContent, e.item.text);\n                }\n                else {\n                    var startIndex = e.item.action === 'Paste' ? anchor.childNodes[0].textContent.length : 0;\n                    e.item.selection.setSelectionText(this.parent.currentDocument, anchor.childNodes[0], anchor.childNodes[0], startIndex, anchor.childNodes[0].textContent.length);\n                }\n            }\n            else {\n                this.createLinkNode(e);\n            }\n        }\n        if (e.callBack) {\n            e.callBack({\n                requestType: 'Links',\n                editorMode: 'HTML',\n                event: e.event,\n                range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n                elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n            });\n        }\n    };\n    LinkCommand.prototype.createLinkNode = function (e) {\n        var domSelection = new NodeSelection(this.parent.editableElement);\n        var nodeCutter = new NodeCutter();\n        var range = domSelection.getRange(this.parent.currentDocument);\n        var nodes = this.getSelectionNodes(domSelection.getNodeCollection(range));\n        var save = domSelection.save(range, this.parent.currentDocument);\n        var txtArray = [];\n        var inlineNodes = [];\n        var currentNode;\n        var removeNodes = [];\n        var anchorNodes = [];\n        var finalinlineNodes = [];\n        var cloneNode;\n        for (var index = 0; index < nodes.length; index++) {\n            nodes[index] = nodeCutter.GetSpliceNode(range, nodes[index]);\n            txtArray[index] = nodes[index];\n        }\n        for (var i = 0; i < txtArray.length; i++) {\n            var check = true;\n            currentNode = txtArray[i];\n            while (check === true) {\n                if (currentNode.parentNode.nodeName === 'A') {\n                    var anchorEle = currentNode.parentNode;\n                    currentNode.parentNode.parentNode.insertBefore(anchorEle.firstChild, anchorEle);\n                    currentNode.parentNode.removeChild(anchorEle);\n                }\n                if (this.isBlockNode(currentNode.parentNode) || txtArray.length === 0 || i === 0 || i === txtArray.length - 1\n                    || range.startContainer.nodeType === 3) {\n                    inlineNodes[i] = currentNode;\n                    check = false;\n                }\n                else {\n                    currentNode = currentNode.parentNode;\n                }\n            }\n        }\n        for (var i = 0, j_1 = 0; i < inlineNodes.length; i++) {\n            if (i === 0) {\n                finalinlineNodes[j_1] = inlineNodes[i];\n            }\n            if (inlineNodes.length > 1 && i < inlineNodes.length - 1) {\n                if ((inlineNodes[i].parentElement === inlineNodes[i + 1].parentElement) &&\n                    (inlineNodes[i] === inlineNodes[i + 1])) {\n                    continue;\n                }\n                else {\n                    finalinlineNodes[j_1 + 1] = inlineNodes[i + 1];\n                    j_1++;\n                }\n            }\n        }\n        var j = 0;\n        anchorNodes[j] = this.createAchorNode(e);\n        for (var i = 0; i < finalinlineNodes.length; i++) {\n            if (i === 0) {\n                cloneNode = finalinlineNodes[i].cloneNode(true);\n                anchorNodes[i].appendChild(cloneNode);\n            }\n            if (i < finalinlineNodes.length - 1) {\n                if (finalinlineNodes[i].parentNode === finalinlineNodes[i + 1].parentNode) {\n                    var cln = finalinlineNodes[i + 1].cloneNode(true);\n                    anchorNodes[j].appendChild(cln);\n                }\n                else {\n                    j = j + 1;\n                    anchorNodes[j] = this.createAchorNode(e);\n                    cloneNode = finalinlineNodes[i + 1].cloneNode(true);\n                    anchorNodes[j].appendChild(cloneNode);\n                }\n            }\n        }\n        this.parent.nodeSelection.setRange(document, save.range);\n        for (var i = 0, j_2 = 0, k = 0; i <= finalinlineNodes.length; i++) {\n            if (i === 0) {\n                finalinlineNodes[i].parentNode.insertBefore(anchorNodes[j_2], finalinlineNodes[i].nextSibling);\n                if (this.parent.domNode.blockNodes().length === 1 && anchorNodes.length === 1) {\n                    this.parent.nodeSelection.setSelectionNode(this.parent.currentDocument, anchorNodes[j_2]);\n                }\n                removeNodes[k] = finalinlineNodes[i];\n                k++;\n            }\n            if (i < finalinlineNodes.length - 1) {\n                if (finalinlineNodes[i].parentNode === finalinlineNodes[i + 1].parentNode) {\n                    removeNodes[k] = finalinlineNodes[i + 1];\n                    k++;\n                }\n                else {\n                    j_2 = j_2 + 1;\n                    finalinlineNodes[i + 1].parentNode.insertBefore(anchorNodes[j_2], finalinlineNodes[i + 1]);\n                    removeNodes[k] = finalinlineNodes[i + 1];\n                    k++;\n                }\n            }\n        }\n        for (var i = 0; i < removeNodes.length; i++) {\n            if (removeNodes[i].parentNode) {\n                removeNodes[i].parentNode.removeChild(removeNodes[i]);\n            }\n        }\n    };\n    LinkCommand.prototype.createAchorNode = function (e) {\n        var anchorEle = createElement('a', {\n            className: 'e-rte-anchor',\n            attrs: {\n                href: e.item.url,\n                title: isNOU(e.item.title) || e.item.title === '' ? e.item.url : e.item.title\n            }\n        });\n        if (!isNOU(e.item.target)) {\n            anchorEle.setAttribute('target', e.item.target);\n        }\n        if (!isNOU(e.item.ariaLabel)) {\n            anchorEle.setAttribute('aria-label', e.item.ariaLabel);\n        }\n        return anchorEle;\n    };\n    LinkCommand.prototype.getSelectionNodes = function (nodeCollection) {\n        nodeCollection = nodeCollection.reverse();\n        for (var index = 0; index < nodeCollection.length; index++) {\n            if (nodeCollection[index].nodeType !== 3 || nodeCollection[index].textContent.trim() === '') {\n                if (nodeCollection[index].nodeName !== 'IMG') {\n                    nodeCollection.splice(index, 1);\n                    index--;\n                }\n            }\n        }\n        return nodeCollection.reverse();\n    };\n    LinkCommand.prototype.isBlockNode = function (element) {\n        return (!!element && (element.nodeType === Node.ELEMENT_NODE && CONSTANT.BLOCK_TAGS.indexOf(element.tagName.toLowerCase()) >= 0));\n    };\n    LinkCommand.prototype.removeText = function (text, val) {\n        var arr = text.split(' ');\n        for (var i = 0; i < arr.length; i++) {\n            if (arr[i] === val) {\n                arr.splice(i, 1);\n                i--;\n            }\n        }\n        return arr.join(' ') + ' ';\n    };\n    LinkCommand.prototype.openLink = function (e) {\n        document.defaultView.open(e.item.url, e.item.target);\n        this.callBack(e);\n    };\n    LinkCommand.prototype.removeLink = function (e) {\n        var blockNodes = this.parent.domNode.blockNodes();\n        if (blockNodes.length < 2) {\n            this.parent.domNode.setMarker(e.item.selection);\n            var closestAnchor = closest(e.item.selectParent[0], 'a');\n            var selectParent = closestAnchor ? closestAnchor : e.item.selectParent[0];\n            var parent_1 = selectParent.parentNode;\n            var child = [];\n            for (; selectParent.firstChild; null) {\n                if (parent_1) {\n                    child.push(parent_1.insertBefore(selectParent.firstChild, selectParent));\n                }\n                else {\n                    break;\n                }\n            }\n            parent_1.removeChild(selectParent);\n            if (child && child.length === 1) {\n                e.item.selection.startContainer = e.item.selection.getNodeArray(child[child.length - 1], true);\n                e.item.selection.endContainer = e.item.selection.startContainer;\n            }\n            e.item.selection = this.parent.domNode.saveMarker(e.item.selection);\n        }\n        else {\n            for (var i = 0; i < blockNodes.length; i++) {\n                var linkNode = blockNodes[i].querySelectorAll('a');\n                for (var j = 0; j < linkNode.length; j++) {\n                    if (this.parent.currentDocument.getSelection().containsNode(linkNode[j], true)) {\n                        linkNode[j].outerHTML = linkNode[j].innerHTML;\n                    }\n                }\n            }\n        }\n        e.item.selection.restore();\n        this.callBack(e);\n    };\n    LinkCommand.prototype.callBack = function (e) {\n        if (e.callBack) {\n            e.callBack({\n                requestType: e.item.subCommand,\n                editorMode: 'HTML',\n                event: e.event,\n                range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n                elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n            });\n        }\n    };\n    LinkCommand.prototype.destroy = function () {\n        this.removeEventListener();\n    };\n    return LinkCommand;\n}());\nexport { LinkCommand };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}