{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.for-each.js\";\nimport \"core-js/modules/esnext.iterator.take.js\";\nimport { extend, isNullOrUndefined, setValue, getValue, addClass, removeClass } from '@syncfusion/ej2-base';\nimport { DataManager, Query, DataUtil } from '@syncfusion/ej2-data';\nimport { showSpinner, hideSpinner } from '@syncfusion/ej2-popups';\nimport { getObject, getUid } from '@syncfusion/ej2-grids';\nimport { isRemoteData, isOffline, isCountRequired, getExpandStatus } from '../utils';\nimport * as events from './constant';\n/**\n * Internal dataoperations for tree grid\n *\n * @hidden\n */\nvar DataManipulation = /** @class */function () {\n  function DataManipulation(grid) {\n    this.addedRecords = 'addedRecords';\n    this.parent = grid;\n    this.parentItems = [];\n    this.taskIds = [];\n    this.hierarchyData = [];\n    this.storedIndex = -1;\n    this.sortedData = [];\n    this.isSortAction = false;\n    this.addEventListener();\n    this.dataResults = {};\n    this.isSelfReference = !isNullOrUndefined(this.parent.parentIdMapping);\n  }\n  /**\n   * @hidden\n   * @returns {void}\n   */\n  DataManipulation.prototype.addEventListener = function () {\n    this.parent.on('updateRemoteLevel', this.updateParentRemoteData, this);\n    this.parent.grid.on('sorting-begin', this.beginSorting, this);\n    this.parent.on('updateAction', this.updateData, this);\n    this.parent.on(events.remoteExpand, this.collectExpandingRecs, this);\n    this.parent.on('dataProcessor', this.dataProcessor, this);\n  };\n  /**\n   * @hidden\n   * @returns {void}\n   */\n  DataManipulation.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    this.parent.off(events.remoteExpand, this.collectExpandingRecs);\n    this.parent.off('updateRemoteLevel', this.updateParentRemoteData);\n    this.parent.off('updateAction', this.updateData);\n    this.parent.off('dataProcessor', this.dataProcessor);\n    this.parent.grid.off('sorting-begin', this.beginSorting);\n  };\n  /**\n   * To destroy the dataModule\n   *\n   * @returns {void}\n   * @hidden\n   */\n  DataManipulation.prototype.destroy = function () {\n    this.removeEventListener();\n  };\n  /**\n   * @hidden\n   * @returns {boolean} -Returns whether remote data binding\n   */\n  DataManipulation.prototype.isRemote = function () {\n    if (!(this.parent.dataSource instanceof DataManager)) {\n      return false;\n    }\n    return true;\n    // let gridData:  DataManager = <DataManager>this.parent.dataSource;\n    // return gridData.dataSource.offline !== true && gridData.dataSource.url !== undefined;\n  };\n  /**\n   * Function to manipulate datasource\n   *\n   * @param {Object} data - Provide tree grid datasource to convert to flat data\n   * @hidden\n   * @returns {void}\n   */\n  DataManipulation.prototype.convertToFlatData = function (data) {\n    var _this = this;\n    this.parent.flatData = !isNullOrUndefined(data) && Object.keys(data).length === 0 && !(this.parent.dataSource instanceof DataManager) ? this.parent.dataSource : [];\n    this.parent.parentData = [];\n    if (isRemoteData(this.parent) && !isOffline(this.parent) && data instanceof DataManager && !(data instanceof Array)) {\n      var dm = this.parent.dataSource;\n      if (this.parent.parentIdMapping) {\n        this.parent.query = isNullOrUndefined(this.parent.query) ? new Query() : this.parent.query;\n        if (this.parent.parentIdMapping) {\n          var filterKey = this.parent.query.params.filter(function (param) {\n            return param.key === 'IdMapping';\n          });\n          if (this.parent.initialRender && !filterKey.length) {\n            this.parent.query.where(this.parent.parentIdMapping, 'equal', null);\n            this.parent.query.addParams('IdMapping', this.parent.idMapping);\n          }\n        }\n        if (!this.parent.hasChildMapping) {\n          var qry = this.parent.query.clone();\n          qry.queries = [];\n          qry = qry.select([this.parent.parentIdMapping]);\n          qry.isCountRequired = true;\n          dm.executeQuery(qry).then(function (e) {\n            _this.parentItems = DataUtil.distinct(e.result, _this.parent.parentIdMapping, false);\n            var req;\n            if (e.result) {\n              req = 0;\n            } else {\n              req = 1;\n            }\n            if (req === 0) {\n              setValue('grid.contentModule.isLoaded', true, _this.parent);\n              if (!isNullOrUndefined(_this.zerothLevelData)) {\n                setValue('cancel', false, _this.zerothLevelData);\n                getValue('grid.renderModule', _this.parent).dataManagerSuccess(_this.zerothLevelData);\n                _this.zerothLevelData = null;\n              }\n              _this.parent.grid.hideSpinner();\n            }\n          });\n        }\n      }\n    } else if (data instanceof Array) {\n      this.convertJSONData(data);\n    }\n  };\n  DataManipulation.prototype.convertJSONData = function (data) {\n    this.hierarchyData = [];\n    this.taskIds = [];\n    if (!this.parent.idMapping) {\n      this.hierarchyData = data;\n    } else {\n      var keys = Object.keys(data);\n      for (var i = 0; i < keys.length; i++) {\n        var tempData = data[parseInt(i.toString(), 10)];\n        this.hierarchyData.push(extend({}, tempData));\n        if (!isNullOrUndefined(tempData[this.parent.idMapping])) {\n          this.taskIds.push(tempData[this.parent.idMapping]);\n        }\n      }\n    }\n    if (this.isSelfReference) {\n      var selfData = [];\n      var mappingData = new DataManager(this.hierarchyData).executeLocal(new Query().group(this.parent.parentIdMapping));\n      for (var i = 0; i < mappingData.length; i++) {\n        var groupData = mappingData[parseInt(i.toString(), 10)];\n        var index = this.taskIds.indexOf(groupData.key);\n        if (!isNullOrUndefined(groupData.key)) {\n          if (index > -1) {\n            var childData = groupData.items;\n            this.hierarchyData[parseInt(index.toString(), 10)][this.parent.childMapping] = childData;\n            continue;\n          }\n        }\n        selfData.push.apply(selfData, groupData.items);\n      }\n      this.hierarchyData = this.selfReferenceUpdate(selfData);\n    }\n    if (!Object.keys(this.hierarchyData).length) {\n      var isGantt = 'isGantt';\n      var referenceData = !(this.parent.dataSource instanceof DataManager) && this.parent[\"\" + isGantt];\n      this.parent.flatData = referenceData ? this.parent.dataSource : [];\n    } else {\n      this.createRecords(this.hierarchyData);\n    }\n    this.storedIndex = -1;\n  };\n  // private crudActions(): void {\n  //   if (this.parent.dataSource instanceof DataManager && (this.parent.dataSource.adaptor instanceof RemoteSaveAdaptor)) {\n  //     let oldUpdate: Function = this.parent.dataSource.adaptor.update;\n  //     this.parent.dataSource.adaptor.update =\n  //         function (dm: DataManager, keyField: string, value: Object, tableName?: string, query?: Query, original?: Object): Object {\n  //                value = getPlainData(value);\n  //                return oldUpdate.apply(this, [dm, keyField, value, tableName, query, original]);\n  //              }\n  //   }\n  // }\n  DataManipulation.prototype.selfReferenceUpdate = function (selfData) {\n    var result = [];\n    while (this.hierarchyData.length > 0 && selfData.length > 0) {\n      var index = selfData.indexOf(this.hierarchyData[0]);\n      if (index === -1) {\n        this.hierarchyData.shift();\n      } else {\n        result.push(this.hierarchyData.shift());\n        selfData.splice(index, 1);\n      }\n    }\n    return result;\n  };\n  /**\n   * Function to update the zeroth level parent records in remote binding\n   *\n   * @param {BeforeDataBoundArgs} args - contains data before its bounds to tree grid\n   * @hidden\n   * @returns {void}\n   */\n  DataManipulation.prototype.updateParentRemoteData = function (args) {\n    var actionArgs = 'actionArgs';\n    if (isRemoteData(this.parent) && this.parent.enableVirtualization && args[\"\" + actionArgs].requestType === 'virtualscroll') {\n      this.parent.hideSpinner();\n    }\n    var records = args.result;\n    if (isRemoteData(this.parent) && this.parent.enableVirtualization && (args[\"\" + actionArgs].requestType === 'virtualscroll' || args[\"\" + actionArgs].action === 'clearFilter' || args[\"\" + actionArgs].searchString === '')) {\n      this.parent.query.expands = [];\n    }\n    if (!this.parent.hasChildMapping && !this.parentItems.length && this.parent.loadChildOnDemand) {\n      this.zerothLevelData = args;\n      setValue('cancel', true, args);\n    } else {\n      if (this.parent.loadChildOnDemand) {\n        var _loop_1 = function (rec) {\n          if (isCountRequired(this_1.parent) && records[parseInt(rec.toString(), 10)].hasChildRecords && this_1.parent.initialRender) {\n            records[parseInt(rec.toString(), 10)].expanded = false;\n          }\n          if (isRemoteData(this_1.parent) && this_1.parent.enableVirtualization) {\n            var childRecords_1 = [];\n            var parent_1 = this_1.parent;\n            records.filter(function (e) {\n              if (e[\"\" + parent_1.parentIdMapping] === records[parseInt(rec.toString(), 10)][\"\" + parent_1.idMapping]) {\n                childRecords_1.push(e);\n              }\n            });\n            if (childRecords_1.length) {\n              records[parseInt(rec.toString(), 10)].expanded = true;\n            } else if (records[parseInt(rec.toString(), 10)].hasChildRecords) {\n              records[parseInt(rec.toString(), 10)].expanded = false;\n            }\n          }\n          if (isNullOrUndefined(records[parseInt(rec.toString(), 10)].index)) {\n            records[parseInt(rec.toString(), 10)].taskData = extend({}, records[parseInt(rec.toString(), 10)]);\n            records[parseInt(rec.toString(), 10)].uniqueID = getUid(this_1.parent.element.id + '_data_');\n            setValue('uniqueIDCollection.' + records[parseInt(rec.toString(), 10)].uniqueID, records[parseInt(rec.toString(), 10)], this_1.parent);\n            records[parseInt(rec.toString(), 10)].level = 0;\n            if (isRemoteData(this_1.parent) && this_1.parent.enableVirtualization && records[parseInt(rec.toString(), 10)][\"\" + this_1.parent.parentIdMapping] && records[parseInt(rec.toString(), 10)].level === 0) {\n              records[parseInt(rec.toString(), 10)].level = records[parseInt(rec.toString(), 10)].level + 1;\n            }\n            records[parseInt(rec.toString(), 10)].index = Math.ceil(Math.random() * 1000);\n            if (records[parseInt(rec.toString(), 10)][this_1.parent.hasChildMapping] || this_1.parentItems.indexOf(records[parseInt(rec.toString(), 10)][this_1.parent.idMapping]) !== -1) {\n              records[parseInt(rec.toString(), 10)].hasChildRecords = true;\n            }\n            records[parseInt(rec.toString(), 10)].checkboxState = 'uncheck';\n          }\n        };\n        var this_1 = this;\n        for (var rec = 0; rec < records.length; rec++) {\n          _loop_1(rec);\n        }\n      } else {\n        var dataResults = 'dataResults';\n        var expandRecord = 'expandRecord';\n        if (!isNullOrUndefined(records) && !(!this.parent.loadChildOnDemand && isCountRequired(this.parent) && !isNullOrUndefined(this.parent[\"\" + dataResults][\"\" + expandRecord])) && !(isRemoteData(this.parent) && !this.parent.loadChildOnDemand && args[\"\" + actionArgs].isExpandCollapse && this.parent.enableVirtualization)) {\n          this.convertToFlatData(records);\n        }\n      }\n    }\n    if (isRemoteData(this.parent) && !this.parent.loadChildOnDemand && args[\"\" + actionArgs].isExpandCollapse && this.parent.enableVirtualization) {\n      args.result = records;\n    } else if (isRemoteData(this.parent) && this.parent.enableVirtualization && this.parent.loadChildOnDemand) {\n      args.result = records;\n    } else {\n      args.result = !this.parent.loadChildOnDemand ? this.parent.flatData : records;\n    }\n    if (isRemoteData(this.parent) && this.parent.enableVirtualization && !this.parent.loadChildOnDemand && this.parent.grid.aggregates.length && this.parent.grid.sortSettings.columns.length === 0 && this.parent.grid.filterSettings.columns.length === 0 && !this.parent.grid.searchSettings.key.length) {\n      var query = 'query';\n      var summaryQuery = args[\"\" + query].queries.filter(function (q) {\n        return q.fn === 'onAggregates';\n      });\n      args.result = this.parent.summaryModule.calculateSummaryValue(summaryQuery, this.parent.flatData, true);\n    }\n    this.parent.notify('updateResults', args);\n  };\n  /**\n   * Function to manipulate datasource\n   *\n   * @param {{record: ITreeData, rows: HTMLTableRowElement[], parentRow: HTMLTableRowElement}} rowDetails - Row details for which child rows has to be fetched\n   * @param {ITreeData} rowDetails.record - current expanding record\n   * @param {HTMLTableRowElement[]} rowDetails.rows - Expanding Row element\n   * @param {HTMLTableRowElement} rowDetails.parentRow  - Curent expanding row element\n   * @param {boolean} isChild - Specified whether current record is already a child record\n   * @hidden\n   * @returns {void}\n   */\n  DataManipulation.prototype.collectExpandingRecs = function (rowDetails, isChild) {\n    var gridRows = this.parent.getRows();\n    var name = 'name';\n    if (this.parent.rowTemplate) {\n      var rows = this.parent.getContentTable().rows;\n      gridRows = [].slice.call(rows);\n    }\n    var childRecord;\n    if (rowDetails.rows.length > 0) {\n      if (!isChild) {\n        rowDetails.record.expanded = true;\n      }\n      for (var i = 0; i < rowDetails.rows.length; i++) {\n        this.parent['toggleRowVisibility'](rowDetails.rows[parseInt(i.toString(), 10)], 'e-childrow-visible');\n        if (!this.parent.loadChildOnDemand) {\n          var targetEle = rowDetails.rows[parseInt(i.toString(), 10)].getElementsByClassName('e-treegridcollapse')[0];\n          childRecord = this.parent.rowTemplate ? this.parent.grid.getCurrentViewRecords()[rowDetails.rows[parseInt(i.toString(), 10)].rowIndex] : this.parent.grid.getRowObjectFromUID(rowDetails.rows[parseInt(i.toString(), 10)].getAttribute('data-Uid')).data;\n          if (!isNullOrUndefined(targetEle) && childRecord.expanded) {\n            addClass([targetEle], 'e-treegridexpand');\n            removeClass([targetEle], 'e-treegridcollapse');\n          }\n          var childRows = [];\n          childRows = gridRows.filter(function (r) {\n            return r.querySelector('.e-gridrowindex' + childRecord.index + 'level' + (childRecord.level + 1));\n          });\n          if (childRows.length && childRecord.expanded) {\n            this.collectExpandingRecs({\n              record: childRecord,\n              rows: childRows,\n              parentRow: rowDetails.parentRow\n            }, true);\n          }\n        }\n        var expandingTd = rowDetails.rows[parseInt(i.toString(), 10)].querySelector('.e-detailrowcollapse');\n        if (!isNullOrUndefined(expandingTd)) {\n          this.parent.grid.detailRowModule.expand(expandingTd);\n        }\n      }\n    } else {\n      this.fetchRemoteChildData({\n        action: rowDetails[\"\" + name],\n        record: rowDetails.record,\n        rows: rowDetails.rows,\n        parentRow: rowDetails.parentRow\n      });\n    }\n  };\n  DataManipulation.prototype.fetchRemoteChildData = function (rowDetails) {\n    var _this = this;\n    var args = {\n      row: rowDetails.parentRow,\n      data: rowDetails.record\n    };\n    var dm = this.parent.dataSource;\n    var qry = this.parent.grid.getDataModule().generateQuery();\n    var clonequries = qry.queries.filter(function (e) {\n      return e.fn !== 'onPage' && e.fn !== 'onWhere';\n    });\n    qry.queries = clonequries;\n    qry.isCountRequired = true;\n    var idMappingValue = parseInt(rowDetails.record[this.parent.idMapping], 10);\n    if (isNaN(idMappingValue)) {\n      idMappingValue = rowDetails.record[this.parent.idMapping].toString();\n    }\n    if (this.parent.enableVirtualization && rowDetails.action === 'remoteExpand') {\n      qry.take(this.parent.pageSettings.pageSize);\n      var expandDetail = [];\n      expandDetail.push('ExpandingAction', idMappingValue.toString());\n      qry.expand(expandDetail);\n    } else if (this.parent.enableVirtualization && rowDetails.action === 'collapse') {\n      qry.take(this.parent.grid.pageSettings.pageSize);\n      var expandDetail = [];\n      expandDetail.push('CollapsingAction', idMappingValue.toString());\n      qry.expand(expandDetail);\n    }\n    qry.where(this.parent.parentIdMapping, 'equal', rowDetails.record[this.parent.idMapping]);\n    if (rowDetails.action === 'remoteExpand' && this.parent.grid.filterModule && this.parent.grid.filterModule['value']) {\n      var filterqry = this.parent.grid.getDataModule().generateQuery().queries.filter(function (e) {\n        return e.fn !== 'onPage' && typeof e.e.predicates !== 'undefined';\n      });\n      qry.queries.push(filterqry[0]);\n    }\n    showSpinner(this.parent.element);\n    dm.executeQuery(qry).then(function (e) {\n      var remoteExpandedData = 'remoteExpandedData';\n      var remoteCollapsedData = 'remoteCollapsedData';\n      var level = 'level';\n      var datas = _this.parent.grid.currentViewData.slice();\n      var inx;\n      var idMapping = _this.parent.idMapping;\n      if (_this.parent['isGantt'] && _this.parent.loadChildOnDemand && _this.parent.hasChildMapping) {\n        for (var i = 0; i < _this.parent.grid.currentViewData.length; i++) {\n          if (rowDetails.record[idMapping] === _this.parent.grid.currentViewData[i][idMapping]) {\n            inx = i;\n            break;\n          }\n        }\n      } else {\n        inx = datas.indexOf(rowDetails.record);\n      }\n      if (_this.parent.enableVirtualization && (rowDetails.action === 'collapse' || rowDetails.action === 'remoteExpand')) {\n        datas = [];\n        for (var i = 0; i < inx; i++) {\n          datas.push(_this.parent.grid.currentViewData[parseInt(i.toString(), 10)]);\n        }\n      }\n      if (inx === -1) {\n        _this.parent.grid.getRowsObject().forEach(function (rows) {\n          if (rows.data.uniqueID === rowDetails.record.uniqueID) {\n            inx = rows.index;\n          }\n        });\n      }\n      var haveChild = getObject('actual.nextLevel', e);\n      var result = e.result;\n      var resultChildData = [];\n      if (rowDetails.action === 'remoteExpand' && _this.parent.grid.filterModule && _this.parent.grid.filterModule['value']) {\n        for (var i = 0; i < datas.length; i++) {\n          if (Object.prototype.hasOwnProperty.call(datas[parseInt(i.toString(), 10)], _this.parent.parentIdMapping) && datas[parseInt(i.toString(), 10)]['' + _this.parent.parentIdMapping] !== null && datas[parseInt(i.toString(), 10)].level === 0) {\n            datas.splice(i, 1);\n            i--;\n          }\n        }\n        for (var i = 0; i < result.length; i++) {\n          if (rowDetails.record['' + _this.parent.idMapping] !== result[parseInt(i.toString(), 10)]['' + _this.parent.idMapping] && rowDetails.record['' + _this.parent.idMapping] === result[parseInt(i.toString(), 10)]['' + _this.parent.parentIdMapping]) {\n            if (Object.prototype.hasOwnProperty.call(result, i)) {\n              resultChildData.push(result[parseInt(i.toString(), 10)]);\n            }\n          }\n        }\n        result = resultChildData;\n      }\n      if (_this.parent.enableVirtualization && rowDetails.action === 'remoteExpand') {\n        rowDetails.record.childRecords = [];\n        for (var i = 0; i < result.length; i++) {\n          if (rowDetails.record['' + _this.parent.idMapping] !== result[parseInt(i.toString(), 10)]['' + _this.parent.idMapping] && rowDetails.record['' + _this.parent.idMapping] === result[parseInt(i.toString(), 10)]['' + _this.parent.parentIdMapping] && Object.prototype.hasOwnProperty.call(result, i)) {\n            rowDetails.record.childRecords.push(result[parseInt(i.toString(), 10)]);\n          }\n        }\n      } else {\n        rowDetails.record.childRecords = result;\n      }\n      for (var r = 0; r < result.length; r++) {\n        if (_this.parent.enableVirtualization && result[parseInt(r.toString(), 10)][\"\" + _this.parent.idMapping] === rowDetails.record[\"\" + _this.parent.idMapping] && rowDetails.action === 'remoteExpand') {\n          _this.parent[\"\" + remoteExpandedData].push(rowDetails.record);\n        } else if (_this.parent.enableVirtualization && result[parseInt(r.toString(), 10)][\"\" + _this.parent.idMapping] === rowDetails.record[\"\" + _this.parent.idMapping] && rowDetails.action === 'collapse') {\n          for (var i = 0; i < _this.parent[\"\" + remoteExpandedData].length; i++) {\n            if (rowDetails.record[\"\" + _this.parent.idMapping] === _this.parent[\"\" + remoteExpandedData][parseInt(i.toString(), 10)][\"\" + _this.parent.idMapping]) {\n              _this.parent[\"\" + remoteExpandedData].splice(i, 1);\n            }\n          }\n        }\n        result[parseInt(r.toString(), 10)].taskData = extend({}, result[parseInt(r.toString(), 10)]);\n        if (result[parseInt(r.toString(), 10)][\"\" + _this.parent.parentIdMapping] && _this.parent.enableVirtualization && _this.parent[\"\" + remoteExpandedData].length) {\n          for (var i = 0; i < _this.parent[\"\" + remoteExpandedData].length; i++) {\n            if (result[parseInt(r.toString(), 10)][\"\" + _this.parent.parentIdMapping] === _this.parent[\"\" + remoteExpandedData][parseInt(i.toString(), 10)][\"\" + _this.parent.idMapping]) {\n              result[parseInt(r.toString(), 10)].level = _this.parent[\"\" + remoteExpandedData][parseInt(i.toString(), 10)][\"\" + level] + 1;\n              var parentData = _this.parent[\"\" + remoteExpandedData][parseInt(i.toString(), 10)];\n              delete parentData.childRecords;\n              result[parseInt(r.toString(), 10)].parentItem = parentData;\n              result[parseInt(r.toString(), 10)].parentUniqueID = rowDetails.record.uniqueID;\n            }\n          }\n        } else if (_this.parent.enableVirtualization) {\n          if ((result[parseInt(r.toString(), 10)][\"\" + _this.parent.hasChildMapping] || _this.parentItems.indexOf(result[parseInt(r.toString(), 10)][\"\" + _this.parent.idMapping]) !== -1) && !(haveChild && !haveChild[parseInt(r.toString(), 10)])) {\n            if (isNullOrUndefined(result[parseInt(r.toString(), 10)][\"\" + _this.parent.parentIdMapping])) {\n              result[parseInt(r.toString(), 10)].level = 0;\n              if (rowDetails.action === 'remoteExpand') {\n                result[parseInt(r.toString(), 10)].childRecords = [];\n                result[parseInt(r.toString(), 10)].childRecords = rowDetails.record.childRecords;\n              }\n            } else {\n              result[parseInt(r.toString(), 10)].level = rowDetails.record.level;\n            }\n          } else {\n            var parentData = extend({}, rowDetails.record);\n            delete parentData.childRecords;\n            result[parseInt(r.toString(), 10)].parentItem = parentData;\n            result[parseInt(r.toString(), 10)].parentUniqueID = rowDetails.record.uniqueID;\n          }\n        } else {\n          result[parseInt(r.toString(), 10)].level = rowDetails.record.level + 1;\n          var parentData = extend({}, rowDetails.record);\n          delete parentData.childRecords;\n          result[parseInt(r.toString(), 10)].parentItem = parentData;\n          result[parseInt(r.toString(), 10)].parentUniqueID = rowDetails.record.uniqueID;\n        }\n        result[parseInt(r.toString(), 10)].index = Math.ceil(Math.random() * 1000);\n        result[parseInt(r.toString(), 10)].uniqueID = getUid(_this.parent.element.id + '_data_');\n        result[parseInt(r.toString(), 10)].checkboxState = 'uncheck';\n        if (_this.parent.enableVirtualization && isNullOrUndefined(result[parseInt(r.toString(), 10)].level)) {\n          for (var p = 0; p < _this.parent.grid.currentViewData.length; p++) {\n            if (_this.parent.grid.currentViewData[parseInt(p.toString(), 10)][\"\" + _this.parent.idMapping] === result[parseInt(r.toString(), 10)][\"\" + _this.parent.parentIdMapping]) {\n              result[parseInt(r.toString(), 10)].level = _this.parent.grid.currentViewData[parseInt(p.toString(), 10)]['level'] + 1;\n            }\n          }\n        }\n        setValue('uniqueIDCollection.' + result[parseInt(r.toString(), 10)].uniqueID, result[parseInt(r.toString(), 10)], _this.parent);\n        // delete result[r].parentItem.childRecords;\n        if ((result[parseInt(r.toString(), 10)][\"\" + _this.parent.hasChildMapping] || _this.parentItems.indexOf(result[parseInt(r.toString(), 10)][\"\" + _this.parent.idMapping]) !== -1) && !(haveChild && !haveChild[parseInt(r.toString(), 10)])) {\n          result[parseInt(r.toString(), 10)].hasChildRecords = true;\n          if (_this.parent.enableVirtualization && !_this.parent.loadChildOnDemand) {\n            for (var i = 0; i < _this.parent[\"\" + remoteCollapsedData].length; i++) {\n              if (result[parseInt(r.toString(), 10)][\"\" + _this.parent.idMapping] === _this.parent[\"\" + remoteCollapsedData][parseInt(i.toString(), 10)][\"\" + _this.parent.idMapping]) {\n                result[parseInt(r.toString(), 10)].expanded = _this.parent[\"\" + remoteCollapsedData][parseInt(i.toString(), 10)]['expanded'];\n              }\n            }\n            if (rowDetails.action === 'collapse' && result[parseInt(r.toString(), 10)][\"\" + _this.parent.idMapping] !== rowDetails.record[\"\" + _this.parent.idMapping] && result[parseInt(r.toString(), 10)].expanded !== false) {\n              result[parseInt(r.toString(), 10)].expanded = true;\n            } else if (rowDetails.action === 'collapse' && result[parseInt(r.toString(), 10)][\"\" + _this.parent.idMapping] === rowDetails.record[\"\" + _this.parent.idMapping]) {\n              result[parseInt(r.toString(), 10)].expanded = false;\n              _this.parent[\"\" + remoteCollapsedData].push(rowDetails.record);\n            } else if (rowDetails.action === 'remoteExpand') {\n              for (var i = 0; i < _this.parent.grid.currentViewData.length; i++) {\n                if (_this.parent.grid.currentViewData[parseInt(i.toString(), 10)][\"\" + _this.parent.idMapping] === result[parseInt(r.toString(), 10)][\"\" + _this.parent.idMapping]) {\n                  result.splice(r, 1, _this.parent.grid.currentViewData[parseInt(i.toString(), 10)]);\n                }\n              }\n              if (result[parseInt(r.toString(), 10)][_this.parent.idMapping] === rowDetails.record[\"\" + _this.parent.idMapping]) {\n                for (var i = 0; i < _this.parent[\"\" + remoteCollapsedData].length; i++) {\n                  if (rowDetails.record[\"\" + _this.parent.idMapping] === _this.parent[\"\" + remoteCollapsedData][parseInt(i.toString(), 10)][\"\" + _this.parent.idMapping]) {\n                    _this.parent[\"\" + remoteCollapsedData].splice(i, 1);\n                  }\n                }\n              }\n              if (result[parseInt(r.toString(), 10)].expanded !== false) {\n                result[parseInt(r.toString(), 10)].expanded = true;\n              }\n            }\n          } else if (_this.parent.enableVirtualization && result[parseInt(r.toString(), 10)][\"\" + _this.parent.idMapping] === rowDetails.record[\"\" + _this.parent.idMapping] && rowDetails.action !== 'collapse') {\n            result[parseInt(r.toString(), 10)].expanded = true;\n          } else if (!(_this.parent.enableVirtualization && !_this.parent.loadChildOnDemand)) {\n            result[parseInt(r.toString(), 10)].expanded = false;\n          }\n        }\n        datas.splice(inx + r + 1, 0, result[parseInt(r.toString(), 10)]);\n      }\n      setValue('result', datas, e);\n      setValue('action', 'beforecontentrender', e);\n      _this.parent.trigger(events.actionComplete, e);\n      hideSpinner(_this.parent.element);\n      if (_this.parent.grid.aggregates.length > 0 && !_this.parent.enableVirtualization) {\n        var gridQuery = getObject('query', e);\n        var result_1 = 'result';\n        if (isNullOrUndefined(gridQuery)) {\n          gridQuery = getValue('grid.renderModule.data', _this.parent).aggregateQuery(new Query());\n        }\n        if (!isNullOrUndefined(gridQuery)) {\n          var summaryQuery = gridQuery.queries.filter(function (q) {\n            return q.fn === 'onAggregates';\n          });\n          e[\"\" + result_1] = _this.parent.summaryModule.calculateSummaryValue(summaryQuery, e[\"\" + result_1], true);\n        }\n      }\n      if (rowDetails.action === 'remoteExpand' && _this.parent.allowPaging && _this.parent.pageSettings.pageSizeMode === 'All') {\n        _this.parent.grid.pageSettings.totalRecordsCount = _this.parent.grid.pageSettings.totalRecordsCount + result.length;\n      }\n      if (_this.parent.enableVirtualization) {\n        _this.parent.grid.pageSettings.totalRecordsCount = e.count;\n      }\n      e.count = _this.parent.grid.pageSettings.totalRecordsCount;\n      var virtualArgs = {};\n      if (_this.parent.enableVirtualization) {\n        _this.remoteVirtualAction(virtualArgs);\n      }\n      var notifyArgs = {\n        index: inx,\n        childData: result\n      };\n      if (_this.parent.enableInfiniteScrolling) {\n        _this.parent.notify('infinite-remote-expand', notifyArgs);\n      } else {\n        getValue('grid.renderModule', _this.parent).dataManagerSuccess(e, virtualArgs);\n      }\n      _this.parent.trigger(events.expanded, args);\n    });\n  };\n  DataManipulation.prototype.remoteVirtualAction = function (virtualArgs) {\n    virtualArgs.requestType = 'refresh';\n    setValue('isExpandCollapse', true, virtualArgs);\n    var contentModule = getValue('grid.contentModule', this.parent);\n    var currentInfo = getValue('currentInfo', contentModule);\n    var prevInfo = getValue('prevInfo', contentModule);\n    if (currentInfo.loadNext && this.parent.grid.pageSettings.currentPage === currentInfo.nextInfo.page) {\n      this.parent.grid.pageSettings.currentPage = prevInfo.page;\n    }\n  };\n  DataManipulation.prototype.beginSorting = function () {\n    this.isSortAction = true;\n    if (isRemoteData(this.parent) && this.parent.enableVirtualization) {\n      var index = this.parent.query.queries.indexOf(this.parent.query.queries.filter(function (q) {\n        return q.fn === 'onSortBy';\n      })[0]);\n      if (index !== -1) {\n        this.parent.query.queries.splice(index, 1);\n      }\n      if (this.parent.grid.sortSettings.columns.length === 0) {\n        this.parent.query.sortBy(null, null);\n      }\n    }\n  };\n  DataManipulation.prototype.createRecords = function (data, parentRecords) {\n    var treeGridData = [];\n    var keys = Object.keys(data);\n    for (var i = 0, len = keys.length; i < len; i++) {\n      var currentData = extend({}, data[parseInt(i.toString(), 10)]);\n      currentData.taskData = data[parseInt(i.toString(), 10)];\n      var level = 0;\n      this.storedIndex++;\n      if (!Object.prototype.hasOwnProperty.call(currentData, 'index')) {\n        currentData.index = this.storedIndex;\n      }\n      var childMapping = currentData[this.parent.childMapping];\n      var hasChildren = !isNullOrUndefined(childMapping) && childMapping.length > 0;\n      var shouldCount = isCountRequired(this.parent);\n      var hasChildMapping = currentData[this.parent.hasChildMapping];\n      if (hasChildren && !shouldCount || hasChildMapping && shouldCount) {\n        currentData.hasChildRecords = true;\n      } else {\n        currentData.hasChildRecords = false;\n      }\n      if (!isNullOrUndefined(childMapping) && !shouldCount || hasChildMapping && shouldCount) {\n        if (this.parent.enableCollapseAll || !isNullOrUndefined(this.parent.dataStateChange) && isNullOrUndefined(childMapping)) {\n          currentData.expanded = false;\n        } else {\n          currentData.expanded = !isNullOrUndefined(currentData[this.parent.expandStateMapping]) ? currentData[this.parent.expandStateMapping] : true;\n        }\n      }\n      if (!Object.prototype.hasOwnProperty.call(currentData, 'index')) {\n        currentData.index = currentData.hasChildRecords ? this.storedIndex : this.storedIndex;\n      }\n      if (this.isSelfReference && isNullOrUndefined(currentData[this.parent.parentIdMapping])) {\n        this.parent.parentData.push(currentData);\n      }\n      currentData.uniqueID = getUid(this.parent.element.id + '_data_');\n      setValue('uniqueIDCollection.' + currentData.uniqueID, currentData, this.parent);\n      if (!isNullOrUndefined(parentRecords)) {\n        var parentData = extend({}, parentRecords);\n        delete parentData.childRecords;\n        delete parentData[this.parent.childMapping];\n        if (this.isSelfReference) {\n          delete parentData.taskData[this.parent.childMapping];\n        }\n        currentData.parentItem = parentData;\n        currentData.parentUniqueID = parentData.uniqueID;\n        level = parentRecords.level + 1;\n      }\n      if (!Object.prototype.hasOwnProperty.call(currentData, 'level')) {\n        currentData.level = level;\n      }\n      currentData.checkboxState = 'uncheck';\n      var remoteCollapsedData = 'remoteCollapsedData';\n      if (this.parent.enableVirtualization && !this.parent.loadChildOnDemand && isRemoteData(this.parent) && !this.parent.initialRender) {\n        if (!currentData.hasChildRecords && isNullOrUndefined(currentData[\"\" + this.parent.parentIdMapping])) {\n          currentData.hasChildRecords = true;\n          for (var c = 0; c < this.parent[\"\" + remoteCollapsedData].length; c++) {\n            if (this.parent[\"\" + remoteCollapsedData][parseInt(c.toString(), 10)][\"\" + this.parent.idMapping] === currentData[\"\" + this.parent.idMapping]) {\n              currentData.expanded = false;\n            }\n          }\n        } else if (currentData.level === 0 && isNullOrUndefined(parentRecords) && !currentData.hasChildRecords) {\n          currentData.level = currentData.level + 1;\n        }\n        if (currentData[\"\" + this.parent.hasChildMapping] && !isNullOrUndefined(currentData[\"\" + this.parent.expandStateMapping])) {\n          currentData.expanded = currentData[\"\" + this.parent.expandStateMapping];\n          currentData.hasChildRecords = true;\n        }\n        this.parent.flatData.push(currentData);\n      } else if (isNullOrUndefined(currentData[\"\" + this.parent.parentIdMapping]) || currentData.parentItem) {\n        this.parent.flatData.push(currentData);\n        this.parent['infiniteScrollData'].push(currentData);\n      }\n      if (!this.isSelfReference && currentData.level === 0) {\n        this.parent.parentData.push(currentData);\n      }\n      if (!isNullOrUndefined(currentData[this.parent.childMapping] && currentData[this.parent.childMapping].length)) {\n        var record = this.createRecords(currentData[this.parent.childMapping], currentData);\n        currentData.childRecords = record;\n      }\n      treeGridData.push(currentData);\n    }\n    return treeGridData;\n  };\n  /**\n   * Function to perform filtering/sorting action for local data\n   *\n   * @param {BeforeDataBoundArgs} args - data details to be processed before binding to grid\n   * @hidden\n   * @returns {void}\n   */\n  DataManipulation.prototype.dataProcessor = function (args) {\n    var isExport = getObject('isExport', args);\n    var expresults = getObject('expresults', args);\n    var exportType = getObject('exportType', args);\n    var isPrinting = getObject('isPrinting', args);\n    var dataObj;\n    var actionArgs = getObject('actionArgs', args);\n    var requestType = getObject('requestType', args);\n    var actionData = getObject('data', args);\n    var action = getObject('action', args);\n    var actionAddArgs = actionArgs;\n    var primaryKeyColumnName = this.parent.getPrimaryKeyFieldNames()[0];\n    var dataValue = getObject('data', actionAddArgs);\n    if (!isNullOrUndefined(actionAddArgs) && !isNullOrUndefined(actionAddArgs.action) && actionAddArgs.action === 'add' && !isNullOrUndefined(actionAddArgs.data) && isNullOrUndefined(actionAddArgs.data[\"\" + primaryKeyColumnName])) {\n      actionAddArgs.data[\"\" + primaryKeyColumnName] = args.result[actionAddArgs.index][\"\" + primaryKeyColumnName];\n      dataValue.taskData[\"\" + primaryKeyColumnName] = args.result[actionAddArgs.index][\"\" + primaryKeyColumnName];\n    }\n    if (!isNullOrUndefined(actionArgs) && Object.keys(actionArgs).length || requestType === 'save') {\n      requestType = requestType ? requestType : actionArgs.requestType;\n      actionData = actionData ? actionData : getObject('data', actionArgs);\n      action = action ? action : getObject('action', actionArgs);\n      if (this.parent.editSettings.mode === 'Batch') {\n        this.batchChanges = this.parent.grid.editModule.getBatchChanges();\n      }\n      if (this.parent.isLocalData) {\n        this.updateAction(actionData, action, requestType);\n      }\n    }\n    if (isExport && !isNullOrUndefined(expresults)) {\n      dataObj = expresults;\n    } else {\n      dataObj = isCountRequired(this.parent) ? getValue('result', this.parent.grid.dataSource) : this.parent.grid.dataSource;\n    }\n    var results = dataObj instanceof DataManager ? dataObj.dataSource.json : dataObj;\n    var count = isCountRequired(this.parent) ? getValue('count', this.parent.dataSource) : results.length;\n    var qry = new Query();\n    var gridQuery = getObject('query', args);\n    var filterQuery;\n    var searchQuery;\n    if (!isNullOrUndefined(gridQuery)) {\n      filterQuery = gridQuery.queries.filter(function (q) {\n        return q.fn === 'onWhere';\n      });\n      searchQuery = gridQuery.queries.filter(function (q) {\n        return q.fn === 'onSearch';\n      });\n    }\n    if (this.parent.grid.allowFiltering && this.parent.grid.filterSettings.columns.length || this.parent.grid.searchSettings.key.length > 0 || !isNullOrUndefined(gridQuery) && (filterQuery.length || searchQuery.length) && this.parent.isLocalData) {\n      if (isNullOrUndefined(gridQuery)) {\n        gridQuery = new Query();\n        gridQuery = getValue('grid.renderModule.data', this.parent).filterQuery(gridQuery);\n        gridQuery = getValue('grid.renderModule.data', this.parent).searchQuery(gridQuery);\n      }\n      var fltrQuery = gridQuery.queries.filter(function (q) {\n        return q.fn === 'onWhere';\n      });\n      var srchQuery = gridQuery.queries.filter(function (q) {\n        return q.fn === 'onSearch';\n      });\n      qry.queries = fltrQuery.concat(srchQuery);\n      var filteredData = new DataManager(results).executeLocal(qry);\n      this.parent.notify('updateFilterRecs', {\n        data: filteredData\n      });\n      results = this.dataResults.result;\n      this.dataResults.result = null;\n      if (this.parent.grid.aggregates.length > 0) {\n        var query = getObject('query', args);\n        if (isNullOrUndefined(gridQuery)) {\n          gridQuery = getValue('grid.renderModule.data', this.parent).aggregateQuery(new Query());\n        }\n        if (!isNullOrUndefined(query)) {\n          var summaryQuery = query.queries.filter(function (q) {\n            return q.fn === 'onAggregates';\n          });\n          results = this.parent.summaryModule.calculateSummaryValue(summaryQuery, results, true);\n        }\n      }\n    }\n    if (this.parent.grid.aggregates.length && this.parent.grid.sortSettings.columns.length === 0 && this.parent.grid.filterSettings.columns.length === 0 && !this.parent.grid.searchSettings.key.length) {\n      var gridQuery_1 = getObject('query', args);\n      if (isNullOrUndefined(gridQuery_1)) {\n        gridQuery_1 = getValue('grid.renderModule.data', this.parent).aggregateQuery(new Query());\n      }\n      var summaryQuery = gridQuery_1.queries.filter(function (q) {\n        return q.fn === 'onAggregates';\n      });\n      results = this.parent.summaryModule.calculateSummaryValue(summaryQuery, this.parent.flatData, true);\n    }\n    if (this.parent.grid.sortSettings.columns.length > 0 || this.isSortAction) {\n      this.isSortAction = false;\n      var parentData = this.parent.parentData;\n      var query = getObject('query', args);\n      var srtQry = new Query();\n      for (var srt = this.parent.grid.sortSettings.columns.length - 1; srt >= 0; srt--) {\n        var getColumnByField = 'getColumnByField';\n        var col = this.parent.grid.renderModule.data[\"\" + getColumnByField](this.parent.grid.sortSettings.columns[parseInt(srt.toString(), 10)].field);\n        var compFun = col.sortComparer && isOffline(this.parent) ? col.sortComparer.bind(col) : this.parent.grid.sortSettings.columns[parseInt(srt.toString(), 10)].direction;\n        srtQry.sortBy(this.parent.grid.sortSettings.columns[parseInt(srt.toString(), 10)].field, compFun);\n      }\n      var modifiedData = new DataManager(parentData).executeLocal(srtQry);\n      if (this.parent.allowRowDragAndDrop && !isNullOrUndefined(this.parent.rowDragAndDropModule['draggedRecord']) && this.parent.rowDragAndDropModule['droppedRecord'].hasChildRecords && this.parent.rowDragAndDropModule['dropPosition'] !== 'middleSegment') {\n        var dragdIndex = modifiedData.indexOf(this.parent.rowDragAndDropModule['draggedRecord']);\n        modifiedData.splice(dragdIndex, 1);\n        var dropdIndex = modifiedData.indexOf(this.parent.rowDragAndDropModule['droppedRecord']);\n        if (this.parent.rowDragAndDropModule['droppedRecord'].hasChildRecords && this.parent.rowDragAndDropModule['dropPosition'] === 'topSegment') {\n          modifiedData.splice(dropdIndex, 0, this.parent.rowDragAndDropModule['draggedRecord']);\n        } else if (this.parent.rowDragAndDropModule['dropPosition'] === 'bottomSegment') {\n          modifiedData.splice(dropdIndex + 1, 0, this.parent.rowDragAndDropModule['draggedRecord']);\n        }\n      }\n      var sortArgs = {\n        modifiedData: modifiedData,\n        filteredData: results,\n        srtQry: srtQry\n      };\n      this.parent.notify('createSort', sortArgs);\n      results = sortArgs.modifiedData;\n      this.dataResults.result = null;\n      this.sortedData = results;\n      this.parent.notify('updateModel', {});\n      if (this.parent.grid.aggregates.length > 0 && !isNullOrUndefined(query)) {\n        var isSort = false;\n        var query_1 = getObject('query', args);\n        var summaryQuery = query_1.queries.filter(function (q) {\n          return q.fn === 'onAggregates';\n        });\n        results = this.parent.summaryModule.calculateSummaryValue(summaryQuery, this.sortedData, isSort);\n      }\n    }\n    count = isCountRequired(this.parent) ? getValue('count', this.parent.dataSource) : results.length;\n    var temp = this.paging(results, count, isExport, isPrinting, exportType, args);\n    results = temp.result;\n    count = temp.count;\n    args.result = results;\n    args.count = count;\n    this.parent.notify('updateResults', args);\n  };\n  DataManipulation.prototype.paging = function (results, count, isExport, isPrinting, exportType, args) {\n    if (this.parent.allowPaging && (!isExport || exportType === 'CurrentPage') && (!isPrinting || this.parent.printMode === 'CurrentPage')) {\n      this.parent.notify(events.pagingActions, {\n        result: results,\n        count: count,\n        actionArgs: args\n      });\n      results = this.dataResults.result;\n      count = isCountRequired(this.parent) ? getValue('count', this.parent.dataSource) : this.dataResults.count;\n    } else if ((this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) && (!isExport || exportType === 'CurrentPage') && getValue('requestType', args) !== 'save') {\n      var actArgs = this.parent.enableInfiniteScrolling ? args : getValue('actionArgs', args);\n      this.parent.notify(events.pagingActions, {\n        result: results,\n        count: count,\n        actionArgs: actArgs\n      });\n      results = this.dataResults.result;\n      count = this.dataResults.count;\n    }\n    var isPdfExport = 'isPdfExport';\n    var isCollapsedStatePersist = 'isCollapsedStatePersist';\n    if ((isPrinting === true || args[\"\" + isPdfExport] && (isNullOrUndefined(args[\"\" + isCollapsedStatePersist]) || args[\"\" + isCollapsedStatePersist])) && this.parent.printMode === 'AllPages') {\n      var actualResults = [];\n      for (var i = 0; i < results.length; i++) {\n        var expandStatus = getExpandStatus(this.parent, results[parseInt(i.toString(), 10)], this.parent.parentData);\n        if (expandStatus) {\n          actualResults.push(results[parseInt(i.toString(), 10)]);\n        }\n      }\n      results = actualResults;\n      count = results.length;\n    }\n    var value = {\n      result: results,\n      count: count\n    };\n    return value;\n  };\n  DataManipulation.prototype.updateData = function (dataResult) {\n    this.dataResults = dataResult;\n  };\n  DataManipulation.prototype.updateAction = function (actionData, action, requestType) {\n    if (requestType === 'delete' || requestType === 'save') {\n      this.parent.notify(events.crudAction, {\n        value: actionData,\n        action: action || requestType\n      });\n    }\n    if (requestType === 'batchsave' && this.parent.editSettings.mode === 'Batch') {\n      this.parent.notify(events.batchSave, {});\n    }\n  };\n  return DataManipulation;\n}();\nexport { DataManipulation };","map":{"version":3,"names":["extend","isNullOrUndefined","setValue","getValue","addClass","removeClass","DataManager","Query","DataUtil","showSpinner","hideSpinner","getObject","getUid","isRemoteData","isOffline","isCountRequired","getExpandStatus","events","DataManipulation","grid","addedRecords","parent","parentItems","taskIds","hierarchyData","storedIndex","sortedData","isSortAction","addEventListener","dataResults","isSelfReference","parentIdMapping","prototype","on","updateParentRemoteData","beginSorting","updateData","remoteExpand","collectExpandingRecs","dataProcessor","removeEventListener","isDestroyed","off","destroy","isRemote","dataSource","convertToFlatData","data","_this","flatData","Object","keys","length","parentData","Array","dm","query","filterKey","params","filter","param","key","initialRender","where","addParams","idMapping","hasChildMapping","qry","clone","queries","select","executeQuery","then","e","distinct","result","req","zerothLevelData","dataManagerSuccess","convertJSONData","i","tempData","parseInt","toString","push","selfData","mappingData","executeLocal","group","groupData","index","indexOf","childData","items","childMapping","apply","selfReferenceUpdate","isGantt","referenceData","createRecords","shift","splice","args","actionArgs","enableVirtualization","requestType","records","action","searchString","expands","loadChildOnDemand","_loop_1","rec","this_1","hasChildRecords","expanded","childRecords_1","parent_1","taskData","uniqueID","element","id","level","Math","ceil","random","checkboxState","expandRecord","isExpandCollapse","aggregates","sortSettings","columns","filterSettings","searchSettings","summaryQuery","q","fn","summaryModule","calculateSummaryValue","notify","rowDetails","isChild","gridRows","getRows","name","rowTemplate","rows","getContentTable","slice","call","childRecord","record","targetEle","getElementsByClassName","getCurrentViewRecords","rowIndex","getRowObjectFromUID","getAttribute","childRows","r","querySelector","parentRow","expandingTd","detailRowModule","expand","fetchRemoteChildData","row","getDataModule","generateQuery","clonequries","idMappingValue","isNaN","take","pageSettings","pageSize","expandDetail","filterModule","filterqry","predicates","remoteExpandedData","remoteCollapsedData","datas","currentViewData","inx","getRowsObject","forEach","haveChild","resultChildData","hasOwnProperty","childRecords","parentItem","parentUniqueID","p","trigger","actionComplete","gridQuery","result_1","aggregateQuery","allowPaging","pageSizeMode","totalRecordsCount","count","virtualArgs","remoteVirtualAction","notifyArgs","enableInfiniteScrolling","contentModule","currentInfo","prevInfo","loadNext","currentPage","nextInfo","page","sortBy","parentRecords","treeGridData","len","currentData","hasChildren","shouldCount","enableCollapseAll","dataStateChange","expandStateMapping","c","isExport","expresults","exportType","isPrinting","dataObj","actionData","actionAddArgs","primaryKeyColumnName","getPrimaryKeyFieldNames","dataValue","editSettings","mode","batchChanges","editModule","getBatchChanges","isLocalData","updateAction","results","json","filterQuery","searchQuery","allowFiltering","fltrQuery","srchQuery","concat","filteredData","gridQuery_1","srtQry","srt","getColumnByField","col","renderModule","field","compFun","sortComparer","bind","direction","modifiedData","allowRowDragAndDrop","rowDragAndDropModule","dragdIndex","dropdIndex","sortArgs","isSort","query_1","temp","paging","printMode","pagingActions","actArgs","isPdfExport","isCollapsedStatePersist","actualResults","expandStatus","value","dataResult","crudAction","batchSave"],"sources":["/var/www/vue/vue-gantt-chart/node_modules/@syncfusion/ej2-treegrid/src/treegrid/base/data.js"],"sourcesContent":["import { extend, isNullOrUndefined, setValue, getValue, addClass, removeClass } from '@syncfusion/ej2-base';\nimport { DataManager, Query, DataUtil } from '@syncfusion/ej2-data';\nimport { showSpinner, hideSpinner } from '@syncfusion/ej2-popups';\nimport { getObject, getUid } from '@syncfusion/ej2-grids';\nimport { isRemoteData, isOffline, isCountRequired, getExpandStatus } from '../utils';\nimport * as events from './constant';\n/**\n * Internal dataoperations for tree grid\n *\n * @hidden\n */\nvar DataManipulation = /** @class */ (function () {\n    function DataManipulation(grid) {\n        this.addedRecords = 'addedRecords';\n        this.parent = grid;\n        this.parentItems = [];\n        this.taskIds = [];\n        this.hierarchyData = [];\n        this.storedIndex = -1;\n        this.sortedData = [];\n        this.isSortAction = false;\n        this.addEventListener();\n        this.dataResults = {};\n        this.isSelfReference = !isNullOrUndefined(this.parent.parentIdMapping);\n    }\n    /**\n     * @hidden\n     * @returns {void}\n     */\n    DataManipulation.prototype.addEventListener = function () {\n        this.parent.on('updateRemoteLevel', this.updateParentRemoteData, this);\n        this.parent.grid.on('sorting-begin', this.beginSorting, this);\n        this.parent.on('updateAction', this.updateData, this);\n        this.parent.on(events.remoteExpand, this.collectExpandingRecs, this);\n        this.parent.on('dataProcessor', this.dataProcessor, this);\n    };\n    /**\n     * @hidden\n     * @returns {void}\n     */\n    DataManipulation.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off(events.remoteExpand, this.collectExpandingRecs);\n        this.parent.off('updateRemoteLevel', this.updateParentRemoteData);\n        this.parent.off('updateAction', this.updateData);\n        this.parent.off('dataProcessor', this.dataProcessor);\n        this.parent.grid.off('sorting-begin', this.beginSorting);\n    };\n    /**\n     * To destroy the dataModule\n     *\n     * @returns {void}\n     * @hidden\n     */\n    DataManipulation.prototype.destroy = function () {\n        this.removeEventListener();\n    };\n    /**\n     * @hidden\n     * @returns {boolean} -Returns whether remote data binding\n     */\n    DataManipulation.prototype.isRemote = function () {\n        if (!(this.parent.dataSource instanceof DataManager)) {\n            return false;\n        }\n        return true;\n        // let gridData:  DataManager = <DataManager>this.parent.dataSource;\n        // return gridData.dataSource.offline !== true && gridData.dataSource.url !== undefined;\n    };\n    /**\n     * Function to manipulate datasource\n     *\n     * @param {Object} data - Provide tree grid datasource to convert to flat data\n     * @hidden\n     * @returns {void}\n     */\n    DataManipulation.prototype.convertToFlatData = function (data) {\n        var _this = this;\n        this.parent.flatData = (!isNullOrUndefined(data) && Object.keys(data).length === 0\n            && !(this.parent.dataSource instanceof DataManager) ?\n            this.parent.dataSource : []);\n        this.parent.parentData = [];\n        if ((isRemoteData(this.parent) && !isOffline(this.parent)) && data instanceof DataManager && !(data instanceof Array)) {\n            var dm = this.parent.dataSource;\n            if (this.parent.parentIdMapping) {\n                this.parent.query = isNullOrUndefined(this.parent.query) ?\n                    new Query() : this.parent.query;\n                if (this.parent.parentIdMapping) {\n                    var filterKey = this.parent.query.params.filter(function (param) { return param.key === 'IdMapping'; });\n                    if (this.parent.initialRender && !filterKey.length) {\n                        this.parent.query.where(this.parent.parentIdMapping, 'equal', null);\n                        this.parent.query.addParams('IdMapping', this.parent.idMapping);\n                    }\n                }\n                if (!this.parent.hasChildMapping) {\n                    var qry = this.parent.query.clone();\n                    qry.queries = [];\n                    qry = qry.select([this.parent.parentIdMapping]);\n                    qry.isCountRequired = true;\n                    dm.executeQuery(qry).then(function (e) {\n                        _this.parentItems = DataUtil.distinct(e.result, _this.parent.parentIdMapping, false);\n                        var req;\n                        if (e.result) {\n                            req = 0;\n                        }\n                        else {\n                            req = 1;\n                        }\n                        if (req === 0) {\n                            setValue('grid.contentModule.isLoaded', true, _this.parent);\n                            if (!isNullOrUndefined(_this.zerothLevelData)) {\n                                setValue('cancel', false, _this.zerothLevelData);\n                                getValue('grid.renderModule', _this.parent).dataManagerSuccess(_this.zerothLevelData);\n                                _this.zerothLevelData = null;\n                            }\n                            _this.parent.grid.hideSpinner();\n                        }\n                    });\n                }\n            }\n        }\n        else if (data instanceof Array) {\n            this.convertJSONData(data);\n        }\n    };\n    DataManipulation.prototype.convertJSONData = function (data) {\n        this.hierarchyData = [];\n        this.taskIds = [];\n        if (!this.parent.idMapping) {\n            this.hierarchyData = data;\n        }\n        else {\n            var keys = Object.keys(data);\n            for (var i = 0; i < keys.length; i++) {\n                var tempData = data[parseInt(i.toString(), 10)];\n                this.hierarchyData.push(extend({}, tempData));\n                if (!isNullOrUndefined(tempData[this.parent.idMapping])) {\n                    this.taskIds.push(tempData[this.parent.idMapping]);\n                }\n            }\n        }\n        if (this.isSelfReference) {\n            var selfData = [];\n            var mappingData = new DataManager(this.hierarchyData).executeLocal(new Query()\n                .group(this.parent.parentIdMapping));\n            for (var i = 0; i < mappingData.length; i++) {\n                var groupData = mappingData[parseInt(i.toString(), 10)];\n                var index = this.taskIds.indexOf(groupData.key);\n                if (!isNullOrUndefined(groupData.key)) {\n                    if (index > -1) {\n                        var childData = (groupData.items);\n                        this.hierarchyData[parseInt(index.toString(), 10)][this.parent.childMapping] = childData;\n                        continue;\n                    }\n                }\n                selfData.push.apply(selfData, groupData.items);\n            }\n            this.hierarchyData = this.selfReferenceUpdate(selfData);\n        }\n        if (!Object.keys(this.hierarchyData).length) {\n            var isGantt = 'isGantt';\n            var referenceData = !(this.parent.dataSource instanceof DataManager) && this.parent[\"\" + isGantt];\n            this.parent.flatData = referenceData ? (this.parent.dataSource) : [];\n        }\n        else {\n            this.createRecords(this.hierarchyData);\n        }\n        this.storedIndex = -1;\n    };\n    // private crudActions(): void {\n    //   if (this.parent.dataSource instanceof DataManager && (this.parent.dataSource.adaptor instanceof RemoteSaveAdaptor)) {\n    //     let oldUpdate: Function = this.parent.dataSource.adaptor.update;\n    //     this.parent.dataSource.adaptor.update =\n    //         function (dm: DataManager, keyField: string, value: Object, tableName?: string, query?: Query, original?: Object): Object {\n    //                value = getPlainData(value);\n    //                return oldUpdate.apply(this, [dm, keyField, value, tableName, query, original]);\n    //              }\n    //   }\n    // }\n    DataManipulation.prototype.selfReferenceUpdate = function (selfData) {\n        var result = [];\n        while (this.hierarchyData.length > 0 && selfData.length > 0) {\n            var index = selfData.indexOf(this.hierarchyData[0]);\n            if (index === -1) {\n                this.hierarchyData.shift();\n            }\n            else {\n                result.push(this.hierarchyData.shift());\n                selfData.splice(index, 1);\n            }\n        }\n        return result;\n    };\n    /**\n     * Function to update the zeroth level parent records in remote binding\n     *\n     * @param {BeforeDataBoundArgs} args - contains data before its bounds to tree grid\n     * @hidden\n     * @returns {void}\n     */\n    DataManipulation.prototype.updateParentRemoteData = function (args) {\n        var actionArgs = 'actionArgs';\n        if (isRemoteData(this.parent) && this.parent.enableVirtualization && args[\"\" + actionArgs].requestType === 'virtualscroll') {\n            this.parent.hideSpinner();\n        }\n        var records = args.result;\n        if (isRemoteData(this.parent) && this.parent.enableVirtualization && (args[\"\" + actionArgs].requestType === 'virtualscroll' || args[\"\" + actionArgs].action === 'clearFilter' || args[\"\" + actionArgs].searchString === '')) {\n            this.parent.query.expands = [];\n        }\n        if (!this.parent.hasChildMapping && !this.parentItems.length &&\n            (this.parent.loadChildOnDemand)) {\n            this.zerothLevelData = args;\n            setValue('cancel', true, args);\n        }\n        else {\n            if (this.parent.loadChildOnDemand) {\n                var _loop_1 = function (rec) {\n                    if (isCountRequired(this_1.parent) && records[parseInt(rec.toString(), 10)].hasChildRecords &&\n                        this_1.parent.initialRender) {\n                        records[parseInt(rec.toString(), 10)].expanded = false;\n                    }\n                    if (isRemoteData(this_1.parent) && this_1.parent.enableVirtualization) {\n                        var childRecords_1 = [];\n                        var parent_1 = this_1.parent;\n                        records.filter(function (e) {\n                            if (e[\"\" + parent_1.parentIdMapping] === records[parseInt(rec.toString(), 10)][\"\" + parent_1.idMapping]) {\n                                childRecords_1.push(e);\n                            }\n                        });\n                        if (childRecords_1.length) {\n                            records[parseInt(rec.toString(), 10)].expanded = true;\n                        }\n                        else if (records[parseInt(rec.toString(), 10)].hasChildRecords) {\n                            records[parseInt(rec.toString(), 10)].expanded = false;\n                        }\n                    }\n                    if (isNullOrUndefined(records[parseInt(rec.toString(), 10)].index)) {\n                        records[parseInt(rec.toString(), 10)].taskData = extend({}, records[parseInt(rec.toString(), 10)]);\n                        records[parseInt(rec.toString(), 10)].uniqueID = getUid(this_1.parent.element.id + '_data_');\n                        setValue('uniqueIDCollection.' + records[parseInt(rec.toString(), 10)].uniqueID, records[parseInt(rec.toString(), 10)], this_1.parent);\n                        records[parseInt(rec.toString(), 10)].level = 0;\n                        if (isRemoteData(this_1.parent) && this_1.parent.enableVirtualization && records[parseInt(rec.toString(), 10)][\"\" + this_1.parent.parentIdMapping] && records[parseInt(rec.toString(), 10)].level === 0) {\n                            records[parseInt(rec.toString(), 10)].level = records[parseInt(rec.toString(), 10)].level + 1;\n                        }\n                        records[parseInt(rec.toString(), 10)].index = Math.ceil(Math.random() * 1000);\n                        if ((records[parseInt(rec.toString(), 10)][this_1.parent.hasChildMapping] ||\n                            this_1.parentItems.indexOf(records[parseInt(rec.toString(), 10)][this_1.parent.idMapping]) !== -1)) {\n                            records[parseInt(rec.toString(), 10)].hasChildRecords = true;\n                        }\n                        records[parseInt(rec.toString(), 10)].checkboxState = 'uncheck';\n                    }\n                };\n                var this_1 = this;\n                for (var rec = 0; rec < records.length; rec++) {\n                    _loop_1(rec);\n                }\n            }\n            else {\n                var dataResults = 'dataResults';\n                var expandRecord = 'expandRecord';\n                if (!isNullOrUndefined(records) && !((!this.parent.loadChildOnDemand) && isCountRequired(this.parent) && !isNullOrUndefined(this.parent[\"\" + dataResults][\"\" + expandRecord])) &&\n                    !(isRemoteData(this.parent) && !this.parent.loadChildOnDemand && args[\"\" + actionArgs].isExpandCollapse && this.parent.enableVirtualization)) {\n                    this.convertToFlatData(records);\n                }\n            }\n        }\n        if (isRemoteData(this.parent) && !this.parent.loadChildOnDemand && args[\"\" + actionArgs].isExpandCollapse && this.parent.enableVirtualization) {\n            args.result = records;\n        }\n        else if (isRemoteData(this.parent) && this.parent.enableVirtualization && this.parent.loadChildOnDemand) {\n            args.result = records;\n        }\n        else {\n            args.result = !this.parent.loadChildOnDemand ? this.parent.flatData : records;\n        }\n        if (isRemoteData(this.parent) && this.parent.enableVirtualization && !this.parent.loadChildOnDemand\n            && this.parent.grid.aggregates.length && this.parent.grid.sortSettings.columns.length === 0\n            && this.parent.grid.filterSettings.columns.length === 0 && !this.parent.grid.searchSettings.key.length) {\n            var query = 'query';\n            var summaryQuery = args[\"\" + query].queries.filter(function (q) { return q.fn === 'onAggregates'; });\n            args.result = this.parent.summaryModule.calculateSummaryValue(summaryQuery, this.parent.flatData, true);\n        }\n        this.parent.notify('updateResults', args);\n    };\n    /**\n     * Function to manipulate datasource\n     *\n     * @param {{record: ITreeData, rows: HTMLTableRowElement[], parentRow: HTMLTableRowElement}} rowDetails - Row details for which child rows has to be fetched\n     * @param {ITreeData} rowDetails.record - current expanding record\n     * @param {HTMLTableRowElement[]} rowDetails.rows - Expanding Row element\n     * @param {HTMLTableRowElement} rowDetails.parentRow  - Curent expanding row element\n     * @param {boolean} isChild - Specified whether current record is already a child record\n     * @hidden\n     * @returns {void}\n     */\n    DataManipulation.prototype.collectExpandingRecs = function (rowDetails, isChild) {\n        var gridRows = this.parent.getRows();\n        var name = 'name';\n        if (this.parent.rowTemplate) {\n            var rows = this.parent.getContentTable().rows;\n            gridRows = [].slice.call(rows);\n        }\n        var childRecord;\n        if (rowDetails.rows.length > 0) {\n            if (!isChild) {\n                rowDetails.record.expanded = true;\n            }\n            for (var i = 0; i < rowDetails.rows.length; i++) {\n                this.parent['toggleRowVisibility'](rowDetails.rows[parseInt(i.toString(), 10)], 'e-childrow-visible');\n                if (!this.parent.loadChildOnDemand) {\n                    var targetEle = rowDetails.rows[parseInt(i.toString(), 10)].getElementsByClassName('e-treegridcollapse')[0];\n                    childRecord = this.parent.rowTemplate ?\n                        this.parent.grid.getCurrentViewRecords()[rowDetails.rows[parseInt(i.toString(), 10)].rowIndex] :\n                        this.parent.grid.getRowObjectFromUID(rowDetails.rows[parseInt(i.toString(), 10)].getAttribute('data-Uid')).data;\n                    if (!isNullOrUndefined(targetEle) && childRecord.expanded) {\n                        addClass([targetEle], 'e-treegridexpand');\n                        removeClass([targetEle], 'e-treegridcollapse');\n                    }\n                    var childRows = [];\n                    childRows = gridRows.filter(function (r) {\n                        return r.querySelector('.e-gridrowindex' + childRecord.index + 'level' + (childRecord.level + 1));\n                    });\n                    if (childRows.length && childRecord.expanded) {\n                        this.collectExpandingRecs({ record: childRecord, rows: childRows, parentRow: rowDetails.parentRow }, true);\n                    }\n                }\n                var expandingTd = rowDetails.rows[parseInt(i.toString(), 10)].querySelector('.e-detailrowcollapse');\n                if (!isNullOrUndefined(expandingTd)) {\n                    this.parent.grid.detailRowModule.expand(expandingTd);\n                }\n            }\n        }\n        else {\n            this.fetchRemoteChildData({ action: rowDetails[\"\" + name], record: rowDetails.record, rows: rowDetails.rows, parentRow: rowDetails.parentRow });\n        }\n    };\n    DataManipulation.prototype.fetchRemoteChildData = function (rowDetails) {\n        var _this = this;\n        var args = { row: rowDetails.parentRow, data: rowDetails.record };\n        var dm = this.parent.dataSource;\n        var qry = this.parent.grid.getDataModule().generateQuery();\n        var clonequries = qry.queries.filter(function (e) { return e.fn !== 'onPage' && e.fn !== 'onWhere'; });\n        qry.queries = clonequries;\n        qry.isCountRequired = true;\n        var idMappingValue = parseInt(rowDetails.record[this.parent.idMapping], 10);\n        if (isNaN(idMappingValue)) {\n            idMappingValue = rowDetails.record[this.parent.idMapping].toString();\n        }\n        if (this.parent.enableVirtualization && rowDetails.action === 'remoteExpand') {\n            qry.take(this.parent.pageSettings.pageSize);\n            var expandDetail = [];\n            expandDetail.push('ExpandingAction', idMappingValue.toString());\n            qry.expand(expandDetail);\n        }\n        else if (this.parent.enableVirtualization && rowDetails.action === 'collapse') {\n            qry.take(this.parent.grid.pageSettings.pageSize);\n            var expandDetail = [];\n            expandDetail.push('CollapsingAction', idMappingValue.toString());\n            qry.expand(expandDetail);\n        }\n        qry.where(this.parent.parentIdMapping, 'equal', rowDetails.record[this.parent.idMapping]);\n        if (rowDetails.action === 'remoteExpand' && this.parent.grid.filterModule && this.parent.grid.filterModule['value']) {\n            var filterqry = this.parent.grid.getDataModule().generateQuery().queries.filter(function (e) { return e.fn !== 'onPage' && typeof e.e.predicates !== 'undefined'; });\n            qry.queries.push(filterqry[0]);\n        }\n        showSpinner(this.parent.element);\n        dm.executeQuery(qry).then(function (e) {\n            var remoteExpandedData = 'remoteExpandedData';\n            var remoteCollapsedData = 'remoteCollapsedData';\n            var level = 'level';\n            var datas = _this.parent.grid.currentViewData.slice();\n            var inx;\n            var idMapping = _this.parent.idMapping;\n            if (_this.parent['isGantt'] && _this.parent.loadChildOnDemand && _this.parent.hasChildMapping) {\n                for (var i = 0; i < _this.parent.grid.currentViewData.length; i++) {\n                    if (rowDetails.record[idMapping] === _this.parent.grid.currentViewData[i][idMapping]) {\n                        inx = i;\n                        break;\n                    }\n                }\n            }\n            else {\n                inx = datas.indexOf(rowDetails.record);\n            }\n            if (_this.parent.enableVirtualization && (rowDetails.action === 'collapse' || rowDetails.action === 'remoteExpand')) {\n                datas = [];\n                for (var i = 0; i < inx; i++) {\n                    datas.push(_this.parent.grid.currentViewData[parseInt(i.toString(), 10)]);\n                }\n            }\n            if (inx === -1) {\n                _this.parent.grid.getRowsObject().forEach(function (rows) {\n                    if (rows.data.uniqueID === rowDetails.record.uniqueID) {\n                        inx = rows.index;\n                    }\n                });\n            }\n            var haveChild = getObject('actual.nextLevel', e);\n            var result = e.result;\n            var resultChildData = [];\n            if (rowDetails.action === 'remoteExpand' && _this.parent.grid.filterModule && _this.parent.grid.filterModule['value']) {\n                for (var i = 0; i < datas.length; i++) {\n                    if (Object.prototype.hasOwnProperty.call(datas[parseInt(i.toString(), 10)], _this.parent.parentIdMapping) && datas[parseInt(i.toString(), 10)]['' + _this.parent.parentIdMapping] !== null && datas[parseInt(i.toString(), 10)].level === 0) {\n                        datas.splice(i, 1);\n                        i--;\n                    }\n                }\n                for (var i = 0; i < result.length; i++) {\n                    if (rowDetails.record['' + _this.parent.idMapping] !== result[parseInt(i.toString(), 10)]['' + _this.parent.idMapping] &&\n                        rowDetails.record['' + _this.parent.idMapping] === result[parseInt(i.toString(), 10)]['' + _this.parent.parentIdMapping]) {\n                        if (Object.prototype.hasOwnProperty.call(result, i)) {\n                            resultChildData.push(result[parseInt(i.toString(), 10)]);\n                        }\n                    }\n                }\n                result = resultChildData;\n            }\n            if (_this.parent.enableVirtualization && rowDetails.action === 'remoteExpand') {\n                rowDetails.record.childRecords = [];\n                for (var i = 0; i < result.length; i++) {\n                    if (rowDetails.record['' + _this.parent.idMapping] !== result[parseInt(i.toString(), 10)]['' + _this.parent.idMapping] &&\n                        rowDetails.record['' + _this.parent.idMapping] === result[parseInt(i.toString(), 10)]['' + _this.parent.parentIdMapping] && Object.prototype.hasOwnProperty.call(result, i)) {\n                        rowDetails.record.childRecords.push(result[parseInt(i.toString(), 10)]);\n                    }\n                }\n            }\n            else {\n                rowDetails.record.childRecords = result;\n            }\n            for (var r = 0; r < result.length; r++) {\n                if (_this.parent.enableVirtualization && result[parseInt(r.toString(), 10)][\"\" + _this.parent.idMapping] === rowDetails.record[\"\" + _this.parent.idMapping] && rowDetails.action === 'remoteExpand') {\n                    _this.parent[\"\" + remoteExpandedData].push(rowDetails.record);\n                }\n                else if (_this.parent.enableVirtualization && result[parseInt(r.toString(), 10)][\"\" + _this.parent.idMapping] === rowDetails.record[\"\" + _this.parent.idMapping] && rowDetails.action === 'collapse') {\n                    for (var i = 0; i < _this.parent[\"\" + remoteExpandedData].length; i++) {\n                        if (rowDetails.record[\"\" + _this.parent.idMapping] === _this.parent[\"\" + remoteExpandedData][parseInt(i.toString(), 10)][\"\" + _this.parent.idMapping]) {\n                            _this.parent[\"\" + remoteExpandedData].splice(i, 1);\n                        }\n                    }\n                }\n                result[parseInt(r.toString(), 10)].taskData = extend({}, result[parseInt(r.toString(), 10)]);\n                if (result[parseInt(r.toString(), 10)][\"\" + _this.parent.parentIdMapping] && _this.parent.enableVirtualization && _this.parent[\"\" + remoteExpandedData].length) {\n                    for (var i = 0; i < _this.parent[\"\" + remoteExpandedData].length; i++) {\n                        if (result[parseInt(r.toString(), 10)][\"\" + _this.parent.parentIdMapping] === _this.parent[\"\" + remoteExpandedData][parseInt(i.toString(), 10)][\"\" + _this.parent.idMapping]) {\n                            result[parseInt(r.toString(), 10)].level = _this.parent[\"\" + remoteExpandedData][parseInt(i.toString(), 10)][\"\" + level] + 1;\n                            var parentData = _this.parent[\"\" + remoteExpandedData][parseInt(i.toString(), 10)];\n                            delete parentData.childRecords;\n                            result[parseInt(r.toString(), 10)].parentItem = parentData;\n                            result[parseInt(r.toString(), 10)].parentUniqueID = rowDetails.record.uniqueID;\n                        }\n                    }\n                }\n                else if (_this.parent.enableVirtualization) {\n                    if ((result[parseInt(r.toString(), 10)][\"\" + _this.parent.hasChildMapping] ||\n                        _this.parentItems.indexOf(result[parseInt(r.toString(), 10)][\"\" + _this.parent.idMapping]) !== -1)\n                        && !(haveChild && !haveChild[parseInt(r.toString(), 10)])) {\n                        if (isNullOrUndefined(result[parseInt(r.toString(), 10)][\"\" + _this.parent.parentIdMapping])) {\n                            result[parseInt(r.toString(), 10)].level = 0;\n                            if (rowDetails.action === 'remoteExpand') {\n                                result[parseInt(r.toString(), 10)].childRecords = [];\n                                result[parseInt(r.toString(), 10)].childRecords = rowDetails.record.childRecords;\n                            }\n                        }\n                        else {\n                            result[parseInt(r.toString(), 10)].level = rowDetails.record.level;\n                        }\n                    }\n                    else {\n                        var parentData = extend({}, rowDetails.record);\n                        delete parentData.childRecords;\n                        result[parseInt(r.toString(), 10)].parentItem = parentData;\n                        result[parseInt(r.toString(), 10)].parentUniqueID = rowDetails.record.uniqueID;\n                    }\n                }\n                else {\n                    result[parseInt(r.toString(), 10)].level = rowDetails.record.level + 1;\n                    var parentData = extend({}, rowDetails.record);\n                    delete parentData.childRecords;\n                    result[parseInt(r.toString(), 10)].parentItem = parentData;\n                    result[parseInt(r.toString(), 10)].parentUniqueID = rowDetails.record.uniqueID;\n                }\n                result[parseInt(r.toString(), 10)].index = Math.ceil(Math.random() * 1000);\n                result[parseInt(r.toString(), 10)].uniqueID = getUid(_this.parent.element.id + '_data_');\n                result[parseInt(r.toString(), 10)].checkboxState = 'uncheck';\n                if (_this.parent.enableVirtualization && isNullOrUndefined(result[parseInt(r.toString(), 10)].level)) {\n                    for (var p = 0; p < _this.parent.grid.currentViewData.length; p++) {\n                        if (_this.parent.grid.currentViewData[parseInt(p.toString(), 10)][\"\" + _this.parent.idMapping] === result[parseInt(r.toString(), 10)][\"\" + _this.parent.parentIdMapping]) {\n                            result[parseInt(r.toString(), 10)].level = _this.parent.grid.currentViewData[parseInt(p.toString(), 10)]['level'] + 1;\n                        }\n                    }\n                }\n                setValue('uniqueIDCollection.' + result[parseInt(r.toString(), 10)].uniqueID, result[parseInt(r.toString(), 10)], _this.parent);\n                // delete result[r].parentItem.childRecords;\n                if ((result[parseInt(r.toString(), 10)][\"\" + _this.parent.hasChildMapping] ||\n                    _this.parentItems.indexOf(result[parseInt(r.toString(), 10)][\"\" + _this.parent.idMapping]) !== -1)\n                    && !(haveChild && !haveChild[parseInt(r.toString(), 10)])) {\n                    result[parseInt(r.toString(), 10)].hasChildRecords = true;\n                    if (_this.parent.enableVirtualization && !_this.parent.loadChildOnDemand) {\n                        for (var i = 0; i < _this.parent[\"\" + remoteCollapsedData].length; i++) {\n                            if (result[parseInt(r.toString(), 10)][\"\" + _this.parent.idMapping] === _this.parent[\"\" + remoteCollapsedData][parseInt(i.toString(), 10)][\"\" + _this.parent.idMapping]) {\n                                result[parseInt(r.toString(), 10)].expanded = _this.parent[\"\" + remoteCollapsedData][parseInt(i.toString(), 10)]['expanded'];\n                            }\n                        }\n                        if (rowDetails.action === 'collapse' && result[parseInt(r.toString(), 10)][\"\" + _this.parent.idMapping] !== rowDetails.record[\"\" + _this.parent.idMapping] && result[parseInt(r.toString(), 10)].expanded !== false) {\n                            result[parseInt(r.toString(), 10)].expanded = true;\n                        }\n                        else if (rowDetails.action === 'collapse' && result[parseInt(r.toString(), 10)][\"\" + _this.parent.idMapping] === rowDetails.record[\"\" + _this.parent.idMapping]) {\n                            result[parseInt(r.toString(), 10)].expanded = false;\n                            _this.parent[\"\" + remoteCollapsedData].push(rowDetails.record);\n                        }\n                        else if (rowDetails.action === 'remoteExpand') {\n                            for (var i = 0; i < _this.parent.grid.currentViewData.length; i++) {\n                                if (_this.parent.grid.currentViewData[parseInt(i.toString(), 10)][\"\" + _this.parent.idMapping] === result[parseInt(r.toString(), 10)][\"\" + _this.parent.idMapping]) {\n                                    result.splice(r, 1, _this.parent.grid.currentViewData[parseInt(i.toString(), 10)]);\n                                }\n                            }\n                            if (result[parseInt(r.toString(), 10)][_this.parent.idMapping] === rowDetails.record[\"\" + _this.parent.idMapping]) {\n                                for (var i = 0; i < _this.parent[\"\" + remoteCollapsedData].length; i++) {\n                                    if (rowDetails.record[\"\" + _this.parent.idMapping] === _this.parent[\"\" + remoteCollapsedData][parseInt(i.toString(), 10)][\"\" + _this.parent.idMapping]) {\n                                        _this.parent[\"\" + remoteCollapsedData].splice(i, 1);\n                                    }\n                                }\n                            }\n                            if (result[parseInt(r.toString(), 10)].expanded !== false) {\n                                result[parseInt(r.toString(), 10)].expanded = true;\n                            }\n                        }\n                    }\n                    else if (_this.parent.enableVirtualization && result[parseInt(r.toString(), 10)][\"\" + _this.parent.idMapping] === rowDetails.record[\"\" + _this.parent.idMapping] && rowDetails.action !== 'collapse') {\n                        result[parseInt(r.toString(), 10)].expanded = true;\n                    }\n                    else if (!(_this.parent.enableVirtualization && !_this.parent.loadChildOnDemand)) {\n                        result[parseInt(r.toString(), 10)].expanded = false;\n                    }\n                }\n                datas.splice(inx + r + 1, 0, result[parseInt(r.toString(), 10)]);\n            }\n            setValue('result', datas, e);\n            setValue('action', 'beforecontentrender', e);\n            _this.parent.trigger(events.actionComplete, e);\n            hideSpinner(_this.parent.element);\n            if (_this.parent.grid.aggregates.length > 0 && !_this.parent.enableVirtualization) {\n                var gridQuery = getObject('query', e);\n                var result_1 = 'result';\n                if (isNullOrUndefined(gridQuery)) {\n                    gridQuery = getValue('grid.renderModule.data', _this.parent).aggregateQuery(new Query());\n                }\n                if (!isNullOrUndefined(gridQuery)) {\n                    var summaryQuery = gridQuery.queries.filter(function (q) { return q.fn === 'onAggregates'; });\n                    e[\"\" + result_1] = _this.parent.summaryModule.calculateSummaryValue(summaryQuery, e[\"\" + result_1], true);\n                }\n            }\n            if (rowDetails.action === 'remoteExpand' && _this.parent.allowPaging && _this.parent.pageSettings.pageSizeMode === 'All') {\n                _this.parent.grid.pageSettings.totalRecordsCount = _this.parent.grid.pageSettings.totalRecordsCount + result.length;\n            }\n            if (_this.parent.enableVirtualization) {\n                _this.parent.grid.pageSettings.totalRecordsCount = e.count;\n            }\n            e.count = _this.parent.grid.pageSettings.totalRecordsCount;\n            var virtualArgs = {};\n            if (_this.parent.enableVirtualization) {\n                _this.remoteVirtualAction(virtualArgs);\n            }\n            var notifyArgs = { index: inx, childData: result };\n            if (_this.parent.enableInfiniteScrolling) {\n                _this.parent.notify('infinite-remote-expand', notifyArgs);\n            }\n            else {\n                getValue('grid.renderModule', _this.parent).dataManagerSuccess(e, virtualArgs);\n            }\n            _this.parent.trigger(events.expanded, args);\n        });\n    };\n    DataManipulation.prototype.remoteVirtualAction = function (virtualArgs) {\n        virtualArgs.requestType = 'refresh';\n        setValue('isExpandCollapse', true, virtualArgs);\n        var contentModule = getValue('grid.contentModule', this.parent);\n        var currentInfo = getValue('currentInfo', contentModule);\n        var prevInfo = getValue('prevInfo', contentModule);\n        if (currentInfo.loadNext && this.parent.grid.pageSettings.currentPage === currentInfo.nextInfo.page) {\n            this.parent.grid.pageSettings.currentPage = prevInfo.page;\n        }\n    };\n    DataManipulation.prototype.beginSorting = function () {\n        this.isSortAction = true;\n        if (isRemoteData(this.parent) && this.parent.enableVirtualization) {\n            var index = this.parent.query.queries.indexOf(this.parent.query.queries.filter(function (q) { return q.fn === 'onSortBy'; })[0]);\n            if (index !== -1) {\n                this.parent.query.queries.splice(index, 1);\n            }\n            if (this.parent.grid.sortSettings.columns.length === 0) {\n                this.parent.query.sortBy(null, null);\n            }\n        }\n    };\n    DataManipulation.prototype.createRecords = function (data, parentRecords) {\n        var treeGridData = [];\n        var keys = Object.keys(data);\n        for (var i = 0, len = keys.length; i < len; i++) {\n            var currentData = extend({}, data[parseInt(i.toString(), 10)]);\n            currentData.taskData = data[parseInt(i.toString(), 10)];\n            var level = 0;\n            this.storedIndex++;\n            if (!Object.prototype.hasOwnProperty.call(currentData, 'index')) {\n                currentData.index = this.storedIndex;\n            }\n            var childMapping = currentData[this.parent.childMapping];\n            var hasChildren = !isNullOrUndefined(childMapping) && childMapping.length > 0;\n            var shouldCount = isCountRequired(this.parent);\n            var hasChildMapping = currentData[this.parent.hasChildMapping];\n            if ((hasChildren && !shouldCount) || (hasChildMapping && shouldCount)) {\n                currentData.hasChildRecords = true;\n            }\n            else {\n                currentData.hasChildRecords = false;\n            }\n            if ((!isNullOrUndefined(childMapping) && !shouldCount) ||\n                (hasChildMapping) && shouldCount) {\n                if (this.parent.enableCollapseAll || !isNullOrUndefined(this.parent.dataStateChange)\n                    && isNullOrUndefined(childMapping)) {\n                    currentData.expanded = false;\n                }\n                else {\n                    currentData.expanded = !isNullOrUndefined(currentData[this.parent.expandStateMapping])\n                        ? currentData[this.parent.expandStateMapping] : true;\n                }\n            }\n            if (!Object.prototype.hasOwnProperty.call(currentData, 'index')) {\n                currentData.index = currentData.hasChildRecords ? this.storedIndex : this.storedIndex;\n            }\n            if (this.isSelfReference && isNullOrUndefined(currentData[this.parent.parentIdMapping])) {\n                this.parent.parentData.push(currentData);\n            }\n            currentData.uniqueID = getUid(this.parent.element.id + '_data_');\n            setValue('uniqueIDCollection.' + currentData.uniqueID, currentData, this.parent);\n            if (!isNullOrUndefined(parentRecords)) {\n                var parentData = extend({}, parentRecords);\n                delete parentData.childRecords;\n                delete parentData[this.parent.childMapping];\n                if (this.isSelfReference) {\n                    delete parentData.taskData[this.parent.childMapping];\n                }\n                currentData.parentItem = parentData;\n                currentData.parentUniqueID = parentData.uniqueID;\n                level = parentRecords.level + 1;\n            }\n            if (!Object.prototype.hasOwnProperty.call(currentData, 'level')) {\n                currentData.level = level;\n            }\n            currentData.checkboxState = 'uncheck';\n            var remoteCollapsedData = 'remoteCollapsedData';\n            if (this.parent.enableVirtualization && !this.parent.loadChildOnDemand && isRemoteData(this.parent)\n                && !this.parent.initialRender) {\n                if (!currentData.hasChildRecords && isNullOrUndefined(currentData[\"\" + this.parent.parentIdMapping])) {\n                    currentData.hasChildRecords = true;\n                    for (var c = 0; c < this.parent[\"\" + remoteCollapsedData].length; c++) {\n                        if (this.parent[\"\" + remoteCollapsedData][parseInt(c.toString(), 10)][\"\" + this.parent.idMapping] === currentData[\"\" + this.parent.idMapping]) {\n                            currentData.expanded = false;\n                        }\n                    }\n                }\n                else if (currentData.level === 0 && isNullOrUndefined(parentRecords) && !currentData.hasChildRecords) {\n                    currentData.level = currentData.level + 1;\n                }\n                if (currentData[\"\" + this.parent.hasChildMapping] && !isNullOrUndefined(currentData[\"\" + this.parent.expandStateMapping])) {\n                    currentData.expanded = currentData[\"\" + this.parent.expandStateMapping];\n                    currentData.hasChildRecords = true;\n                }\n                this.parent.flatData.push(currentData);\n            }\n            else if (isNullOrUndefined(currentData[\"\" + this.parent.parentIdMapping]) || currentData.parentItem) {\n                this.parent.flatData.push(currentData);\n                this.parent['infiniteScrollData'].push(currentData);\n            }\n            if (!this.isSelfReference && currentData.level === 0) {\n                this.parent.parentData.push(currentData);\n            }\n            if (!isNullOrUndefined(currentData[this.parent.childMapping] && currentData[this.parent.childMapping].length)) {\n                var record = this.createRecords(currentData[this.parent.childMapping], currentData);\n                currentData.childRecords = record;\n            }\n            treeGridData.push(currentData);\n        }\n        return treeGridData;\n    };\n    /**\n     * Function to perform filtering/sorting action for local data\n     *\n     * @param {BeforeDataBoundArgs} args - data details to be processed before binding to grid\n     * @hidden\n     * @returns {void}\n     */\n    DataManipulation.prototype.dataProcessor = function (args) {\n        var isExport = getObject('isExport', args);\n        var expresults = getObject('expresults', args);\n        var exportType = getObject('exportType', args);\n        var isPrinting = getObject('isPrinting', args);\n        var dataObj;\n        var actionArgs = getObject('actionArgs', args);\n        var requestType = getObject('requestType', args);\n        var actionData = getObject('data', args);\n        var action = getObject('action', args);\n        var actionAddArgs = actionArgs;\n        var primaryKeyColumnName = this.parent.getPrimaryKeyFieldNames()[0];\n        var dataValue = getObject('data', actionAddArgs);\n        if ((!isNullOrUndefined(actionAddArgs)) && (!isNullOrUndefined(actionAddArgs.action)) && (actionAddArgs.action === 'add')\n            && (!isNullOrUndefined(actionAddArgs.data)) && isNullOrUndefined(actionAddArgs.data[\"\" + primaryKeyColumnName])) {\n            actionAddArgs.data[\"\" + primaryKeyColumnName] = args.result[actionAddArgs.index][\"\" + primaryKeyColumnName];\n            dataValue.taskData[\"\" + primaryKeyColumnName] = args.result[actionAddArgs.index][\"\" + primaryKeyColumnName];\n        }\n        if ((!isNullOrUndefined(actionArgs) && Object.keys(actionArgs).length) || requestType === 'save') {\n            requestType = requestType ? requestType : actionArgs.requestType;\n            actionData = actionData ? actionData : getObject('data', actionArgs);\n            action = action ? action : getObject('action', actionArgs);\n            if (this.parent.editSettings.mode === 'Batch') {\n                this.batchChanges = this.parent.grid.editModule.getBatchChanges();\n            }\n            if (this.parent.isLocalData) {\n                this.updateAction(actionData, action, requestType);\n            }\n        }\n        if (isExport && !isNullOrUndefined(expresults)) {\n            dataObj = expresults;\n        }\n        else {\n            dataObj = isCountRequired(this.parent) ? getValue('result', this.parent.grid.dataSource)\n                : this.parent.grid.dataSource;\n        }\n        var results = dataObj instanceof DataManager ? dataObj.dataSource.json : dataObj;\n        var count = isCountRequired(this.parent) ? getValue('count', this.parent.dataSource)\n            : results.length;\n        var qry = new Query();\n        var gridQuery = getObject('query', args);\n        var filterQuery;\n        var searchQuery;\n        if (!isNullOrUndefined(gridQuery)) {\n            filterQuery = gridQuery.queries.filter(function (q) { return q.fn === 'onWhere'; });\n            searchQuery = gridQuery.queries.filter(function (q) { return q.fn === 'onSearch'; });\n        }\n        if ((this.parent.grid.allowFiltering && this.parent.grid.filterSettings.columns.length) ||\n            (this.parent.grid.searchSettings.key.length > 0) || (!isNullOrUndefined(gridQuery) &&\n            (filterQuery.length || searchQuery.length) && this.parent.isLocalData)) {\n            if (isNullOrUndefined(gridQuery)) {\n                gridQuery = new Query();\n                gridQuery = getValue('grid.renderModule.data', this.parent).filterQuery(gridQuery);\n                gridQuery = getValue('grid.renderModule.data', this.parent).searchQuery(gridQuery);\n            }\n            var fltrQuery = gridQuery.queries.filter(function (q) { return q.fn === 'onWhere'; });\n            var srchQuery = gridQuery.queries.filter(function (q) { return q.fn === 'onSearch'; });\n            qry.queries = fltrQuery.concat(srchQuery);\n            var filteredData = new DataManager(results).executeLocal(qry);\n            this.parent.notify('updateFilterRecs', { data: filteredData });\n            results = this.dataResults.result;\n            this.dataResults.result = null;\n            if (this.parent.grid.aggregates.length > 0) {\n                var query = getObject('query', args);\n                if (isNullOrUndefined(gridQuery)) {\n                    gridQuery = getValue('grid.renderModule.data', this.parent).aggregateQuery(new Query());\n                }\n                if (!isNullOrUndefined(query)) {\n                    var summaryQuery = query.queries.filter(function (q) { return q.fn === 'onAggregates'; });\n                    results = this.parent.summaryModule.calculateSummaryValue(summaryQuery, results, true);\n                }\n            }\n        }\n        if (this.parent.grid.aggregates.length && this.parent.grid.sortSettings.columns.length === 0\n            && this.parent.grid.filterSettings.columns.length === 0 && !this.parent.grid.searchSettings.key.length) {\n            var gridQuery_1 = getObject('query', args);\n            if (isNullOrUndefined(gridQuery_1)) {\n                gridQuery_1 = getValue('grid.renderModule.data', this.parent).aggregateQuery(new Query());\n            }\n            var summaryQuery = gridQuery_1.queries.filter(function (q) { return q.fn === 'onAggregates'; });\n            results = this.parent.summaryModule.calculateSummaryValue(summaryQuery, this.parent.flatData, true);\n        }\n        if (this.parent.grid.sortSettings.columns.length > 0 || this.isSortAction) {\n            this.isSortAction = false;\n            var parentData = this.parent.parentData;\n            var query = getObject('query', args);\n            var srtQry = new Query();\n            for (var srt = this.parent.grid.sortSettings.columns.length - 1; srt >= 0; srt--) {\n                var getColumnByField = 'getColumnByField';\n                var col = this.parent.grid.renderModule.data[\"\" + getColumnByField](this.parent.grid.\n                    sortSettings.columns[parseInt(srt.toString(), 10)].field);\n                var compFun = col.sortComparer && isOffline(this.parent) ?\n                    col.sortComparer.bind(col) :\n                    this.parent.grid.sortSettings.columns[parseInt(srt.toString(), 10)].direction;\n                srtQry.sortBy(this.parent.grid.sortSettings.columns[parseInt(srt.toString(), 10)].field, compFun);\n            }\n            var modifiedData = new DataManager(parentData).executeLocal(srtQry);\n            if (this.parent.allowRowDragAndDrop && !isNullOrUndefined(this.parent.rowDragAndDropModule['draggedRecord']) &&\n                this.parent.rowDragAndDropModule['droppedRecord'].hasChildRecords && this.parent.rowDragAndDropModule['dropPosition'] !== 'middleSegment') {\n                var dragdIndex = modifiedData.indexOf(this.parent.rowDragAndDropModule['draggedRecord']);\n                modifiedData.splice(dragdIndex, 1);\n                var dropdIndex = modifiedData.indexOf(this.parent.rowDragAndDropModule['droppedRecord']);\n                if (this.parent.rowDragAndDropModule['droppedRecord'].hasChildRecords && this.parent.rowDragAndDropModule['dropPosition'] === 'topSegment') {\n                    modifiedData.splice(dropdIndex, 0, this.parent.rowDragAndDropModule['draggedRecord']);\n                }\n                else if (this.parent.rowDragAndDropModule['dropPosition'] === 'bottomSegment') {\n                    modifiedData.splice(dropdIndex + 1, 0, this.parent.rowDragAndDropModule['draggedRecord']);\n                }\n            }\n            var sortArgs = { modifiedData: modifiedData, filteredData: results, srtQry: srtQry };\n            this.parent.notify('createSort', sortArgs);\n            results = sortArgs.modifiedData;\n            this.dataResults.result = null;\n            this.sortedData = results;\n            this.parent.notify('updateModel', {});\n            if (this.parent.grid.aggregates.length > 0 && !isNullOrUndefined(query)) {\n                var isSort = false;\n                var query_1 = getObject('query', args);\n                var summaryQuery = query_1.queries.filter(function (q) { return q.fn === 'onAggregates'; });\n                results = this.parent.summaryModule.calculateSummaryValue(summaryQuery, this.sortedData, isSort);\n            }\n        }\n        count = isCountRequired(this.parent) ? getValue('count', this.parent.dataSource)\n            : results.length;\n        var temp = this.paging(results, count, isExport, isPrinting, exportType, args);\n        results = temp.result;\n        count = temp.count;\n        args.result = results;\n        args.count = count;\n        this.parent.notify('updateResults', args);\n    };\n    DataManipulation.prototype.paging = function (results, count, isExport, isPrinting, exportType, args) {\n        if (this.parent.allowPaging && (!isExport || exportType === 'CurrentPage')\n            && (!isPrinting || this.parent.printMode === 'CurrentPage')) {\n            this.parent.notify(events.pagingActions, { result: results, count: count, actionArgs: args });\n            results = this.dataResults.result;\n            count = isCountRequired(this.parent) ? getValue('count', this.parent.dataSource)\n                : this.dataResults.count;\n        }\n        else if ((this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) && (!isExport || exportType === 'CurrentPage')\n            && getValue('requestType', args) !== 'save') {\n            var actArgs = this.parent.enableInfiniteScrolling ? args : getValue('actionArgs', args);\n            this.parent.notify(events.pagingActions, { result: results, count: count, actionArgs: actArgs });\n            results = this.dataResults.result;\n            count = this.dataResults.count;\n        }\n        var isPdfExport = 'isPdfExport';\n        var isCollapsedStatePersist = 'isCollapsedStatePersist';\n        if ((isPrinting === true || (args[\"\" + isPdfExport] && (isNullOrUndefined(args[\"\" + isCollapsedStatePersist])\n            || args[\"\" + isCollapsedStatePersist]))) && this.parent.printMode === 'AllPages') {\n            var actualResults = [];\n            for (var i = 0; i < results.length; i++) {\n                var expandStatus = getExpandStatus(this.parent, results[parseInt(i.toString(), 10)], this.parent.parentData);\n                if (expandStatus) {\n                    actualResults.push(results[parseInt(i.toString(), 10)]);\n                }\n            }\n            results = actualResults;\n            count = results.length;\n        }\n        var value = { result: results, count: count };\n        return value;\n    };\n    DataManipulation.prototype.updateData = function (dataResult) {\n        this.dataResults = dataResult;\n    };\n    DataManipulation.prototype.updateAction = function (actionData, action, requestType) {\n        if ((requestType === 'delete' || requestType === 'save')) {\n            this.parent.notify(events.crudAction, { value: actionData, action: action || requestType });\n        }\n        if (requestType === 'batchsave' && this.parent.editSettings.mode === 'Batch') {\n            this.parent.notify(events.batchSave, {});\n        }\n    };\n    return DataManipulation;\n}());\nexport { DataManipulation };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}