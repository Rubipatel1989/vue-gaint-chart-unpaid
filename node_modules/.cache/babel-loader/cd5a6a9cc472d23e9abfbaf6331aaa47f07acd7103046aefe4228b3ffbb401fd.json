{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport * as events from '../base/constant';\nimport { isNullOrUndefined, closest, attributes, removeClass, addClass, Browser, detach } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined as isNOU } from '@syncfusion/ej2-base';\nimport { HTMLFormatter } from '../formatter/html-formatter';\nimport { RenderType } from '../base/enum';\nimport * as classes from '../base/classes';\nimport { HtmlToolbarStatus } from './html-toolbar-status';\nimport { IframeContentRender } from '../renderer/iframe-content-renderer';\nimport { ContentRender } from '../renderer/content-renderer';\nimport { NodeSelection } from '../../selection/selection';\nimport { InsertHtml } from '../../editor-manager/plugin/inserthtml';\nimport { getTextNodesUnder, sanitizeHelper, getDefaultValue } from '../base/util';\nimport { isIDevice, removeClassWithAttr, scrollToCursor } from '../../common/util';\nimport { XhtmlValidation } from './xhtml-validation';\nimport { ON_BEGIN } from './../../common/constant';\nimport * as CONSTANT from '../base/constant';\n/**\n * `HtmlEditor` module is used to HTML editor\n */\nvar HtmlEditor = /** @class */function () {\n  function HtmlEditor(parent, serviceLocator) {\n    this.rangeCollection = [];\n    this.isImageDelete = false;\n    this.parent = parent;\n    this.locator = serviceLocator;\n    this.renderFactory = this.locator.getService('rendererFactory');\n    this.xhtmlValidation = new XhtmlValidation(parent);\n    this.addEventListener();\n    this.isDestroyed = false;\n    this.isCopyAll = false;\n  }\n  /**\n   * Destroys the Markdown.\n   *\n   * @function destroy\n   * @returns {void}\n   * @hidden\n    */\n  HtmlEditor.prototype.destroy = function () {\n    if (this.isDestroyed) {\n      return;\n    }\n    if (this.clickTimeout) {\n      clearTimeout(this.clickTimeout);\n      this.clickTimeout = null;\n    }\n    this.removeEventListener();\n    this.locator = null;\n    this.contentRenderer = null;\n    this.renderFactory = null;\n    this.toolbarUpdate = null;\n    this.nodeSelectionObj = null;\n    this.isCopyAll = null;\n    if (this.rangeCollection.length > 0) {\n      this.rangeCollection = [];\n    }\n    if (this.rangeElement) {\n      this.rangeElement = null;\n    }\n    if (this.oldRangeElement) {\n      this.oldRangeElement = null;\n    }\n    if (this.deleteRangeElement) {\n      this.deleteRangeElement = null;\n    }\n    if (this.deleteOldRangeElement) {\n      this.deleteOldRangeElement = null;\n    }\n    if (this.saveSelection) {\n      this.saveSelection = null;\n    }\n    if (this.xhtmlValidation) {\n      this.xhtmlValidation = null;\n    }\n    this.isDestroyed = true;\n  };\n  /**\n   * @param {string} value - specifies the string value\n   * @returns {void}\n   * @hidden\n    */\n  HtmlEditor.prototype.sanitizeHelper = function (value) {\n    value = sanitizeHelper(value, this.parent);\n    return value;\n  };\n  HtmlEditor.prototype.addEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    this.nodeSelectionObj = new NodeSelection(this.parent.inputElement);\n    this.parent.on(events.initialLoad, this.instantiateRenderer, this);\n    this.parent.on(events.htmlToolbarClick, this.onToolbarClick, this);\n    this.parent.on(events.keyDown, this.onKeyDown, this);\n    this.parent.on(events.keyUp, this.onKeyUp, this);\n    this.parent.on(events.initialEnd, this.render, this);\n    this.parent.on(events.modelChanged, this.onPropertyChanged, this);\n    this.parent.on(events.destroy, this.destroy, this);\n    this.parent.on(events.selectAll, this.selectAll, this);\n    this.parent.on(events.selectRange, this.selectRange, this);\n    this.parent.on(events.getSelectedHtml, this.getSelectedHtml, this);\n    this.parent.on(events.selectionSave, this.onSelectionSave, this);\n    this.parent.on(events.selectionRestore, this.onSelectionRestore, this);\n    this.parent.on(events.readOnlyMode, this.updateReadOnly, this);\n    this.parent.on(events.paste, this.onPaste, this);\n    this.parent.on(events.tableclass, this.isTableClassAdded, this);\n    this.parent.on(events.onHandleFontsizeChange, this.onHandleFontsizeChange, this);\n  };\n  HtmlEditor.prototype.updateReadOnly = function () {\n    if (this.parent.readonly) {\n      attributes(this.parent.contentModule.getEditPanel(), {\n        contenteditable: 'false'\n      });\n      addClass([this.parent.element], classes.CLS_RTE_READONLY);\n    } else {\n      attributes(this.parent.contentModule.getEditPanel(), {\n        contenteditable: 'true'\n      });\n      removeClass([this.parent.element], classes.CLS_RTE_READONLY);\n    }\n  };\n  HtmlEditor.prototype.onSelectionSave = function () {\n    var currentDocument = this.contentRenderer.getDocument();\n    var range = this.nodeSelectionObj.getRange(currentDocument);\n    this.saveSelection = this.nodeSelectionObj.save(range, currentDocument);\n  };\n  HtmlEditor.prototype.onSelectionRestore = function (e) {\n    this.parent.isBlur = false;\n    if (isNullOrUndefined(e.items) || e.items) {\n      this.saveSelection.restore();\n    }\n  };\n  HtmlEditor.prototype.isTableClassAdded = function () {\n    var tableElement = this.parent.inputElement.querySelectorAll('table');\n    for (var i = 0; i < tableElement.length; i++) {\n      // e-rte-table class is added to the table element for styling.\n      // e-rte-paste-table class is added for pasted table element from MS Word and other sources such as Web will not have any styles.\n      // e-rte-custom-table class is added for custom table element will not have any styles.\n      if (!tableElement[i].classList.contains('e-rte-table') && !tableElement[i].classList.contains('e-rte-paste-table') && !tableElement[i].classList.contains('e-rte-custom-table')) {\n        tableElement[i].classList.add('e-rte-table');\n      }\n    }\n  };\n  HtmlEditor.prototype.onHandleFontsizeChange = function (e) {\n    var keyboardArgs = e.args;\n    var args = {\n      name: 'dropDownSelect'\n    };\n    args.item = {\n      command: 'Font',\n      subCommand: 'FontSize'\n    };\n    var items = this.parent.fontSize.items;\n    var activeElem;\n    if (this.parent.toolbarModule && this.parent.toolbarModule.dropDownModule && this.parent.toolbarModule.dropDownModule.fontSizeDropDown && !isNOU(this.parent.toolbarModule.dropDownModule.fontSizeDropDown.activeElem[0].textContent) && this.parent.toolbarModule.dropDownModule.fontSizeDropDown.activeElem[0].textContent !== '') {\n      activeElem = this.parent.toolbarModule.dropDownModule.fontSizeDropDown.activeElem[0].textContent;\n    } else {\n      var fontSizeValue = void 0;\n      var selection = this.parent.contentModule.getDocument().getSelection();\n      if (selection && selection.focusNode && selection.focusNode.parentElement) {\n        fontSizeValue = document.defaultView.getComputedStyle(selection.focusNode.parentElement, null).getPropertyValue('font-size');\n      } else {\n        fontSizeValue = this.parent.fontSize.width;\n      }\n      fontSizeValue = isNOU(fontSizeValue) ? this.parent.fontSize.width : fontSizeValue;\n      var actualTxtFontValues = fontSizeValue.match(/^([\\d.]+)(\\D+)$/);\n      var size_1 = parseInt(actualTxtFontValues[1], 10);\n      var unit = actualTxtFontValues[2];\n      var defaultFontValues = items[1].value.match(/^([\\d.]+)(\\D+)$/);\n      if (defaultFontValues[2] === unit) {\n        var index = items.findIndex(function (_a) {\n          var value = _a.value;\n          return parseInt(value, 10) >= size_1;\n        });\n        activeElem = items[index].text;\n      } else {\n        var convertedSize_1 = this.convertFontSize(size_1, unit, defaultFontValues[2]);\n        var index = items.findIndex(function (_a) {\n          var value = _a.value;\n          return parseInt(value, 10) >= convertedSize_1;\n        });\n        activeElem = items[index].text;\n      }\n    }\n    var fontIndex = items.findIndex(function (size) {\n      return size.text === (activeElem === 'Font Size' ? 'Default' : activeElem);\n    });\n    if (keyboardArgs.action === 'increase-fontsize' && fontIndex !== -1) {\n      if (fontIndex >= items.length - 1) {\n        var fontValues = items[fontIndex].value.match(/^([\\d.]+)(\\D+)$/);\n        if (fontValues) {\n          var size = parseInt(fontValues[1], 10);\n          var unit = fontValues[2];\n          var roundedSize = size % 10 === 0 ? Math.ceil((size + 1) / 10) * 10 : Math.ceil(size / 10) * 10;\n          args.item.value = roundedSize.toLocaleString() + unit;\n          args.item.text = roundedSize.toLocaleString() + ' ' + unit;\n        }\n        this.parent.fontSize.items.push(args.item);\n      } else {\n        args.item.value = items[fontIndex + 1].value;\n        args.item.text = items[fontIndex + 1].text;\n      }\n    } else if (keyboardArgs.action === 'decrease-fontsize' && fontIndex !== -1 && fontIndex > 0) {\n      args.item.value = items[fontIndex - 1].value;\n      args.item.text = items[fontIndex - 1].text;\n    } else {\n      if (fontIndex >= 0 && fontIndex < items.length && items[fontIndex]) {\n        args.item.value = items[fontIndex].value;\n        args.item.text = items[fontIndex].text;\n      }\n    }\n    this.parent.formatter.process(this.parent, args, keyboardArgs);\n  };\n  HtmlEditor.prototype.convertFontSize = function (value, originalUnit, targetUnit) {\n    if (CONSTANT.supportedUnits.indexOf(originalUnit) !== -1 || CONSTANT.supportedUnits.indexOf(targetUnit) !== -1) {\n      originalUnit = 'px';\n    }\n    var convertedValue = value * CONSTANT.conversionFactors[originalUnit][targetUnit];\n    return convertedValue;\n  };\n  HtmlEditor.prototype.onKeyUp = function (e) {\n    var args = e.args;\n    var restrictKeys = [8, 9, 13, 17, 18, 20, 27, 37, 38, 39, 40, 44, 45, 46, 91, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123];\n    var range = this.parent.getRange();\n    var regEx = new RegExp('\\u200B', 'g');\n    var isEmptyNode = range.startContainer === range.endContainer && range.startOffset === range.endOffset && range.startOffset === 1 && range.startContainer.textContent.length === 1 && range.startContainer.textContent.charCodeAt(0) === 8203 && range.startContainer.textContent.replace(regEx, '').length === 0;\n    var isMention = false;\n    if (range.startContainer === range.endContainer && range.startOffset === range.endOffset && range.startContainer !== this.parent.inputElement && range.startOffset !== 0) {\n      var mentionStartNode = range.startContainer.nodeType === 3 ? range.startContainer : range.startContainer.childNodes[range.startOffset - 1];\n      isMention = args.keyCode === 16 && mentionStartNode.textContent.charCodeAt(0) === 8203 && !isNOU(mentionStartNode.previousSibling) && mentionStartNode.previousSibling.contentEditable === 'false';\n    }\n    if (this.isCopyAll) {\n      return;\n    }\n    var pointer;\n    var isRootParent = false;\n    if (restrictKeys.indexOf(args.keyCode) < 0 && !args.shiftKey && !args.ctrlKey && !args.altKey && !isEmptyNode && !isMention) {\n      pointer = range.startOffset;\n      // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n      range.startContainer.nodeName === '#text' ? range.startContainer.parentElement !== this.parent.inputElement ? range.startContainer.parentElement.classList.add('currentStartMark') : isRootParent = true : range.startContainer.classList.add('currentStartMark');\n      if (range.startContainer.textContent.charCodeAt(0) === 8203) {\n        var previousLength_1 = range.startContainer.textContent.length;\n        var previousRange = range.startOffset;\n        range.startContainer.textContent = range.startContainer.textContent.replace(regEx, '');\n        pointer = previousRange === 0 ? previousRange : previousRange - (previousLength_1 - range.startContainer.textContent.length);\n        this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(), range.startContainer, pointer);\n      }\n      var previousLength = this.parent.inputElement.innerHTML.length;\n      var currentLength = this.parent.inputElement.innerHTML.replace(regEx, '').length;\n      var focusNode = range.startContainer;\n      if (previousLength > currentLength && !isRootParent) {\n        if (focusNode.textContent.trim().length !== 0 && focusNode.previousSibling) {\n          var tempSpan = document.createElement('span');\n          tempSpan.className = 'tempSpan';\n          range.insertNode(tempSpan);\n        }\n        var currentChild = this.parent.inputElement.firstChild;\n        while (!isNOU(currentChild)) {\n          if (currentChild.nodeName === '#text') {\n            currentChild = currentChild.nextElementSibling;\n            continue;\n          }\n          if (currentChild.textContent.replace(regEx, '').trim().length > 0 && currentChild.textContent.includes('\\u200B')) {\n            currentChild.innerHTML = currentChild.innerHTML.replace(regEx, '');\n          }\n          currentChild = currentChild.nextElementSibling;\n        }\n        var tempSpanToRemove = this.parent.inputElement.querySelector('.tempSpan');\n        if (tempSpanToRemove && tempSpanToRemove.previousSibling && focusNode.textContent.trim().length !== 0) {\n          focusNode = tempSpanToRemove.previousSibling;\n          pointer = tempSpanToRemove.previousSibling.textContent.length;\n          var parentElement = tempSpanToRemove.parentNode;\n          parentElement.removeChild(tempSpanToRemove);\n          tempSpanToRemove = null;\n        }\n        var currentChildNode = this.parent.inputElement.querySelector('.currentStartMark').childNodes;\n        if (currentChildNode.length > 1) {\n          for (var i = 0; i < currentChildNode.length; i++) {\n            if (currentChildNode[i].nodeName === '#text' && currentChildNode[i].textContent.length === 0) {\n              detach(currentChildNode[i]);\n              i--;\n            }\n            if (!isNOU(currentChildNode[i]) && focusNode.textContent.replace(regEx, '') === currentChildNode[i].textContent) {\n              pointer = focusNode.textContent.length > 1 ? focusNode.textContent === currentChildNode[i].textContent ? pointer : pointer - (focusNode.textContent.length - focusNode.textContent.replace(regEx, '').length) : focusNode.textContent.length;\n              focusNode = currentChildNode[i];\n            }\n          }\n        } else if (currentChildNode.length === 1) {\n          if (focusNode.textContent.replace(regEx, '') === currentChildNode[0].textContent) {\n            focusNode = currentChildNode[0];\n          }\n        }\n        this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(), focusNode, pointer);\n      }\n      var currentElem = this.parent.inputElement.querySelector('.currentStartMark');\n      if (!isNOU(currentElem)) {\n        currentElem.classList.remove('currentStartMark');\n        if (currentElem.getAttribute('class').trim() === '') {\n          currentElem.removeAttribute('class');\n        }\n      }\n      if (!isNOU(range.startContainer.previousSibling) && !isNOU(range.startContainer.previousSibling.parentElement) && range.startContainer.parentElement === range.startContainer.previousSibling.parentElement && range.startContainer.previousSibling.textContent.charCodeAt(0) === 8203 && range.startContainer.previousSibling.textContent.length <= 1) {\n        range.startContainer.previousSibling.textContent = range.startContainer.previousSibling.textContent.replace(regEx, '');\n      }\n      if (range.endContainer.textContent.charCodeAt(range.endOffset) === 8203) {\n        pointer = range.startOffset;\n        range.endContainer.textContent = range.endContainer.textContent.replace(regEx, '');\n        this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(), range.startContainer, pointer);\n      }\n    }\n  };\n  HtmlEditor.prototype.onKeyDown = function (e) {\n    var _this = this;\n    if (e.args.ctrlKey && e.args.keyCode === 65) {\n      this.isCopyAll = true;\n    } else {\n      this.isCopyAll = false;\n    }\n    var currentRange;\n    var args = e.args;\n    if (this.parent.inputElement.querySelectorAll('.e-cell-select').length > 1 && (args.keyCode === 8 || args.keyCode === 32 || args.keyCode === 13)) {\n      this.tableSelectionKeyAction(e);\n      this.parent.autoResize();\n      return;\n    }\n    if (Browser.info.name === 'chrome') {\n      currentRange = this.parent.getRange();\n      this.backSpaceCleanup(e, currentRange);\n      this.deleteCleanup(e, currentRange);\n    }\n    if (args.keyCode === 9 && this.parent.enableTabKey) {\n      this.parent.formatter.saveData(e);\n      if (!isNOU(args.target) && isNullOrUndefined(closest(args.target, '.e-rte-toolbar'))) {\n        var range = this.nodeSelectionObj.getRange(this.contentRenderer.getDocument());\n        var parentNode = this.nodeSelectionObj.getParentNodeCollection(range);\n        if (!(parentNode[0].nodeName === 'LI' || closest(parentNode[0], 'li') || closest(parentNode[0], 'table'))) {\n          args.preventDefault();\n          var selection = this.contentRenderer.getDocument().getSelection().getRangeAt(0);\n          var alignmentNodes = this.parent.formatter.editorManager.domNode.blockNodes();\n          if (this.parent.enterKey === 'BR') {\n            if (selection.startOffset !== selection.endOffset && selection.startOffset === 0) {\n              var save = this.nodeSelectionObj.save(range, this.contentRenderer.getDocument());\n              this.parent.formatter.editorManager.domNode.setMarker(save);\n              alignmentNodes = this.parent.formatter.editorManager.domNode.blockNodes();\n              this.parent.formatter.editorManager.domNode.convertToBlockNodes(alignmentNodes, false);\n              this.marginTabAdd(args.shiftKey, alignmentNodes);\n              save = this.parent.formatter.editorManager.domNode.saveMarker(save);\n              save.restore();\n            } else {\n              InsertHtml.Insert(this.contentRenderer.getDocument(), '&nbsp;&nbsp;&nbsp;&nbsp;');\n              this.rangeCollection.push(this.nodeSelectionObj.getRange(this.contentRenderer.getDocument()));\n            }\n          } else {\n            if (!args.shiftKey) {\n              if (selection.startOffset !== selection.endOffset && selection.startOffset === 0) {\n                this.marginTabAdd(args.shiftKey, alignmentNodes);\n              } else {\n                InsertHtml.Insert(this.contentRenderer.getDocument(), '&nbsp;&nbsp;&nbsp;&nbsp;');\n                this.rangeCollection.push(this.nodeSelectionObj.getRange(this.contentRenderer.getDocument()));\n              }\n            } else if (this.rangeCollection.length > 0 && this.rangeCollection[this.rangeCollection.length - 1].startContainer.textContent.length === 4) {\n              var textCont = this.rangeCollection[this.rangeCollection.length - 1].startContainer;\n              this.nodeSelectionObj.setSelectionText(this.contentRenderer.getDocument(), textCont, textCont, 0, textCont.textContent.length);\n              InsertHtml.Insert(this.contentRenderer.getDocument(), document.createTextNode(''));\n              this.rangeCollection.pop();\n            } else {\n              this.marginTabAdd(args.shiftKey, alignmentNodes);\n            }\n          }\n        }\n      }\n      this.parent.formatter.saveData(e);\n    }\n    if (e.args.action === 'space' || e.args.action === 'enter' || e.args.keyCode === 13) {\n      this.spaceLink(e.args);\n      if (this.parent.editorMode === 'HTML' && !this.parent.readonly) {\n        var currentLength = this.parent.getText().trim().replace(/(\\r\\n|\\n|\\r|\\t)/gm, '').replace(/\\u200B/g, '').length;\n        var selectionLength = this.parent.getSelection().length;\n        var totalLength = currentLength - selectionLength + 1;\n        if (!(this.parent.maxLength === -1 || totalLength <= this.parent.maxLength) && e.args.keyCode === 13) {\n          e.args.preventDefault();\n          return;\n        } else {\n          this.parent.notify(events.enterHandler, {\n            args: e.args\n          });\n          scrollToCursor(this.parent.contentModule.getDocument(), this.parent.inputElement);\n        }\n      }\n    }\n    if (e.args.action === 'space') {\n      var currentRange_1 = this.parent.getRange();\n      var editorValue = currentRange_1.startContainer.textContent.slice(0, currentRange_1.startOffset);\n      var orderedList_1 = this.isOrderedList(editorValue);\n      var unOrderedList = this.isUnOrderedList(editorValue);\n      var hasSplitedText = false;\n      if (orderedList_1 || unOrderedList) {\n        hasSplitedText = this.hasMultipleTextNode(currentRange_1);\n      }\n      if (!hasSplitedText && (orderedList_1 && !unOrderedList || unOrderedList && !orderedList_1)) {\n        var eventArgs_1 = {\n          callBack: null,\n          event: e.args,\n          name: 'keydown-handler'\n        };\n        var actionBeginArgs = {\n          cancel: false,\n          item: {\n            command: 'Lists',\n            subCommand: orderedList_1 ? 'OL' : 'UL'\n          },\n          name: 'actionBegin',\n          originalEvent: e.args,\n          requestType: orderedList_1 ? 'OL' : 'UL'\n        };\n        this.parent.trigger(events.actionBegin, actionBeginArgs, function (actionBeginArgs) {\n          if (!actionBeginArgs.cancel) {\n            _this.parent.formatter.editorManager.observer.notify(ON_BEGIN, eventArgs_1);\n            _this.parent.trigger(events.actionComplete, {\n              editorMode: _this.parent.editorMode,\n              elements: _this.parent.formatter.editorManager.domNode.blockNodes(),\n              event: e.args,\n              name: events.actionComplete,\n              range: _this.parent.getRange(),\n              requestType: orderedList_1 ? 'OL' : 'UL'\n            });\n          }\n        });\n      }\n    }\n    if (Browser.info.name === 'chrome' && (!isNullOrUndefined(this.rangeElement) && !isNullOrUndefined(this.oldRangeElement) || !isNullOrUndefined(this.deleteRangeElement) && !isNullOrUndefined(this.deleteOldRangeElement)) && currentRange.startContainer.parentElement.tagName !== 'TD' && currentRange.startContainer.parentElement.tagName !== 'TH') {\n      this.rangeElement = null;\n      this.oldRangeElement = null;\n      this.deleteRangeElement = null;\n      this.deleteOldRangeElement = null;\n      if (!this.isImageDelete) {\n        args.preventDefault();\n      }\n      args.preventDefault();\n    }\n    this.parent.autoResize();\n  };\n  HtmlEditor.prototype.isOrderedList = function (editorValue) {\n    editorValue = editorValue.replace(/\\u200B/g, '');\n    var olListStartRegex = [/^[1]+[.]+$/, /^[i]+[.]+$/, /^[a]+[.]+$/];\n    if (!isNullOrUndefined(editorValue)) {\n      for (var i = 0; i < olListStartRegex.length; i++) {\n        if (olListStartRegex[i].test(editorValue)) {\n          return true;\n        }\n      }\n    }\n    return false;\n  };\n  HtmlEditor.prototype.isUnOrderedList = function (editorValue) {\n    editorValue = editorValue.replace(/\\u200B/g, '');\n    var ulListStartRegex = [/^[*]$/, /^[-]$/];\n    if (!isNullOrUndefined(editorValue)) {\n      for (var i = 0; i < ulListStartRegex.length; i++) {\n        if (ulListStartRegex[i].test(editorValue)) {\n          return true;\n        }\n      }\n    }\n    return false;\n  };\n  HtmlEditor.prototype.hasMultipleTextNode = function (range) {\n    if (range && range.startContainer && range.startContainer.parentNode) {\n      var parentNode = range.startContainer.parentNode;\n      if (range.startContainer.previousElementSibling && range.startContainer.previousElementSibling.classList.contains('e-mention-chip') && !range.startContainer.previousElementSibling.isContentEditable) {\n        return true;\n      }\n      if (this.parent.enterKey === 'BR' || closest(parentNode, 'table')) {\n        return false;\n      }\n      var childNodes = parentNode.childNodes;\n      var textNodes = [];\n      for (var i = 0; i < childNodes.length; i++) {\n        var node = childNodes[i];\n        if (node && node.nodeType === Node.TEXT_NODE) {\n          textNodes.push(node);\n          if (textNodes.length > 1) {\n            return true;\n          }\n        }\n      }\n    }\n    return false;\n  };\n  HtmlEditor.prototype.backSpaceCleanup = function (e, currentRange) {\n    var isLiElement = false;\n    var isPreviousNotContentEditable = true;\n    if (!isNOU(currentRange.startContainer.previousSibling) && currentRange.startContainer.previousSibling.nodeName === 'SPAN') {\n      isPreviousNotContentEditable = currentRange.startContainer.previousSibling.contentEditable === 'false' ? false : true;\n    }\n    var checkNode = currentRange.startContainer.nodeName === '#text' ? currentRange.startContainer.parentElement : currentRange.startContainer;\n    var isSelectedPositionNotStart = closest(currentRange.startContainer.nodeName === '#text' ? currentRange.startContainer.parentElement : currentRange.startContainer, 'li') ? checkNode.nodeName !== 'li' && isNOU(checkNode.previousSibling) : true;\n    if (e.args.code === 'Backspace' && e.args.keyCode === 8 && currentRange.startOffset === 0 && currentRange.endOffset === 0 && this.parent.getSelection().length === 0 && currentRange.startContainer.textContent.length > 0 && currentRange.startContainer.parentElement.tagName !== 'TD' && currentRange.startContainer.parentElement.tagName !== 'TH' && isPreviousNotContentEditable && isSelectedPositionNotStart) {\n      if (!this.parent.formatter.editorManager.domNode.isBlockNode(checkNode) && !isNOU(checkNode.previousSibling) && checkNode.previousSibling.nodeName === 'BR' || !isNOU(currentRange.startContainer.previousSibling) && currentRange.startContainer.previousSibling.nodeName === 'BR') {\n        return;\n      }\n      this.rangeElement = this.getRootBlockNode(currentRange.startContainer);\n      if (this.rangeElement.tagName === 'OL' || this.rangeElement.tagName === 'UL') {\n        var liElement = this.getRangeLiNode(currentRange.startContainer);\n        if (liElement.previousElementSibling && liElement.previousElementSibling.childElementCount > 0) {\n          this.oldRangeElement = liElement.previousElementSibling.lastElementChild.nodeName === 'BR' ? liElement.previousElementSibling : liElement.previousElementSibling.lastChild;\n          if (!isNOU(liElement.lastElementChild) && liElement.lastElementChild.nodeName !== 'BR' && isNOU(liElement.lastElementChild.previousSibling) && liElement.lastChild.nodeName !== '#text') {\n            this.rangeElement = liElement.lastElementChild;\n            isLiElement = true;\n          } else {\n            this.rangeElement = liElement;\n          }\n        }\n      } else if (this.rangeElement === this.parent.inputElement || this.rangeElement.tagName === 'TABLE' || !isNOU(this.rangeElement.previousElementSibling) && this.rangeElement.previousElementSibling.tagName === 'TABLE') {\n        return;\n      } else {\n        this.oldRangeElement = this.rangeElement.previousElementSibling;\n      }\n      var findBlockElement = this.parent.formatter.editorManager.domNode.blockNodes();\n      if (!isNOU(findBlockElement[0]) && currentRange.collapsed && currentRange.startOffset === 0 && currentRange.endOffset === 0 && findBlockElement[0].style.marginLeft !== '') {\n        findBlockElement[0].style.marginLeft = parseInt(findBlockElement[0].style.marginLeft, 10) <= 20 ? '' : parseInt(findBlockElement[0].style.marginLeft, 10) - 20 + 'px';\n      }\n      if (isNOU(this.oldRangeElement)) {\n        return;\n      } else {\n        if (this.oldRangeElement.tagName === 'OL' || this.oldRangeElement.tagName === 'UL') {\n          this.oldRangeElement = this.oldRangeElement.lastElementChild.lastElementChild ? this.oldRangeElement.lastElementChild.lastElementChild : this.oldRangeElement.lastElementChild;\n        }\n        var lastNode = this.oldRangeElement.lastChild ? this.oldRangeElement.lastChild : this.oldRangeElement;\n        while (lastNode.nodeType !== 3 && lastNode.nodeName !== '#text' && lastNode.nodeName !== 'BR' && !isNOU(lastNode.lastChild)) {\n          lastNode = lastNode.lastChild;\n        }\n        if (lastNode.nodeName === 'IMG') {\n          this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(), lastNode.parentElement, lastNode.parentElement.childNodes.length);\n        } else {\n          this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),\n          // eslint-disable-next-line\n          lastNode, lastNode.textContent.length);\n        }\n        var checkParent = false;\n        if (this.oldRangeElement && this.oldRangeElement.nodeName !== '#text' && this.oldRangeElement.querySelectorAll('BR').length === 1) {\n          var brElement = this.oldRangeElement.querySelector('BR');\n          if (brElement) {\n            var brParentElement = brElement.parentNode;\n            var currentState = this.oldRangeElement.innerHTML;\n            this.parent.formatter.saveData(currentState);\n            detach(brElement);\n            if (brParentElement && brParentElement.childNodes.length === 0) {\n              detach(brParentElement);\n              checkParent = true;\n            }\n          }\n        }\n        if (!isNOU(this.rangeElement) && this.oldRangeElement !== this.rangeElement && !checkParent) {\n          while (this.rangeElement.firstChild) {\n            if (this.oldRangeElement.nodeName === '#text') {\n              this.oldRangeElement.parentElement.appendChild(this.rangeElement.childNodes[0]);\n            } else {\n              this.oldRangeElement.appendChild(this.rangeElement.childNodes[0]);\n            }\n          }\n          // eslint-disable-next-line\n          !isLiElement ? detach(this.rangeElement) : detach(this.rangeElement.parentElement);\n          this.oldRangeElement.normalize();\n        }\n      }\n    }\n  };\n  HtmlEditor.prototype.deleteCleanup = function (e, currentRange) {\n    var isLiElement = false;\n    var liElement;\n    var rootElement;\n    if (e.args.code === 'Delete' && e.args.keyCode === 46 && this.parent.contentModule.getText().trim().replace(/(\\r\\n|\\n|\\r|\\t)/gm, '').replace(/\\u200B/g, '').length !== 0 && this.parent.getSelection().length === 0 && currentRange.startContainer.parentElement.tagName !== 'TD' && currentRange.startContainer.parentElement.tagName !== 'TH') {\n      this.deleteRangeElement = rootElement = this.getRootBlockNode(currentRange.startContainer);\n      if (this.deleteRangeElement.tagName === 'OL' || this.deleteRangeElement.tagName === 'UL') {\n        liElement = this.getRangeLiNode(currentRange.startContainer);\n        if (liElement.nextElementSibling && liElement.nextElementSibling.childElementCount > 0 && !liElement.nextElementSibling.querySelector('BR')) {\n          if (!isNullOrUndefined(liElement.lastElementChild)) {\n            this.deleteRangeElement = liElement.lastElementChild;\n            isLiElement = true;\n          } else {\n            this.deleteRangeElement = liElement;\n          }\n        } else {\n          this.deleteRangeElement = this.getRangeElement(liElement);\n        }\n      } else if (this.deleteRangeElement.nodeType === 3 || this.deleteRangeElement.tagName === 'TABLE' || !isNullOrUndefined(this.deleteRangeElement.nextElementSibling) && this.deleteRangeElement.nextElementSibling.tagName === 'TABLE') {\n        return;\n      }\n      var isImgWithEmptyBlockNode = false;\n      if (this.deleteRangeElement.querySelectorAll('img').length > 0 && this.deleteRangeElement.textContent.trim() === '') {\n        isImgWithEmptyBlockNode = true;\n      }\n      if (this.getCaretIndex(currentRange, this.deleteRangeElement) === this.deleteRangeElement.textContent.length && !isImgWithEmptyBlockNode) {\n        if (!isNullOrUndefined(liElement)) {\n          if (isLiElement || !isNullOrUndefined(liElement.nextElementSibling)) {\n            this.deleteOldRangeElement = this.getRangeElement(liElement.nextElementSibling);\n          } else {\n            this.deleteOldRangeElement = rootElement.nextElementSibling;\n          }\n        } else {\n          this.deleteOldRangeElement = this.deleteRangeElement.nextElementSibling;\n        }\n        if (isNullOrUndefined(this.deleteOldRangeElement)) {\n          return;\n        } else {\n          if (currentRange.startOffset === 0 && currentRange.endOffset === 1 && this.deleteRangeElement.childNodes[0].nodeName === 'IMG') {\n            this.parent.formatter.editorManager.nodeSelection.setSelectionText(this.parent.contentModule.getDocument(), this.deleteRangeElement, this.deleteRangeElement, 0, 1);\n            this.isImageDelete = true;\n          } else {\n            this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(), this.deleteRangeElement, this.deleteRangeElement.childNodes.length);\n            this.isImageDelete = false;\n          }\n          var brNode = this.deleteRangeElement.querySelector('BR');\n          var brLastChildNode = this.deleteRangeElement.lastChild;\n          var brParentNode = brLastChildNode.parentNode;\n          if (brNode && brNode.classList.contains('e-rte-image-remove-focus')) {\n            removeClass([brNode], ['e-rte-image-focus']);\n            return;\n          } else if (brNode && brLastChildNode && brLastChildNode.nodeName === 'BR') {\n            detach(brLastChildNode);\n            if (!isNullOrUndefined(brParentNode) && brParentNode.childNodes.length === 0) {\n              detach(brParentNode);\n            }\n            e.args.preventDefault();\n          }\n          if (!isNullOrUndefined(this.deleteRangeElement) && this.deleteOldRangeElement.tagName !== 'OL' && this.deleteOldRangeElement.tagName !== 'UL' && this.deleteOldRangeElement !== this.deleteRangeElement) {\n            while (this.deleteOldRangeElement.firstChild) {\n              this.deleteRangeElement.appendChild(this.deleteOldRangeElement.childNodes[0]);\n            }\n            if (!isLiElement) {\n              detach(this.deleteOldRangeElement);\n            } else {\n              detach(this.deleteOldRangeElement.parentElement);\n            }\n            this.deleteRangeElement.normalize();\n          } else {\n            this.deleteRangeElement = null;\n            this.deleteOldRangeElement = null;\n          }\n        }\n      } else {\n        this.deleteRangeElement = null;\n      }\n    }\n  };\n  HtmlEditor.prototype.getCaretIndex = function (currentRange, element) {\n    var position = 0;\n    if (this.parent.contentModule.getDocument().getSelection().rangeCount !== 0) {\n      var preCaretRange = currentRange.cloneRange();\n      preCaretRange.selectNodeContents(element);\n      preCaretRange.setEnd(currentRange.endContainer, currentRange.endOffset);\n      position = preCaretRange.toString().length;\n    }\n    return position;\n  };\n  HtmlEditor.prototype.getRangeElement = function (element) {\n    var rangeElement = element.lastElementChild ? element.lastElementChild.tagName === 'BR' ? element.lastElementChild.previousElementSibling ? element.lastElementChild.previousElementSibling : element : element.lastElementChild : element;\n    return rangeElement;\n  };\n  HtmlEditor.prototype.getRootBlockNode = function (rangeBlockNode) {\n    // eslint-disable-next-line\n    for (; rangeBlockNode && this.parent && this.parent.inputElement !== rangeBlockNode; rangeBlockNode = rangeBlockNode) {\n      if (rangeBlockNode.parentElement === this.parent.inputElement) {\n        break;\n      } else {\n        rangeBlockNode = rangeBlockNode.parentElement;\n      }\n    }\n    return rangeBlockNode;\n  };\n  HtmlEditor.prototype.getRangeLiNode = function (rangeLiNode) {\n    var node = rangeLiNode.parentElement;\n    while (node !== this.parent.inputElement) {\n      if (node.nodeType === 1 && node.tagName === 'LI') {\n        break;\n      }\n      node = node.parentElement;\n    }\n    return node;\n  };\n  HtmlEditor.prototype.onPaste = function (e) {\n    // eslint-disable-next-line\n    var regex = new RegExp(/([^\\S]|^)(((https?\\:\\/\\/)|(www\\.))(\\S+))/gi);\n    if (e.text.match(regex)) {\n      if (e.isWordPaste) {\n        return;\n      }\n      e.args.preventDefault();\n      var range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n      // eslint-disable-next-line\n      var saveSelection = this.parent.formatter.editorManager.nodeSelection.save(range, this.parent.contentModule.getDocument());\n      // eslint-disable-next-line\n      var httpRegex = new RegExp(/([^\\S]|^)(((https?\\:\\/\\/)))/gi);\n      var wwwRegex = new RegExp(/([^\\S]|^)(((www\\.))(\\S+))/gi);\n      var enterSplitText = e.text.split('\\n');\n      var contentInnerElem = '';\n      for (var i = 0; i < enterSplitText.length; i++) {\n        if (enterSplitText[i].trim() === '') {\n          contentInnerElem += getDefaultValue(this.parent);\n        } else {\n          var contentWithSpace = '';\n          var spaceBetweenContent = true;\n          var spaceSplit = enterSplitText[i].split(' ');\n          for (var j = 0; j < spaceSplit.length; j++) {\n            if (spaceSplit[j].trim() === '') {\n              contentWithSpace += spaceBetweenContent ? '&nbsp;' : ' ';\n            } else {\n              spaceBetweenContent = false;\n              contentWithSpace += spaceSplit[j] + ' ';\n            }\n          }\n          if (i === 0) {\n            contentInnerElem += '<span>' + contentWithSpace.trim() + '</span>';\n          } else {\n            contentInnerElem += '<p>' + contentWithSpace.trim() + '</p>';\n          }\n        }\n      }\n      var divElement = this.parent.createElement('div');\n      divElement.setAttribute('class', 'pasteContent');\n      divElement.style.display = 'inline';\n      divElement.innerHTML = contentInnerElem.replace('&para', '&amp;para');\n      var paraElem = divElement.querySelectorAll('span, p');\n      for (var i = 0; i < paraElem.length; i++) {\n        var splitTextContent = paraElem[i].innerHTML.split(' ');\n        var resultSplitContent = '';\n        for (var j = 0; j < splitTextContent.length; j++) {\n          if (splitTextContent[j].match(httpRegex) || splitTextContent[j].match(wwwRegex)) {\n            resultSplitContent += '<a class=\"e-rte-anchor\" href=\"' + splitTextContent[j] + '\" title=\"' + splitTextContent[j] + '\" target=\"_blank\"' + ' aria-label=\"' + this.parent.serviceLocator.getService('rteLocale').getConstant('linkAriaLabel') + '\">' + splitTextContent[j] + ' </a>';\n          } else {\n            resultSplitContent += splitTextContent[j] + ' ';\n          }\n        }\n        paraElem[i].innerHTML = resultSplitContent.trim();\n      }\n      var anchorElement = divElement.childNodes[0];\n      if (!isNullOrUndefined(anchorElement) && !isNullOrUndefined(anchorElement.childNodes[0]) && anchorElement.nodeName === 'SPAN' && anchorElement.childNodes[0].nodeName === 'A') {\n        divElement.innerHTML = divElement.innerHTML.replace('<span>', '').replace('</span>', '');\n      }\n      if (!isNullOrUndefined(this.parent.pasteCleanupModule)) {\n        e.callBack(divElement.innerHTML);\n      } else {\n        this.parent.formatter.editorManager.execCommand('insertHTML', null, null, null, divElement);\n      }\n    }\n  };\n  HtmlEditor.prototype.spaceLink = function (e) {\n    var range = this.nodeSelectionObj.getRange(this.contentRenderer.getDocument());\n    var selectNodeEle = this.nodeSelectionObj.getParentNodeCollection(range);\n    var text = range.startContainer.textContent.substr(0, range.endOffset);\n    var splitText = text.split(' ');\n    var urlText = splitText[splitText.length - 1];\n    var urlTextRange = range.startOffset - (text.length - splitText[splitText.length - 1].length);\n    urlText = urlText.slice(0, urlTextRange);\n    // eslint-disable-next-line\n    var regex = new RegExp(/([^\\S]|^)(((https?\\:\\/\\/)|(www\\.))(\\S+))/gi);\n    if (selectNodeEle[0] && selectNodeEle[0].nodeName !== 'A' && urlText.match(regex)) {\n      var selection = this.nodeSelectionObj.save(range, this.parent.contentModule.getDocument());\n      var url = urlText.indexOf('http') > -1 ? urlText : 'http://' + urlText;\n      var selectParent = this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(range);\n      var value = {\n        url: url,\n        selection: selection,\n        selectParent: selectParent,\n        text: urlText,\n        title: '',\n        target: '_blank'\n      };\n      this.parent.formatter.process(this.parent, {\n        item: {\n          'command': 'Links',\n          'subCommand': 'CreateLink'\n        }\n      }, e, value);\n    }\n  };\n  HtmlEditor.prototype.onToolbarClick = function (args) {\n    var _this = this;\n    var save;\n    var selectNodeEle;\n    var selectParentEle;\n    var item = args.item;\n    var closestElement = closest(args.originalEvent.target, '.e-rte-quick-popup');\n    var target = args.originalEvent.target;\n    this.parent.notify(events.closeTooltip, {\n      target: target\n    });\n    if (item.command !== 'FormatPainter') {\n      if (closestElement && !closestElement.classList.contains('e-rte-inline-popup') && !closestElement.classList.contains('e-rte-text-popup')) {\n        if (!(item.subCommand === 'SourceCode' || item.subCommand === 'Preview' || item.subCommand === 'FontColor' || item.subCommand === 'BackgroundColor')) {\n          if (isIDevice() && item.command === 'Images') {\n            this.nodeSelectionObj.restore();\n          }\n          var range = this.nodeSelectionObj.getRange(this.parent.contentModule.getDocument());\n          save = this.nodeSelectionObj.save(range, this.parent.contentModule.getDocument());\n          selectNodeEle = this.nodeSelectionObj.getNodeCollection(range);\n          selectParentEle = this.nodeSelectionObj.getParentNodeCollection(range);\n        }\n        if (item.command === 'Images') {\n          this.parent.notify(events.imageToolbarAction, {\n            member: 'image',\n            args: args,\n            selectNode: selectNodeEle,\n            selection: save,\n            selectParent: selectParentEle\n          });\n        }\n        if (item.command === 'Audios') {\n          this.parent.notify(events.audioToolbarAction, {\n            member: 'audio',\n            args: args,\n            selectNode: selectNodeEle,\n            selection: save,\n            selectParent: selectParentEle\n          });\n        }\n        if (item.command === 'Videos') {\n          this.parent.notify(events.videoToolbarAction, {\n            member: 'video',\n            args: args,\n            selectNode: selectNodeEle,\n            selection: save,\n            selectParent: selectParentEle\n          });\n        }\n        if (item.command === 'Links') {\n          this.parent.notify(events.linkToolbarAction, {\n            member: 'link',\n            args: args,\n            selectNode: selectNodeEle,\n            selection: save,\n            selectParent: selectParentEle\n          });\n        }\n        if (item.command === 'Table') {\n          this.parent.notify(events.tableToolbarAction, {\n            member: 'table',\n            args: args,\n            selectNode: selectNodeEle,\n            selection: save,\n            selectParent: selectParentEle\n          });\n        }\n      } else {\n        var linkDialog = document.getElementById(this.parent.getID() + '_rtelink');\n        var imageDialog = document.getElementById(this.parent.getID() + '_image');\n        if (!(item.subCommand === 'SourceCode' || item.subCommand === 'Preview' || item.subCommand === 'FontColor' || item.subCommand === 'BackgroundColor' || item.subCommand === 'NumberFormatList' || item.subCommand === 'BulletFormatList')) {\n          var range = this.nodeSelectionObj.getRange(this.parent.contentModule.getDocument());\n          if (isNullOrUndefined(linkDialog) && isNullOrUndefined(imageDialog)) {\n            save = this.nodeSelectionObj.save(range, this.parent.contentModule.getDocument());\n          }\n          selectNodeEle = this.nodeSelectionObj.getNodeCollection(range);\n          selectParentEle = this.nodeSelectionObj.getParentNodeCollection(range);\n        }\n        switch (item.subCommand) {\n          case 'Maximize':\n            this.parent.notify(events.enableFullScreen, {\n              args: args\n            });\n            break;\n          case 'Minimize':\n            this.parent.notify(events.disableFullScreen, {\n              args: args\n            });\n            break;\n          case 'CreateLink':\n            this.parent.notify(events.insertLink, {\n              member: 'link',\n              args: args,\n              selectNode: selectNodeEle,\n              selection: save,\n              selectParent: selectParentEle\n            });\n            break;\n          case 'RemoveLink':\n            this.parent.notify(events.unLink, {\n              member: 'link',\n              args: args,\n              selectNode: selectNodeEle,\n              selection: save,\n              selectParent: selectParentEle\n            });\n            break;\n          case 'Print':\n            this.parent.print();\n            break;\n          case 'Image':\n            this.parent.notify(events.insertImage, {\n              member: 'image',\n              args: args,\n              selectNode: selectNodeEle,\n              selection: save,\n              selectParent: selectParentEle\n            });\n            break;\n          case 'Audio':\n            this.parent.notify(events.insertAudio, {\n              member: 'audio',\n              args: args,\n              selectNode: selectNodeEle,\n              selection: save,\n              selectParent: selectParentEle\n            });\n            break;\n          case 'Video':\n            this.parent.notify(events.insertVideo, {\n              member: 'video',\n              args: args,\n              selectNode: selectNodeEle,\n              selection: save,\n              selectParent: selectParentEle\n            });\n            break;\n          case 'CreateTable':\n            this.parent.notify(events.createTable, {\n              member: 'table',\n              args: args,\n              selection: save\n            });\n            break;\n          case 'SourceCode':\n            this.parent.notify(events.sourceCode, {\n              member: 'viewSource',\n              args: args\n            });\n            break;\n          case 'Preview':\n            this.parent.notify(events.updateSource, {\n              member: 'updateSource',\n              args: args\n            });\n            break;\n          case 'FontColor':\n          case 'BackgroundColor':\n            break;\n          case 'File':\n            this.parent.notify(events.renderFileManager, {\n              member: 'fileManager',\n              args: args,\n              selectNode: selectNodeEle,\n              selection: save,\n              selectParent: selectParentEle\n            });\n            break;\n          case 'EmojiPicker':\n            this.parent.notify(events.emojiPicker, {\n              member: 'emojiPicker',\n              args: args\n            });\n            break;\n          case 'ImportWord':\n            this.parent.notify(events.onImport, {});\n            break;\n          case 'ExportWord':\n            this.parent.notify(events.onExport, {\n              member: 'ExportWord',\n              args: args\n            });\n            break;\n          case 'ExportPdf':\n            this.parent.notify(events.onExport, {\n              member: 'ExportPdf',\n              args: args\n            });\n            break;\n          default:\n            this.parent.formatter.process(this.parent, args, args.originalEvent, null);\n            break;\n        }\n      }\n    } else {\n      if (args.originalEvent.detail === 1) {\n        clearTimeout(this.clickTimeout);\n        this.clickTimeout = setTimeout(function () {\n          _this.parent.notify(events.formatPainterClick, {\n            member: 'formatPainter',\n            args: args\n          });\n        }, 200);\n      } else {\n        clearTimeout(this.clickTimeout);\n        this.parent.notify(events.formatPainterDoubleClick, {\n          member: 'formatPainter',\n          args: args\n        });\n      }\n    }\n  };\n  HtmlEditor.prototype.instantiateRenderer = function () {\n    if (this.parent.iframeSettings.enable) {\n      this.renderFactory.addRenderer(RenderType.Content, new IframeContentRender(this.parent));\n    } else {\n      this.renderFactory.addRenderer(RenderType.Content, new ContentRender(this.parent));\n    }\n  };\n  HtmlEditor.prototype.removeEventListener = function () {\n    this.parent.off(events.initialEnd, this.render);\n    this.parent.off(events.modelChanged, this.onPropertyChanged);\n    this.parent.off(events.htmlToolbarClick, this.onToolbarClick);\n    this.parent.off(events.destroy, this.destroy);\n    this.parent.off(events.keyDown, this.onKeyDown);\n    this.parent.off(events.initialLoad, this.instantiateRenderer);\n    this.parent.off(events.selectAll, this.selectAll);\n    this.parent.off(events.selectRange, this.selectRange);\n    this.parent.off(events.getSelectedHtml, this.getSelectedHtml);\n    this.parent.off(events.selectionSave, this.onSelectionSave);\n    this.parent.off(events.selectionRestore, this.onSelectionRestore);\n    this.parent.off(events.readOnlyMode, this.updateReadOnly);\n    this.parent.off(events.paste, this.onPaste);\n    this.parent.off(events.tableclass, this.isTableClassAdded);\n  };\n  HtmlEditor.prototype.render = function () {\n    this.contentRenderer = this.renderFactory.getRenderer(RenderType.Content);\n    var editElement = this.contentRenderer.getEditPanel();\n    var option = {\n      undoRedoSteps: this.parent.undoRedoSteps,\n      undoRedoTimer: this.parent.undoRedoTimer\n    };\n    if (isNullOrUndefined(this.parent.formatter)) {\n      var formatterClass = new HTMLFormatter({\n        currentDocument: this.contentRenderer.getDocument(),\n        element: editElement,\n        options: option,\n        formatPainterSettings: this.parent.formatPainterSettings\n      });\n      this.parent.setProperties({\n        formatter: formatterClass\n      }, true);\n    } else {\n      this.parent.formatter.updateFormatter(editElement, this.contentRenderer.getDocument(), option);\n    }\n    if (this.parent.enableXhtml) {\n      this.parent.notify(events.xhtmlValidation, {});\n    }\n    if (this.parent.toolbarSettings.enable) {\n      this.toolbarUpdate = new HtmlToolbarStatus(this.parent);\n    }\n    if (this.parent.inlineMode.enable) {\n      if (!isNullOrUndefined(this.parent.fontFamily.default)) {\n        editElement.style.fontFamily = this.parent.fontFamily.default;\n      }\n      if (!isNullOrUndefined(this.parent.fontSize.default)) {\n        editElement.style.fontSize = this.parent.fontSize.default;\n      }\n    }\n    this.parent.notify(events.bindOnEnd, {});\n  };\n  /**\n   * Called internally if any of the property value changed.\n   *\n   * @param {RichTextEditorModel} e - specifies the editor model\n   * @returns {void}\n   * @hidden\n    */\n  HtmlEditor.prototype.onPropertyChanged = function (e) {\n    // On property code change here\n    if (!isNOU(e) && !isNOU(e.newProp.toolbarSettings) && !isNOU(e.newProp.toolbarSettings.enable)) {\n      this.toolbarUpdate = new HtmlToolbarStatus(this.parent);\n    }\n    if (!isNullOrUndefined(e.newProp.formatter)) {\n      var editElement = this.contentRenderer.getEditPanel();\n      var option = {\n        undoRedoSteps: this.parent.undoRedoSteps,\n        undoRedoTimer: this.parent.undoRedoTimer\n      };\n      this.parent.formatter.updateFormatter(editElement, this.contentRenderer.getDocument(), option);\n    }\n  };\n  /**\n   * For internal use only - Get the module name.\n   *\n   * @returns {string} - returns the string value\n   * @hidden\n   */\n  HtmlEditor.prototype.getModuleName = function () {\n    return 'htmlEditor';\n  };\n  /**\n   * For selecting all content in RTE\n   *\n   * @returns {void}\n   * @private\n   * @hidden\n   */\n  HtmlEditor.prototype.selectAll = function () {\n    var nodes = getTextNodesUnder(this.parent.contentModule.getDocument(), this.parent.contentModule.getEditPanel());\n    if (nodes.length > 0) {\n      this.parent.formatter.editorManager.nodeSelection.setSelectionText(this.parent.contentModule.getDocument(), nodes[0], nodes[nodes.length - 1], 0, nodes[nodes.length - 1].textContent.length);\n    }\n  };\n  /**\n   * For selecting all content in RTE\n   *\n   * @param {NotifyArgs} e - specifies the notified arguments\n   * @returns {void}\n   * @private\n   * @hidden\n   */\n  HtmlEditor.prototype.selectRange = function (e) {\n    this.parent.formatter.editorManager.nodeSelection.setRange(this.parent.contentModule.getDocument(), e.range);\n  };\n  /**\n   * For get a selected text in RTE\n   *\n   * @param {NotifyArgs} e - specifies the notified arguments\n   * @returns {void}\n   * @hidden\n   */\n  HtmlEditor.prototype.getSelectedHtml = function (e) {\n    e.callBack(this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()).toString());\n  };\n  HtmlEditor.prototype.tableSelectionKeyAction = function (e) {\n    var args = e.args;\n    // Handle the space, enter and backspace keys when the table cells are selected.\n    var tableCellSelectNodes = this.parent.inputElement.querySelectorAll('.e-cell-select');\n    for (var i = 0; i < tableCellSelectNodes.length; i++) {\n      var currentCell = tableCellSelectNodes[i];\n      removeClassWithAttr([currentCell], [classes.CLS_TABLE_SEL, classes.CLS_TABLE_MULTI_CELL, classes.CLS_TABLE_SEL_END]);\n      if (i === 0) {\n        if (args.keyCode === 32) {\n          currentCell.innerHTML = '&#8203;<br>';\n        } else {\n          currentCell.innerHTML = '<br>';\n        }\n        this.nodeSelectionObj.setCursorPoint(this.parent.contentModule.getDocument(), currentCell.firstChild, 0);\n      } else {\n        currentCell.innerHTML = '<br>';\n      }\n    }\n  };\n  HtmlEditor.prototype.marginTabAdd = function (val, alignmentNodes) {\n    for (var index = 0; index < alignmentNodes.length; index++) {\n      var element = alignmentNodes[index];\n      if (element.closest('li')) {\n        continue;\n      }\n      if (element.style.marginLeft) {\n        var count = parseInt(element.style.marginLeft, 10);\n        if (val) {\n          count -= 20;\n        } else {\n          count += 20;\n        }\n        element.style.marginLeft = count.toString() + 'px';\n        if (element.style.marginLeft === '0px') {\n          element.removeAttribute('style');\n        }\n      } else if (!val) {\n        element.style.marginLeft = '20px';\n      }\n    }\n  };\n  return HtmlEditor;\n}();\nexport { HtmlEditor };","map":{"version":3,"names":["events","isNullOrUndefined","closest","attributes","removeClass","addClass","Browser","detach","isNOU","HTMLFormatter","RenderType","classes","HtmlToolbarStatus","IframeContentRender","ContentRender","NodeSelection","InsertHtml","getTextNodesUnder","sanitizeHelper","getDefaultValue","isIDevice","removeClassWithAttr","scrollToCursor","XhtmlValidation","ON_BEGIN","CONSTANT","HtmlEditor","parent","serviceLocator","rangeCollection","isImageDelete","locator","renderFactory","getService","xhtmlValidation","addEventListener","isDestroyed","isCopyAll","prototype","destroy","clickTimeout","clearTimeout","removeEventListener","contentRenderer","toolbarUpdate","nodeSelectionObj","length","rangeElement","oldRangeElement","deleteRangeElement","deleteOldRangeElement","saveSelection","value","inputElement","on","initialLoad","instantiateRenderer","htmlToolbarClick","onToolbarClick","keyDown","onKeyDown","keyUp","onKeyUp","initialEnd","render","modelChanged","onPropertyChanged","selectAll","selectRange","getSelectedHtml","selectionSave","onSelectionSave","selectionRestore","onSelectionRestore","readOnlyMode","updateReadOnly","paste","onPaste","tableclass","isTableClassAdded","onHandleFontsizeChange","readonly","contentModule","getEditPanel","contenteditable","element","CLS_RTE_READONLY","currentDocument","getDocument","range","getRange","save","e","isBlur","items","restore","tableElement","querySelectorAll","i","classList","contains","add","keyboardArgs","args","name","item","command","subCommand","fontSize","activeElem","toolbarModule","dropDownModule","fontSizeDropDown","textContent","fontSizeValue","selection","getSelection","focusNode","parentElement","document","defaultView","getComputedStyle","getPropertyValue","width","actualTxtFontValues","match","size_1","parseInt","unit","defaultFontValues","index","findIndex","_a","text","convertedSize_1","convertFontSize","fontIndex","size","action","fontValues","roundedSize","Math","ceil","toLocaleString","push","formatter","process","originalUnit","targetUnit","supportedUnits","indexOf","convertedValue","conversionFactors","restrictKeys","regEx","RegExp","isEmptyNode","startContainer","endContainer","startOffset","endOffset","charCodeAt","replace","isMention","mentionStartNode","nodeType","childNodes","keyCode","previousSibling","contentEditable","pointer","isRootParent","shiftKey","ctrlKey","altKey","nodeName","previousLength_1","previousRange","editorManager","nodeSelection","setCursorPoint","previousLength","innerHTML","currentLength","trim","tempSpan","createElement","className","insertNode","currentChild","firstChild","nextElementSibling","includes","tempSpanToRemove","querySelector","parentNode","removeChild","currentChildNode","currentElem","remove","getAttribute","removeAttribute","_this","currentRange","tableSelectionKeyAction","autoResize","info","backSpaceCleanup","deleteCleanup","enableTabKey","saveData","target","getParentNodeCollection","preventDefault","getRangeAt","alignmentNodes","domNode","blockNodes","enterKey","setMarker","convertToBlockNodes","marginTabAdd","saveMarker","Insert","textCont","setSelectionText","createTextNode","pop","spaceLink","editorMode","getText","selectionLength","totalLength","maxLength","notify","enterHandler","currentRange_1","editorValue","slice","orderedList_1","isOrderedList","unOrderedList","isUnOrderedList","hasSplitedText","hasMultipleTextNode","eventArgs_1","callBack","event","actionBeginArgs","cancel","originalEvent","requestType","trigger","actionBegin","observer","actionComplete","elements","tagName","olListStartRegex","test","ulListStartRegex","previousElementSibling","isContentEditable","textNodes","node","Node","TEXT_NODE","isLiElement","isPreviousNotContentEditable","checkNode","isSelectedPositionNotStart","code","isBlockNode","getRootBlockNode","liElement","getRangeLiNode","childElementCount","lastElementChild","lastChild","findBlockElement","collapsed","style","marginLeft","lastNode","checkParent","brElement","brParentElement","currentState","appendChild","normalize","rootElement","getRangeElement","isImgWithEmptyBlockNode","getCaretIndex","brNode","brLastChildNode","brParentNode","position","rangeCount","preCaretRange","cloneRange","selectNodeContents","setEnd","toString","rangeBlockNode","rangeLiNode","regex","isWordPaste","httpRegex","wwwRegex","enterSplitText","split","contentInnerElem","contentWithSpace","spaceBetweenContent","spaceSplit","j","divElement","setAttribute","display","paraElem","splitTextContent","resultSplitContent","getConstant","anchorElement","pasteCleanupModule","execCommand","selectNodeEle","substr","splitText","urlText","urlTextRange","url","selectParent","title","selectParentEle","closestElement","closeTooltip","getNodeCollection","imageToolbarAction","member","selectNode","audioToolbarAction","videoToolbarAction","linkToolbarAction","tableToolbarAction","linkDialog","getElementById","getID","imageDialog","enableFullScreen","disableFullScreen","insertLink","unLink","print","insertImage","insertAudio","insertVideo","createTable","sourceCode","updateSource","renderFileManager","emojiPicker","onImport","onExport","detail","setTimeout","formatPainterClick","formatPainterDoubleClick","iframeSettings","enable","addRenderer","Content","off","getRenderer","editElement","option","undoRedoSteps","undoRedoTimer","formatterClass","options","formatPainterSettings","setProperties","updateFormatter","enableXhtml","toolbarSettings","inlineMode","fontFamily","default","bindOnEnd","newProp","getModuleName","nodes","setRange","tableCellSelectNodes","currentCell","CLS_TABLE_SEL","CLS_TABLE_MULTI_CELL","CLS_TABLE_SEL_END","val","count"],"sources":["/var/www/vue/vue-gantt-chart/node_modules/@syncfusion/ej2-richtexteditor/src/rich-text-editor/actions/html-editor.js"],"sourcesContent":["import * as events from '../base/constant';\nimport { isNullOrUndefined, closest, attributes, removeClass, addClass, Browser, detach } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined as isNOU } from '@syncfusion/ej2-base';\nimport { HTMLFormatter } from '../formatter/html-formatter';\nimport { RenderType } from '../base/enum';\nimport * as classes from '../base/classes';\nimport { HtmlToolbarStatus } from './html-toolbar-status';\nimport { IframeContentRender } from '../renderer/iframe-content-renderer';\nimport { ContentRender } from '../renderer/content-renderer';\nimport { NodeSelection } from '../../selection/selection';\nimport { InsertHtml } from '../../editor-manager/plugin/inserthtml';\nimport { getTextNodesUnder, sanitizeHelper, getDefaultValue } from '../base/util';\nimport { isIDevice, removeClassWithAttr, scrollToCursor } from '../../common/util';\nimport { XhtmlValidation } from './xhtml-validation';\nimport { ON_BEGIN } from './../../common/constant';\nimport * as CONSTANT from '../base/constant';\n/**\n * `HtmlEditor` module is used to HTML editor\n */\nvar HtmlEditor = /** @class */ (function () {\n    function HtmlEditor(parent, serviceLocator) {\n        this.rangeCollection = [];\n        this.isImageDelete = false;\n        this.parent = parent;\n        this.locator = serviceLocator;\n        this.renderFactory = this.locator.getService('rendererFactory');\n        this.xhtmlValidation = new XhtmlValidation(parent);\n        this.addEventListener();\n        this.isDestroyed = false;\n        this.isCopyAll = false;\n    }\n    /**\n     * Destroys the Markdown.\n     *\n     * @function destroy\n     * @returns {void}\n     * @hidden\n\n     */\n    HtmlEditor.prototype.destroy = function () {\n        if (this.isDestroyed) {\n            return;\n        }\n        if (this.clickTimeout) {\n            clearTimeout(this.clickTimeout);\n            this.clickTimeout = null;\n        }\n        this.removeEventListener();\n        this.locator = null;\n        this.contentRenderer = null;\n        this.renderFactory = null;\n        this.toolbarUpdate = null;\n        this.nodeSelectionObj = null;\n        this.isCopyAll = null;\n        if (this.rangeCollection.length > 0) {\n            this.rangeCollection = [];\n        }\n        if (this.rangeElement) {\n            this.rangeElement = null;\n        }\n        if (this.oldRangeElement) {\n            this.oldRangeElement = null;\n        }\n        if (this.deleteRangeElement) {\n            this.deleteRangeElement = null;\n        }\n        if (this.deleteOldRangeElement) {\n            this.deleteOldRangeElement = null;\n        }\n        if (this.saveSelection) {\n            this.saveSelection = null;\n        }\n        if (this.xhtmlValidation) {\n            this.xhtmlValidation = null;\n        }\n        this.isDestroyed = true;\n    };\n    /**\n     * @param {string} value - specifies the string value\n     * @returns {void}\n     * @hidden\n\n     */\n    HtmlEditor.prototype.sanitizeHelper = function (value) {\n        value = sanitizeHelper(value, this.parent);\n        return value;\n    };\n    HtmlEditor.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.nodeSelectionObj = new NodeSelection(this.parent.inputElement);\n        this.parent.on(events.initialLoad, this.instantiateRenderer, this);\n        this.parent.on(events.htmlToolbarClick, this.onToolbarClick, this);\n        this.parent.on(events.keyDown, this.onKeyDown, this);\n        this.parent.on(events.keyUp, this.onKeyUp, this);\n        this.parent.on(events.initialEnd, this.render, this);\n        this.parent.on(events.modelChanged, this.onPropertyChanged, this);\n        this.parent.on(events.destroy, this.destroy, this);\n        this.parent.on(events.selectAll, this.selectAll, this);\n        this.parent.on(events.selectRange, this.selectRange, this);\n        this.parent.on(events.getSelectedHtml, this.getSelectedHtml, this);\n        this.parent.on(events.selectionSave, this.onSelectionSave, this);\n        this.parent.on(events.selectionRestore, this.onSelectionRestore, this);\n        this.parent.on(events.readOnlyMode, this.updateReadOnly, this);\n        this.parent.on(events.paste, this.onPaste, this);\n        this.parent.on(events.tableclass, this.isTableClassAdded, this);\n        this.parent.on(events.onHandleFontsizeChange, this.onHandleFontsizeChange, this);\n    };\n    HtmlEditor.prototype.updateReadOnly = function () {\n        if (this.parent.readonly) {\n            attributes(this.parent.contentModule.getEditPanel(), { contenteditable: 'false' });\n            addClass([this.parent.element], classes.CLS_RTE_READONLY);\n        }\n        else {\n            attributes(this.parent.contentModule.getEditPanel(), { contenteditable: 'true' });\n            removeClass([this.parent.element], classes.CLS_RTE_READONLY);\n        }\n    };\n    HtmlEditor.prototype.onSelectionSave = function () {\n        var currentDocument = this.contentRenderer.getDocument();\n        var range = this.nodeSelectionObj.getRange(currentDocument);\n        this.saveSelection = this.nodeSelectionObj.save(range, currentDocument);\n    };\n    HtmlEditor.prototype.onSelectionRestore = function (e) {\n        this.parent.isBlur = false;\n        if (isNullOrUndefined(e.items) || e.items) {\n            this.saveSelection.restore();\n        }\n    };\n    HtmlEditor.prototype.isTableClassAdded = function () {\n        var tableElement = this.parent.inputElement.querySelectorAll('table');\n        for (var i = 0; i < tableElement.length; i++) {\n            // e-rte-table class is added to the table element for styling.\n            // e-rte-paste-table class is added for pasted table element from MS Word and other sources such as Web will not have any styles.\n            // e-rte-custom-table class is added for custom table element will not have any styles.\n            if (!tableElement[i].classList.contains('e-rte-table') && !tableElement[i].classList.contains('e-rte-paste-table')\n                && !tableElement[i].classList.contains('e-rte-custom-table')) {\n                tableElement[i].classList.add('e-rte-table');\n            }\n        }\n    };\n    HtmlEditor.prototype.onHandleFontsizeChange = function (e) {\n        var keyboardArgs = e.args;\n        var args = { name: 'dropDownSelect' };\n        args.item = {\n            command: 'Font',\n            subCommand: 'FontSize'\n        };\n        var items = this.parent.fontSize.items;\n        var activeElem;\n        if (this.parent.toolbarModule && this.parent.toolbarModule.dropDownModule &&\n            this.parent.toolbarModule.dropDownModule.fontSizeDropDown && !isNOU(this.parent.toolbarModule.dropDownModule.fontSizeDropDown.activeElem[0].textContent) && this.parent.toolbarModule.dropDownModule.fontSizeDropDown.activeElem[0].textContent !== '') {\n            activeElem = this.parent.toolbarModule.dropDownModule.fontSizeDropDown.activeElem[0].textContent;\n        }\n        else {\n            var fontSizeValue = void 0;\n            var selection = this.parent.contentModule.getDocument().getSelection();\n            if (selection && selection.focusNode && selection.focusNode.parentElement) {\n                fontSizeValue = document.defaultView.getComputedStyle(selection.focusNode.parentElement, null).getPropertyValue('font-size');\n            }\n            else {\n                fontSizeValue = this.parent.fontSize.width;\n            }\n            fontSizeValue = isNOU(fontSizeValue) ? this.parent.fontSize.width : fontSizeValue;\n            var actualTxtFontValues = fontSizeValue.match(/^([\\d.]+)(\\D+)$/);\n            var size_1 = parseInt(actualTxtFontValues[1], 10);\n            var unit = actualTxtFontValues[2];\n            var defaultFontValues = items[1].value.match(/^([\\d.]+)(\\D+)$/);\n            if (defaultFontValues[2] === unit) {\n                var index = items.findIndex(function (_a) {\n                    var value = _a.value;\n                    return parseInt(value, 10) >= size_1;\n                });\n                activeElem = items[index].text;\n            }\n            else {\n                var convertedSize_1 = this.convertFontSize(size_1, unit, defaultFontValues[2]);\n                var index = items.findIndex(function (_a) {\n                    var value = _a.value;\n                    return parseInt(value, 10) >= convertedSize_1;\n                });\n                activeElem = items[index].text;\n            }\n        }\n        var fontIndex = items.findIndex(function (size) { return size.text === (activeElem === 'Font Size' ? 'Default' : activeElem); });\n        if (keyboardArgs.action === 'increase-fontsize' && fontIndex !== -1) {\n            if (fontIndex >= items.length - 1) {\n                var fontValues = items[fontIndex].value.match(/^([\\d.]+)(\\D+)$/);\n                if (fontValues) {\n                    var size = parseInt(fontValues[1], 10);\n                    var unit = fontValues[2];\n                    var roundedSize = size % 10 === 0 ? Math.ceil((size + 1) / 10) * 10 : Math.ceil(size / 10) * 10;\n                    args.item.value = roundedSize.toLocaleString() + unit;\n                    args.item.text = roundedSize.toLocaleString() + ' ' + unit;\n                }\n                this.parent.fontSize.items.push(args.item);\n            }\n            else {\n                args.item.value = items[fontIndex + 1].value;\n                args.item.text = items[fontIndex + 1].text;\n            }\n        }\n        else if (keyboardArgs.action === 'decrease-fontsize' && fontIndex !== -1 && fontIndex > 0) {\n            args.item.value = items[fontIndex - 1].value;\n            args.item.text = items[fontIndex - 1].text;\n        }\n        else {\n            if (fontIndex >= 0 && fontIndex < items.length && items[fontIndex]) {\n                args.item.value = items[fontIndex].value;\n                args.item.text = items[fontIndex].text;\n            }\n        }\n        this.parent.formatter.process(this.parent, args, keyboardArgs);\n    };\n    HtmlEditor.prototype.convertFontSize = function (value, originalUnit, targetUnit) {\n        if (CONSTANT.supportedUnits.indexOf(originalUnit) !== -1 || CONSTANT.supportedUnits.indexOf(targetUnit) !== -1) {\n            originalUnit = 'px';\n        }\n        var convertedValue = value * CONSTANT.conversionFactors[originalUnit][targetUnit];\n        return convertedValue;\n    };\n    HtmlEditor.prototype.onKeyUp = function (e) {\n        var args = e.args;\n        var restrictKeys = [8, 9, 13, 17, 18, 20, 27, 37, 38, 39, 40, 44, 45, 46, 91,\n            112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123];\n        var range = this.parent.getRange();\n        var regEx = new RegExp('\\u200B', 'g');\n        var isEmptyNode = range.startContainer === range.endContainer && range.startOffset === range.endOffset &&\n            range.startOffset === 1 && range.startContainer.textContent.length === 1 &&\n            range.startContainer.textContent.charCodeAt(0) === 8203 &&\n            range.startContainer.textContent.replace(regEx, '').length === 0;\n        var isMention = false;\n        if (range.startContainer === range.endContainer &&\n            range.startOffset === range.endOffset && (range.startContainer !== this.parent.inputElement && range.startOffset !== 0)) {\n            var mentionStartNode = range.startContainer.nodeType === 3 ?\n                range.startContainer : range.startContainer.childNodes[range.startOffset - 1];\n            isMention = args.keyCode === 16 &&\n                mentionStartNode.textContent.charCodeAt(0) === 8203 &&\n                !isNOU(mentionStartNode.previousSibling) && mentionStartNode.previousSibling.contentEditable === 'false';\n        }\n        if (this.isCopyAll) {\n            return;\n        }\n        var pointer;\n        var isRootParent = false;\n        if (restrictKeys.indexOf(args.keyCode) < 0 && !args.shiftKey && !args.ctrlKey && !args.altKey && !isEmptyNode && !isMention) {\n            pointer = range.startOffset;\n            // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n            range.startContainer.nodeName === '#text' ? range.startContainer.parentElement !== this.parent.inputElement ? range.startContainer.parentElement.classList.add('currentStartMark')\n                : isRootParent = true : range.startContainer.classList.add('currentStartMark');\n            if (range.startContainer.textContent.charCodeAt(0) === 8203) {\n                var previousLength_1 = range.startContainer.textContent.length;\n                var previousRange = range.startOffset;\n                range.startContainer.textContent = range.startContainer.textContent.replace(regEx, '');\n                pointer = previousRange === 0 ? previousRange : previousRange - (previousLength_1 - range.startContainer.textContent.length);\n                this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(), range.startContainer, pointer);\n            }\n            var previousLength = this.parent.inputElement.innerHTML.length;\n            var currentLength = this.parent.inputElement.innerHTML.replace(regEx, '').length;\n            var focusNode = range.startContainer;\n            if (previousLength > currentLength && !isRootParent) {\n                if (focusNode.textContent.trim().length !== 0 && focusNode.previousSibling) {\n                    var tempSpan = document.createElement('span');\n                    tempSpan.className = 'tempSpan';\n                    range.insertNode(tempSpan);\n                }\n                var currentChild = this.parent.inputElement.firstChild;\n                while (!isNOU(currentChild)) {\n                    if (currentChild.nodeName === '#text') {\n                        currentChild = currentChild.nextElementSibling;\n                        continue;\n                    }\n                    if (currentChild.textContent.replace(regEx, '').trim().length > 0 && currentChild.textContent.includes('\\u200B')) {\n                        currentChild.innerHTML = currentChild.innerHTML.replace(regEx, '');\n                    }\n                    currentChild = currentChild.nextElementSibling;\n                }\n                var tempSpanToRemove = this.parent.inputElement.querySelector('.tempSpan');\n                if (tempSpanToRemove && tempSpanToRemove.previousSibling && focusNode.textContent.trim().length !== 0) {\n                    focusNode = tempSpanToRemove.previousSibling;\n                    pointer = tempSpanToRemove.previousSibling.textContent.length;\n                    var parentElement = tempSpanToRemove.parentNode;\n                    parentElement.removeChild(tempSpanToRemove);\n                    tempSpanToRemove = null;\n                }\n                var currentChildNode = this.parent.inputElement.querySelector('.currentStartMark').childNodes;\n                if (currentChildNode.length > 1) {\n                    for (var i = 0; i < currentChildNode.length; i++) {\n                        if (currentChildNode[i].nodeName === '#text' && currentChildNode[i].textContent.length === 0) {\n                            detach(currentChildNode[i]);\n                            i--;\n                        }\n                        if (!isNOU(currentChildNode[i]) && focusNode.textContent.replace(regEx, '') === currentChildNode[i].textContent) {\n                            pointer = focusNode.textContent.length > 1 ?\n                                (focusNode.textContent === currentChildNode[i].textContent ? pointer :\n                                    pointer - (focusNode.textContent.length - focusNode.textContent.replace(regEx, '').length)) :\n                                focusNode.textContent.length;\n                            focusNode = currentChildNode[i];\n                        }\n                    }\n                }\n                else if (currentChildNode.length === 1) {\n                    if (focusNode.textContent.replace(regEx, '') === currentChildNode[0].textContent) {\n                        focusNode = currentChildNode[0];\n                    }\n                }\n                this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(), focusNode, pointer);\n            }\n            var currentElem = this.parent.inputElement.querySelector('.currentStartMark');\n            if (!isNOU(currentElem)) {\n                currentElem.classList.remove('currentStartMark');\n                if (currentElem.getAttribute('class').trim() === '') {\n                    currentElem.removeAttribute('class');\n                }\n            }\n            if (!isNOU(range.startContainer.previousSibling) && !isNOU(range.startContainer.previousSibling.parentElement) &&\n                range.startContainer.parentElement === range.startContainer.previousSibling.parentElement &&\n                range.startContainer.previousSibling.textContent.charCodeAt(0) === 8203 &&\n                range.startContainer.previousSibling.textContent.length <= 1) {\n                range.startContainer.previousSibling.textContent = range.startContainer.previousSibling.textContent.replace(regEx, '');\n            }\n            if (range.endContainer.textContent.charCodeAt(range.endOffset) === 8203) {\n                pointer = range.startOffset;\n                range.endContainer.textContent = range.endContainer.textContent.replace(regEx, '');\n                this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(), range.startContainer, pointer);\n            }\n        }\n    };\n    HtmlEditor.prototype.onKeyDown = function (e) {\n        var _this = this;\n        if (e.args.ctrlKey && e.args.keyCode === 65) {\n            this.isCopyAll = true;\n        }\n        else {\n            this.isCopyAll = false;\n        }\n        var currentRange;\n        var args = e.args;\n        if (this.parent.inputElement.querySelectorAll('.e-cell-select').length > 1 && (args.keyCode === 8 || args.keyCode === 32 || args.keyCode === 13)) {\n            this.tableSelectionKeyAction(e);\n            this.parent.autoResize();\n            return;\n        }\n        if (Browser.info.name === 'chrome') {\n            currentRange = this.parent.getRange();\n            this.backSpaceCleanup(e, currentRange);\n            this.deleteCleanup(e, currentRange);\n        }\n        if (args.keyCode === 9 && this.parent.enableTabKey) {\n            this.parent.formatter.saveData(e);\n            if (!isNOU(args.target) && isNullOrUndefined(closest(args.target, '.e-rte-toolbar'))) {\n                var range = this.nodeSelectionObj.getRange(this.contentRenderer.getDocument());\n                var parentNode = this.nodeSelectionObj.getParentNodeCollection(range);\n                if (!((parentNode[0].nodeName === 'LI' || closest(parentNode[0], 'li') ||\n                    closest(parentNode[0], 'table')))) {\n                    args.preventDefault();\n                    var selection = this.contentRenderer.getDocument().getSelection().getRangeAt(0);\n                    var alignmentNodes = this.parent.formatter.editorManager.domNode.blockNodes();\n                    if (this.parent.enterKey === 'BR') {\n                        if (selection.startOffset !== selection.endOffset && selection.startOffset === 0) {\n                            var save = this.nodeSelectionObj.save(range, this.contentRenderer.getDocument());\n                            this.parent.formatter.editorManager.domNode.setMarker(save);\n                            alignmentNodes = this.parent.formatter.editorManager.domNode.blockNodes();\n                            this.parent.formatter.editorManager.domNode.convertToBlockNodes(alignmentNodes, false);\n                            this.marginTabAdd(args.shiftKey, alignmentNodes);\n                            save = this.parent.formatter.editorManager.domNode.saveMarker(save);\n                            save.restore();\n                        }\n                        else {\n                            InsertHtml.Insert(this.contentRenderer.getDocument(), '&nbsp;&nbsp;&nbsp;&nbsp;');\n                            this.rangeCollection.push(this.nodeSelectionObj.getRange(this.contentRenderer.getDocument()));\n                        }\n                    }\n                    else {\n                        if (!args.shiftKey) {\n                            if (selection.startOffset !== selection.endOffset && selection.startOffset === 0) {\n                                this.marginTabAdd(args.shiftKey, alignmentNodes);\n                            }\n                            else {\n                                InsertHtml.Insert(this.contentRenderer.getDocument(), '&nbsp;&nbsp;&nbsp;&nbsp;');\n                                this.rangeCollection.push(this.nodeSelectionObj.getRange(this.contentRenderer.getDocument()));\n                            }\n                        }\n                        else if (this.rangeCollection.length > 0 &&\n                            this.rangeCollection[this.rangeCollection.length - 1].startContainer.textContent.length === 4) {\n                            var textCont = this.rangeCollection[this.rangeCollection.length - 1].startContainer;\n                            this.nodeSelectionObj.setSelectionText(this.contentRenderer.getDocument(), textCont, textCont, 0, textCont.textContent.length);\n                            InsertHtml.Insert(this.contentRenderer.getDocument(), document.createTextNode(''));\n                            this.rangeCollection.pop();\n                        }\n                        else {\n                            this.marginTabAdd(args.shiftKey, alignmentNodes);\n                        }\n                    }\n                }\n            }\n            this.parent.formatter.saveData(e);\n        }\n        if (e.args.action === 'space' ||\n            e.args.action === 'enter' ||\n            e.args.keyCode === 13) {\n            this.spaceLink(e.args);\n            if (this.parent.editorMode === 'HTML' && !this.parent.readonly) {\n                var currentLength = this.parent.getText().trim().replace(/(\\r\\n|\\n|\\r|\\t)/gm, '').replace(/\\u200B/g, '').length;\n                var selectionLength = this.parent.getSelection().length;\n                var totalLength = (currentLength - selectionLength) + 1;\n                if (!(this.parent.maxLength === -1 || totalLength <= this.parent.maxLength) &&\n                    e.args.keyCode === 13) {\n                    e.args.preventDefault();\n                    return;\n                }\n                else {\n                    this.parent.notify(events.enterHandler, { args: e.args });\n                    scrollToCursor(this.parent.contentModule.getDocument(), this.parent.inputElement);\n                }\n            }\n        }\n        if (e.args.action === 'space') {\n            var currentRange_1 = this.parent.getRange();\n            var editorValue = currentRange_1.startContainer.textContent.slice(0, currentRange_1.startOffset);\n            var orderedList_1 = this.isOrderedList(editorValue);\n            var unOrderedList = this.isUnOrderedList(editorValue);\n            var hasSplitedText = false;\n            if (orderedList_1 || unOrderedList) {\n                hasSplitedText = this.hasMultipleTextNode(currentRange_1);\n            }\n            if (!hasSplitedText && (orderedList_1 && !unOrderedList || unOrderedList && !orderedList_1)) {\n                var eventArgs_1 = {\n                    callBack: null,\n                    event: e.args,\n                    name: 'keydown-handler'\n                };\n                var actionBeginArgs = {\n                    cancel: false,\n                    item: { command: 'Lists', subCommand: orderedList_1 ? 'OL' : 'UL' },\n                    name: 'actionBegin',\n                    originalEvent: e.args,\n                    requestType: orderedList_1 ? 'OL' : 'UL'\n                };\n                this.parent.trigger(events.actionBegin, actionBeginArgs, function (actionBeginArgs) {\n                    if (!actionBeginArgs.cancel) {\n                        _this.parent.formatter.editorManager.observer.notify(ON_BEGIN, eventArgs_1);\n                        _this.parent.trigger(events.actionComplete, {\n                            editorMode: _this.parent.editorMode,\n                            elements: _this.parent.formatter.editorManager.domNode.blockNodes(),\n                            event: e.args,\n                            name: events.actionComplete,\n                            range: _this.parent.getRange(),\n                            requestType: orderedList_1 ? 'OL' : 'UL'\n                        });\n                    }\n                });\n            }\n        }\n        if (Browser.info.name === 'chrome' && (!isNullOrUndefined(this.rangeElement) && !isNullOrUndefined(this.oldRangeElement) ||\n            !isNullOrUndefined(this.deleteRangeElement) && !isNullOrUndefined(this.deleteOldRangeElement)) &&\n            currentRange.startContainer.parentElement.tagName !== 'TD' && currentRange.startContainer.parentElement.tagName !== 'TH') {\n            this.rangeElement = null;\n            this.oldRangeElement = null;\n            this.deleteRangeElement = null;\n            this.deleteOldRangeElement = null;\n            if (!this.isImageDelete) {\n                args.preventDefault();\n            }\n            args.preventDefault();\n        }\n        this.parent.autoResize();\n    };\n    HtmlEditor.prototype.isOrderedList = function (editorValue) {\n        editorValue = editorValue.replace(/\\u200B/g, '');\n        var olListStartRegex = [/^[1]+[.]+$/, /^[i]+[.]+$/, /^[a]+[.]+$/];\n        if (!isNullOrUndefined(editorValue)) {\n            for (var i = 0; i < olListStartRegex.length; i++) {\n                if (olListStartRegex[i].test(editorValue)) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n    HtmlEditor.prototype.isUnOrderedList = function (editorValue) {\n        editorValue = editorValue.replace(/\\u200B/g, '');\n        var ulListStartRegex = [/^[*]$/, /^[-]$/];\n        if (!isNullOrUndefined(editorValue)) {\n            for (var i = 0; i < ulListStartRegex.length; i++) {\n                if (ulListStartRegex[i].test(editorValue)) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n    HtmlEditor.prototype.hasMultipleTextNode = function (range) {\n        if (range && range.startContainer && range.startContainer.parentNode) {\n            var parentNode = range.startContainer.parentNode;\n            if (range.startContainer.previousElementSibling &&\n                range.startContainer.previousElementSibling.classList.contains('e-mention-chip')\n                && !range.startContainer.previousElementSibling.isContentEditable) {\n                return true;\n            }\n            if (this.parent.enterKey === 'BR' || closest(parentNode, 'table')) {\n                return false;\n            }\n            var childNodes = parentNode.childNodes;\n            var textNodes = [];\n            for (var i = 0; i < childNodes.length; i++) {\n                var node = childNodes[i];\n                if (node && node.nodeType === Node.TEXT_NODE) {\n                    textNodes.push(node);\n                    if (textNodes.length > 1) {\n                        return true;\n                    }\n                }\n            }\n        }\n        return false;\n    };\n    HtmlEditor.prototype.backSpaceCleanup = function (e, currentRange) {\n        var isLiElement = false;\n        var isPreviousNotContentEditable = true;\n        if (!isNOU(currentRange.startContainer.previousSibling) &&\n            currentRange.startContainer.previousSibling.nodeName === 'SPAN') {\n            isPreviousNotContentEditable = currentRange.startContainer.previousSibling.contentEditable === 'false' ? false : true;\n        }\n        var checkNode = currentRange.startContainer.nodeName === '#text' ? currentRange.startContainer.parentElement : currentRange.startContainer;\n        var isSelectedPositionNotStart = closest(currentRange.startContainer.nodeName === '#text' ? currentRange.startContainer.parentElement : currentRange.startContainer, 'li') ?\n            checkNode.nodeName !== 'li' && isNOU(checkNode.previousSibling) : true;\n        if (e.args.code === 'Backspace' && e.args.keyCode === 8 && currentRange.startOffset === 0 &&\n            currentRange.endOffset === 0 && this.parent.getSelection().length === 0 && currentRange.startContainer.textContent.length > 0 &&\n            currentRange.startContainer.parentElement.tagName !== 'TD' && currentRange.startContainer.parentElement.tagName !== 'TH' &&\n            isPreviousNotContentEditable && isSelectedPositionNotStart) {\n            if ((!this.parent.formatter.editorManager.domNode.isBlockNode(checkNode) &&\n                !isNOU(checkNode.previousSibling) && checkNode.previousSibling.nodeName === 'BR') ||\n                (!isNOU(currentRange.startContainer.previousSibling) && currentRange.startContainer.previousSibling.nodeName === 'BR')) {\n                return;\n            }\n            this.rangeElement = this.getRootBlockNode(currentRange.startContainer);\n            if (this.rangeElement.tagName === 'OL' || this.rangeElement.tagName === 'UL') {\n                var liElement = this.getRangeLiNode(currentRange.startContainer);\n                if (liElement.previousElementSibling && liElement.previousElementSibling.childElementCount > 0) {\n                    this.oldRangeElement = liElement.previousElementSibling.lastElementChild.nodeName === 'BR' ?\n                        liElement.previousElementSibling : liElement.previousElementSibling.lastChild;\n                    if (!isNOU(liElement.lastElementChild) && liElement.lastElementChild.nodeName !== 'BR' &&\n                        isNOU(liElement.lastElementChild.previousSibling) && liElement.lastChild.nodeName !== '#text') {\n                        this.rangeElement = liElement.lastElementChild;\n                        isLiElement = true;\n                    }\n                    else {\n                        this.rangeElement = liElement;\n                    }\n                }\n            }\n            else if (this.rangeElement === this.parent.inputElement || this.rangeElement.tagName === 'TABLE' ||\n                (!isNOU(this.rangeElement.previousElementSibling) && this.rangeElement.previousElementSibling.tagName === 'TABLE')) {\n                return;\n            }\n            else {\n                this.oldRangeElement = this.rangeElement.previousElementSibling;\n            }\n            var findBlockElement = this.parent.formatter.editorManager.domNode.blockNodes();\n            if (!isNOU(findBlockElement[0]) && currentRange.collapsed && currentRange.startOffset === 0 && currentRange.endOffset === 0 && findBlockElement[0].style.marginLeft !== '') {\n                findBlockElement[0].style.marginLeft = (parseInt(findBlockElement[0].style.marginLeft, 10) <= 20) ? '' : (parseInt(findBlockElement[0].style.marginLeft, 10) - 20 + 'px');\n            }\n            if (isNOU(this.oldRangeElement)) {\n                return;\n            }\n            else {\n                if (this.oldRangeElement.tagName === 'OL' || this.oldRangeElement.tagName === 'UL') {\n                    this.oldRangeElement = this.oldRangeElement.lastElementChild.lastElementChild\n                        ? this.oldRangeElement.lastElementChild.lastElementChild :\n                        this.oldRangeElement.lastElementChild;\n                }\n                var lastNode = this.oldRangeElement.lastChild ? this.oldRangeElement.lastChild : this.oldRangeElement;\n                while (lastNode.nodeType !== 3 && lastNode.nodeName !== '#text' &&\n                    lastNode.nodeName !== 'BR' && !isNOU(lastNode.lastChild)) {\n                    lastNode = lastNode.lastChild;\n                }\n                if (lastNode.nodeName === 'IMG') {\n                    this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(), lastNode.parentElement, lastNode.parentElement.childNodes.length);\n                }\n                else {\n                    this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(), \n                    // eslint-disable-next-line\n                    lastNode, lastNode.textContent.length);\n                }\n                var checkParent = false;\n                if (this.oldRangeElement && this.oldRangeElement.nodeName !== '#text' && this.oldRangeElement.querySelectorAll('BR').length === 1) {\n                    var brElement = this.oldRangeElement.querySelector('BR');\n                    if (brElement) {\n                        var brParentElement = brElement.parentNode;\n                        var currentState = this.oldRangeElement.innerHTML;\n                        this.parent.formatter.saveData(currentState);\n                        detach(brElement);\n                        if (brParentElement && brParentElement.childNodes.length === 0) {\n                            detach(brParentElement);\n                            checkParent = true;\n                        }\n                    }\n                }\n                if (!isNOU(this.rangeElement) && this.oldRangeElement !== this.rangeElement && !checkParent) {\n                    while (this.rangeElement.firstChild) {\n                        if (this.oldRangeElement.nodeName === '#text') {\n                            this.oldRangeElement.parentElement.appendChild(this.rangeElement.childNodes[0]);\n                        }\n                        else {\n                            this.oldRangeElement.appendChild(this.rangeElement.childNodes[0]);\n                        }\n                    }\n                    // eslint-disable-next-line\n                    !isLiElement ? detach(this.rangeElement) : detach(this.rangeElement.parentElement);\n                    this.oldRangeElement.normalize();\n                }\n            }\n        }\n    };\n    HtmlEditor.prototype.deleteCleanup = function (e, currentRange) {\n        var isLiElement = false;\n        var liElement;\n        var rootElement;\n        if (e.args.code === 'Delete' && e.args.keyCode === 46 &&\n            this.parent.contentModule.getText().trim().replace(/(\\r\\n|\\n|\\r|\\t)/gm, '').replace(/\\u200B/g, '').length !== 0 && this.parent.getSelection().length === 0 && currentRange.startContainer.parentElement.tagName !== 'TD' &&\n            currentRange.startContainer.parentElement.tagName !== 'TH') {\n            this.deleteRangeElement = rootElement = this.getRootBlockNode(currentRange.startContainer);\n            if (this.deleteRangeElement.tagName === 'OL' || this.deleteRangeElement.tagName === 'UL') {\n                liElement = this.getRangeLiNode(currentRange.startContainer);\n                if (liElement.nextElementSibling && liElement.nextElementSibling.childElementCount > 0\n                    && !liElement.nextElementSibling.querySelector('BR')) {\n                    if (!isNullOrUndefined(liElement.lastElementChild)) {\n                        this.deleteRangeElement = liElement.lastElementChild;\n                        isLiElement = true;\n                    }\n                    else {\n                        this.deleteRangeElement = liElement;\n                    }\n                }\n                else {\n                    this.deleteRangeElement = this.getRangeElement(liElement);\n                }\n            }\n            else if (this.deleteRangeElement.nodeType === 3 || (this.deleteRangeElement.tagName === 'TABLE' ||\n                (!isNullOrUndefined(this.deleteRangeElement.nextElementSibling) && this.deleteRangeElement.nextElementSibling.tagName === 'TABLE'))) {\n                return;\n            }\n            var isImgWithEmptyBlockNode = false;\n            if (this.deleteRangeElement.querySelectorAll('img').length > 0 && this.deleteRangeElement.textContent.trim() === '') {\n                isImgWithEmptyBlockNode = true;\n            }\n            if (this.getCaretIndex(currentRange, this.deleteRangeElement) === this.deleteRangeElement.textContent.length &&\n                !isImgWithEmptyBlockNode) {\n                if (!isNullOrUndefined(liElement)) {\n                    if (isLiElement || !isNullOrUndefined(liElement.nextElementSibling)) {\n                        this.deleteOldRangeElement = this.getRangeElement(liElement.nextElementSibling);\n                    }\n                    else {\n                        this.deleteOldRangeElement = rootElement.nextElementSibling;\n                    }\n                }\n                else {\n                    this.deleteOldRangeElement = this.deleteRangeElement.nextElementSibling;\n                }\n                if (isNullOrUndefined(this.deleteOldRangeElement)) {\n                    return;\n                }\n                else {\n                    if (currentRange.startOffset === 0 && currentRange.endOffset === 1 &&\n                        this.deleteRangeElement.childNodes[0].nodeName === 'IMG') {\n                        this.parent.formatter.editorManager.nodeSelection.setSelectionText(this.parent.contentModule.getDocument(), this.deleteRangeElement, this.deleteRangeElement, 0, 1);\n                        this.isImageDelete = true;\n                    }\n                    else {\n                        this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(), this.deleteRangeElement, this.deleteRangeElement.childNodes.length);\n                        this.isImageDelete = false;\n                    }\n                    var brNode = this.deleteRangeElement.querySelector('BR');\n                    var brLastChildNode = this.deleteRangeElement.lastChild;\n                    var brParentNode = brLastChildNode.parentNode;\n                    if (brNode && brNode.classList.contains('e-rte-image-remove-focus')) {\n                        removeClass([brNode], ['e-rte-image-focus']);\n                        return;\n                    }\n                    else if (brNode && brLastChildNode && brLastChildNode.nodeName === 'BR') {\n                        detach(brLastChildNode);\n                        if (!isNullOrUndefined(brParentNode) && brParentNode.childNodes.length === 0) {\n                            detach(brParentNode);\n                        }\n                        e.args.preventDefault();\n                    }\n                    if (!isNullOrUndefined(this.deleteRangeElement) && (this.deleteOldRangeElement.tagName !== 'OL' && this.deleteOldRangeElement.tagName !== 'UL')\n                        && this.deleteOldRangeElement !== this.deleteRangeElement) {\n                        while (this.deleteOldRangeElement.firstChild) {\n                            this.deleteRangeElement.appendChild(this.deleteOldRangeElement.childNodes[0]);\n                        }\n                        if (!isLiElement) {\n                            detach(this.deleteOldRangeElement);\n                        }\n                        else {\n                            detach(this.deleteOldRangeElement.parentElement);\n                        }\n                        this.deleteRangeElement.normalize();\n                    }\n                    else {\n                        this.deleteRangeElement = null;\n                        this.deleteOldRangeElement = null;\n                    }\n                }\n            }\n            else {\n                this.deleteRangeElement = null;\n            }\n        }\n    };\n    HtmlEditor.prototype.getCaretIndex = function (currentRange, element) {\n        var position = 0;\n        if (this.parent.contentModule.getDocument().getSelection().rangeCount !== 0) {\n            var preCaretRange = currentRange.cloneRange();\n            preCaretRange.selectNodeContents(element);\n            preCaretRange.setEnd(currentRange.endContainer, currentRange.endOffset);\n            position = preCaretRange.toString().length;\n        }\n        return position;\n    };\n    HtmlEditor.prototype.getRangeElement = function (element) {\n        var rangeElement = element.lastElementChild ? element.lastElementChild.tagName === 'BR' ?\n            element.lastElementChild.previousElementSibling ? element.lastElementChild.previousElementSibling\n                : element : element.lastElementChild : element;\n        return rangeElement;\n    };\n    HtmlEditor.prototype.getRootBlockNode = function (rangeBlockNode) {\n        // eslint-disable-next-line\n        for (; rangeBlockNode && this.parent && this.parent.inputElement !== rangeBlockNode; rangeBlockNode = rangeBlockNode) {\n            if (rangeBlockNode.parentElement === this.parent.inputElement) {\n                break;\n            }\n            else {\n                rangeBlockNode = rangeBlockNode.parentElement;\n            }\n        }\n        return rangeBlockNode;\n    };\n    HtmlEditor.prototype.getRangeLiNode = function (rangeLiNode) {\n        var node = rangeLiNode.parentElement;\n        while (node !== this.parent.inputElement) {\n            if (node.nodeType === 1 && node.tagName === 'LI') {\n                break;\n            }\n            node = node.parentElement;\n        }\n        return node;\n    };\n    HtmlEditor.prototype.onPaste = function (e) {\n        // eslint-disable-next-line\n        var regex = new RegExp(/([^\\S]|^)(((https?\\:\\/\\/)|(www\\.))(\\S+))/gi);\n        if (e.text.match(regex)) {\n            if (e.isWordPaste) {\n                return;\n            }\n            e.args.preventDefault();\n            var range = this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());\n            // eslint-disable-next-line\n            var saveSelection = this.parent.formatter.editorManager.nodeSelection.save(range, this.parent.contentModule.getDocument());\n            // eslint-disable-next-line\n            var httpRegex = new RegExp(/([^\\S]|^)(((https?\\:\\/\\/)))/gi);\n            var wwwRegex = new RegExp(/([^\\S]|^)(((www\\.))(\\S+))/gi);\n            var enterSplitText = e.text.split('\\n');\n            var contentInnerElem = '';\n            for (var i = 0; i < enterSplitText.length; i++) {\n                if (enterSplitText[i].trim() === '') {\n                    contentInnerElem += getDefaultValue(this.parent);\n                }\n                else {\n                    var contentWithSpace = '';\n                    var spaceBetweenContent = true;\n                    var spaceSplit = enterSplitText[i].split(' ');\n                    for (var j = 0; j < spaceSplit.length; j++) {\n                        if (spaceSplit[j].trim() === '') {\n                            contentWithSpace += spaceBetweenContent ? '&nbsp;' : ' ';\n                        }\n                        else {\n                            spaceBetweenContent = false;\n                            contentWithSpace += spaceSplit[j] + ' ';\n                        }\n                    }\n                    if (i === 0) {\n                        contentInnerElem += '<span>' + contentWithSpace.trim() + '</span>';\n                    }\n                    else {\n                        contentInnerElem += '<p>' + contentWithSpace.trim() + '</p>';\n                    }\n                }\n            }\n            var divElement = this.parent.createElement('div');\n            divElement.setAttribute('class', 'pasteContent');\n            divElement.style.display = 'inline';\n            divElement.innerHTML = contentInnerElem.replace('&para', '&amp;para');\n            var paraElem = divElement.querySelectorAll('span, p');\n            for (var i = 0; i < paraElem.length; i++) {\n                var splitTextContent = paraElem[i].innerHTML.split(' ');\n                var resultSplitContent = '';\n                for (var j = 0; j < splitTextContent.length; j++) {\n                    if (splitTextContent[j].match(httpRegex) || splitTextContent[j].match(wwwRegex)) {\n                        resultSplitContent += '<a class=\"e-rte-anchor\" href=\"' + splitTextContent[j] +\n                            '\" title=\"' + splitTextContent[j] + '\" target=\"_blank\"' + ' aria-label=\"' + this.parent.serviceLocator.getService('rteLocale').getConstant('linkAriaLabel') + '\">' + splitTextContent[j] + ' </a>';\n                    }\n                    else {\n                        resultSplitContent += splitTextContent[j] + ' ';\n                    }\n                }\n                paraElem[i].innerHTML = resultSplitContent.trim();\n            }\n            var anchorElement = divElement.childNodes[0];\n            if (!isNullOrUndefined(anchorElement) && !isNullOrUndefined(anchorElement.childNodes[0]) && anchorElement.nodeName === 'SPAN' && anchorElement.childNodes[0].nodeName === 'A') {\n                divElement.innerHTML = divElement.innerHTML.replace('<span>', '').replace('</span>', '');\n            }\n            if (!isNullOrUndefined(this.parent.pasteCleanupModule)) {\n                e.callBack(divElement.innerHTML);\n            }\n            else {\n                this.parent.formatter.editorManager.execCommand('insertHTML', null, null, null, divElement);\n            }\n        }\n    };\n    HtmlEditor.prototype.spaceLink = function (e) {\n        var range = this.nodeSelectionObj.getRange(this.contentRenderer.getDocument());\n        var selectNodeEle = this.nodeSelectionObj.getParentNodeCollection(range);\n        var text = range.startContainer.textContent.substr(0, range.endOffset);\n        var splitText = text.split(' ');\n        var urlText = splitText[splitText.length - 1];\n        var urlTextRange = range.startOffset - (text.length - splitText[splitText.length - 1].length);\n        urlText = urlText.slice(0, urlTextRange);\n        // eslint-disable-next-line\n        var regex = new RegExp(/([^\\S]|^)(((https?\\:\\/\\/)|(www\\.))(\\S+))/gi);\n        if (selectNodeEle[0] && selectNodeEle[0].nodeName !== 'A' && urlText.match(regex)) {\n            var selection = this.nodeSelectionObj.save(range, this.parent.contentModule.getDocument());\n            var url = urlText.indexOf('http') > -1 ? urlText : 'http://' + urlText;\n            var selectParent = this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(range);\n            var value = {\n                url: url,\n                selection: selection, selectParent: selectParent,\n                text: urlText,\n                title: '',\n                target: '_blank'\n            };\n            this.parent.formatter.process(this.parent, {\n                item: {\n                    'command': 'Links',\n                    'subCommand': 'CreateLink'\n                }\n            }, e, value);\n        }\n    };\n    HtmlEditor.prototype.onToolbarClick = function (args) {\n        var _this = this;\n        var save;\n        var selectNodeEle;\n        var selectParentEle;\n        var item = args.item;\n        var closestElement = closest(args.originalEvent.target, '.e-rte-quick-popup');\n        var target = args.originalEvent.target;\n        this.parent.notify(events.closeTooltip, { target: target });\n        if (item.command !== 'FormatPainter') {\n            if (closestElement && !closestElement.classList.contains('e-rte-inline-popup') && !closestElement.classList.contains('e-rte-text-popup')) {\n                if (!(item.subCommand === 'SourceCode' || item.subCommand === 'Preview' ||\n                    item.subCommand === 'FontColor' || item.subCommand === 'BackgroundColor')) {\n                    if (isIDevice() && item.command === 'Images') {\n                        this.nodeSelectionObj.restore();\n                    }\n                    var range = this.nodeSelectionObj.getRange(this.parent.contentModule.getDocument());\n                    save = this.nodeSelectionObj.save(range, this.parent.contentModule.getDocument());\n                    selectNodeEle = this.nodeSelectionObj.getNodeCollection(range);\n                    selectParentEle = this.nodeSelectionObj.getParentNodeCollection(range);\n                }\n                if (item.command === 'Images') {\n                    this.parent.notify(events.imageToolbarAction, {\n                        member: 'image', args: args, selectNode: selectNodeEle, selection: save, selectParent: selectParentEle\n                    });\n                }\n                if (item.command === 'Audios') {\n                    this.parent.notify(events.audioToolbarAction, {\n                        member: 'audio', args: args, selectNode: selectNodeEle, selection: save, selectParent: selectParentEle\n                    });\n                }\n                if (item.command === 'Videos') {\n                    this.parent.notify(events.videoToolbarAction, {\n                        member: 'video', args: args, selectNode: selectNodeEle, selection: save, selectParent: selectParentEle\n                    });\n                }\n                if (item.command === 'Links') {\n                    this.parent.notify(events.linkToolbarAction, {\n                        member: 'link', args: args, selectNode: selectNodeEle, selection: save, selectParent: selectParentEle\n                    });\n                }\n                if (item.command === 'Table') {\n                    this.parent.notify(events.tableToolbarAction, {\n                        member: 'table', args: args, selectNode: selectNodeEle, selection: save, selectParent: selectParentEle\n                    });\n                }\n            }\n            else {\n                var linkDialog = document.getElementById(this.parent.getID() + '_rtelink');\n                var imageDialog = document.getElementById(this.parent.getID() + '_image');\n                if (!(item.subCommand === 'SourceCode' || item.subCommand === 'Preview' ||\n                    item.subCommand === 'FontColor' || item.subCommand === 'BackgroundColor' || item.subCommand === 'NumberFormatList' || item.subCommand === 'BulletFormatList')) {\n                    var range = this.nodeSelectionObj.getRange(this.parent.contentModule.getDocument());\n                    if (isNullOrUndefined(linkDialog) && isNullOrUndefined(imageDialog)) {\n                        save = this.nodeSelectionObj.save(range, this.parent.contentModule.getDocument());\n                    }\n                    selectNodeEle = this.nodeSelectionObj.getNodeCollection(range);\n                    selectParentEle = this.nodeSelectionObj.getParentNodeCollection(range);\n                }\n                switch (item.subCommand) {\n                    case 'Maximize':\n                        this.parent.notify(events.enableFullScreen, { args: args });\n                        break;\n                    case 'Minimize':\n                        this.parent.notify(events.disableFullScreen, { args: args });\n                        break;\n                    case 'CreateLink':\n                        this.parent.notify(events.insertLink, {\n                            member: 'link', args: args, selectNode: selectNodeEle, selection: save, selectParent: selectParentEle\n                        });\n                        break;\n                    case 'RemoveLink':\n                        this.parent.notify(events.unLink, {\n                            member: 'link', args: args, selectNode: selectNodeEle, selection: save, selectParent: selectParentEle\n                        });\n                        break;\n                    case 'Print':\n                        this.parent.print();\n                        break;\n                    case 'Image':\n                        this.parent.notify(events.insertImage, {\n                            member: 'image', args: args, selectNode: selectNodeEle, selection: save, selectParent: selectParentEle\n                        });\n                        break;\n                    case 'Audio':\n                        this.parent.notify(events.insertAudio, {\n                            member: 'audio', args: args, selectNode: selectNodeEle, selection: save, selectParent: selectParentEle\n                        });\n                        break;\n                    case 'Video':\n                        this.parent.notify(events.insertVideo, {\n                            member: 'video', args: args, selectNode: selectNodeEle, selection: save, selectParent: selectParentEle\n                        });\n                        break;\n                    case 'CreateTable':\n                        this.parent.notify(events.createTable, {\n                            member: 'table', args: args, selection: save\n                        });\n                        break;\n                    case 'SourceCode':\n                        this.parent.notify(events.sourceCode, { member: 'viewSource', args: args });\n                        break;\n                    case 'Preview':\n                        this.parent.notify(events.updateSource, { member: 'updateSource', args: args });\n                        break;\n                    case 'FontColor':\n                    case 'BackgroundColor':\n                        break;\n                    case 'File':\n                        this.parent.notify(events.renderFileManager, {\n                            member: 'fileManager', args: args, selectNode: selectNodeEle, selection: save, selectParent: selectParentEle\n                        });\n                        break;\n                    case 'EmojiPicker':\n                        this.parent.notify(events.emojiPicker, { member: 'emojiPicker', args: args });\n                        break;\n                    case 'ImportWord':\n                        this.parent.notify(events.onImport, {});\n                        break;\n                    case 'ExportWord':\n                        this.parent.notify(events.onExport, { member: 'ExportWord', args: args });\n                        break;\n                    case 'ExportPdf':\n                        this.parent.notify(events.onExport, { member: 'ExportPdf', args: args });\n                        break;\n                    default:\n                        this.parent.formatter.process(this.parent, args, args.originalEvent, null);\n                        break;\n                }\n            }\n        }\n        else {\n            if (args.originalEvent.detail === 1) {\n                clearTimeout(this.clickTimeout);\n                this.clickTimeout = setTimeout(function () {\n                    _this.parent.notify(events.formatPainterClick, {\n                        member: 'formatPainter', args: args\n                    });\n                }, 200);\n            }\n            else {\n                clearTimeout(this.clickTimeout);\n                this.parent.notify(events.formatPainterDoubleClick, {\n                    member: 'formatPainter', args: args\n                });\n            }\n        }\n    };\n    HtmlEditor.prototype.instantiateRenderer = function () {\n        if (this.parent.iframeSettings.enable) {\n            this.renderFactory.addRenderer(RenderType.Content, new IframeContentRender(this.parent));\n        }\n        else {\n            this.renderFactory.addRenderer(RenderType.Content, new ContentRender(this.parent));\n        }\n    };\n    HtmlEditor.prototype.removeEventListener = function () {\n        this.parent.off(events.initialEnd, this.render);\n        this.parent.off(events.modelChanged, this.onPropertyChanged);\n        this.parent.off(events.htmlToolbarClick, this.onToolbarClick);\n        this.parent.off(events.destroy, this.destroy);\n        this.parent.off(events.keyDown, this.onKeyDown);\n        this.parent.off(events.initialLoad, this.instantiateRenderer);\n        this.parent.off(events.selectAll, this.selectAll);\n        this.parent.off(events.selectRange, this.selectRange);\n        this.parent.off(events.getSelectedHtml, this.getSelectedHtml);\n        this.parent.off(events.selectionSave, this.onSelectionSave);\n        this.parent.off(events.selectionRestore, this.onSelectionRestore);\n        this.parent.off(events.readOnlyMode, this.updateReadOnly);\n        this.parent.off(events.paste, this.onPaste);\n        this.parent.off(events.tableclass, this.isTableClassAdded);\n    };\n    HtmlEditor.prototype.render = function () {\n        this.contentRenderer = this.renderFactory.getRenderer(RenderType.Content);\n        var editElement = this.contentRenderer.getEditPanel();\n        var option = { undoRedoSteps: this.parent.undoRedoSteps, undoRedoTimer: this.parent.undoRedoTimer };\n        if (isNullOrUndefined(this.parent.formatter)) {\n            var formatterClass = new HTMLFormatter({\n                currentDocument: this.contentRenderer.getDocument(),\n                element: editElement,\n                options: option,\n                formatPainterSettings: this.parent.formatPainterSettings\n            });\n            this.parent.setProperties({ formatter: formatterClass }, true);\n        }\n        else {\n            this.parent.formatter.updateFormatter(editElement, this.contentRenderer.getDocument(), option);\n        }\n        if (this.parent.enableXhtml) {\n            this.parent.notify(events.xhtmlValidation, {});\n        }\n        if (this.parent.toolbarSettings.enable) {\n            this.toolbarUpdate = new HtmlToolbarStatus(this.parent);\n        }\n        if (this.parent.inlineMode.enable) {\n            if (!isNullOrUndefined(this.parent.fontFamily.default)) {\n                editElement.style.fontFamily = this.parent.fontFamily.default;\n            }\n            if (!isNullOrUndefined(this.parent.fontSize.default)) {\n                editElement.style.fontSize = this.parent.fontSize.default;\n            }\n        }\n        this.parent.notify(events.bindOnEnd, {});\n    };\n    /**\n     * Called internally if any of the property value changed.\n     *\n     * @param {RichTextEditorModel} e - specifies the editor model\n     * @returns {void}\n     * @hidden\n\n     */\n    HtmlEditor.prototype.onPropertyChanged = function (e) {\n        // On property code change here\n        if (!isNOU(e) && !isNOU(e.newProp.toolbarSettings) && !isNOU(e.newProp.toolbarSettings.enable)) {\n            this.toolbarUpdate = new HtmlToolbarStatus(this.parent);\n        }\n        if (!isNullOrUndefined(e.newProp.formatter)) {\n            var editElement = this.contentRenderer.getEditPanel();\n            var option = { undoRedoSteps: this.parent.undoRedoSteps,\n                undoRedoTimer: this.parent.undoRedoTimer };\n            this.parent.formatter.updateFormatter(editElement, this.contentRenderer.getDocument(), option);\n        }\n    };\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @returns {string} - returns the string value\n     * @hidden\n     */\n    HtmlEditor.prototype.getModuleName = function () {\n        return 'htmlEditor';\n    };\n    /**\n     * For selecting all content in RTE\n     *\n     * @returns {void}\n     * @private\n     * @hidden\n     */\n    HtmlEditor.prototype.selectAll = function () {\n        var nodes = getTextNodesUnder(this.parent.contentModule.getDocument(), this.parent.contentModule.getEditPanel());\n        if (nodes.length > 0) {\n            this.parent.formatter.editorManager.nodeSelection.setSelectionText(this.parent.contentModule.getDocument(), nodes[0], nodes[nodes.length - 1], 0, nodes[nodes.length - 1].textContent.length);\n        }\n    };\n    /**\n     * For selecting all content in RTE\n     *\n     * @param {NotifyArgs} e - specifies the notified arguments\n     * @returns {void}\n     * @private\n     * @hidden\n     */\n    HtmlEditor.prototype.selectRange = function (e) {\n        this.parent.formatter.editorManager.nodeSelection.setRange(this.parent.contentModule.getDocument(), e.range);\n    };\n    /**\n     * For get a selected text in RTE\n     *\n     * @param {NotifyArgs} e - specifies the notified arguments\n     * @returns {void}\n     * @hidden\n     */\n    HtmlEditor.prototype.getSelectedHtml = function (e) {\n        e.callBack(this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()).toString());\n    };\n    HtmlEditor.prototype.tableSelectionKeyAction = function (e) {\n        var args = e.args;\n        // Handle the space, enter and backspace keys when the table cells are selected.\n        var tableCellSelectNodes = this.parent.inputElement.querySelectorAll('.e-cell-select');\n        for (var i = 0; i < tableCellSelectNodes.length; i++) {\n            var currentCell = tableCellSelectNodes[i];\n            removeClassWithAttr([currentCell], [classes.CLS_TABLE_SEL, classes.CLS_TABLE_MULTI_CELL, classes.CLS_TABLE_SEL_END]);\n            if (i === 0) {\n                if (args.keyCode === 32) {\n                    currentCell.innerHTML = '&#8203;<br>';\n                }\n                else {\n                    currentCell.innerHTML = '<br>';\n                }\n                this.nodeSelectionObj.setCursorPoint(this.parent.contentModule.getDocument(), currentCell.firstChild, 0);\n            }\n            else {\n                currentCell.innerHTML = '<br>';\n            }\n        }\n    };\n    HtmlEditor.prototype.marginTabAdd = function (val, alignmentNodes) {\n        for (var index = 0; index < alignmentNodes.length; index++) {\n            var element = alignmentNodes[index];\n            if (element.closest('li')) {\n                continue;\n            }\n            if (element.style.marginLeft) {\n                var count = parseInt(element.style.marginLeft, 10);\n                if (val) {\n                    count -= 20;\n                }\n                else {\n                    count += 20;\n                }\n                element.style.marginLeft = count.toString() + 'px';\n                if (element.style.marginLeft === '0px') {\n                    element.removeAttribute('style');\n                }\n            }\n            else if (!val) {\n                element.style.marginLeft = '20px';\n            }\n        }\n    };\n    return HtmlEditor;\n}());\nexport { HtmlEditor };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}